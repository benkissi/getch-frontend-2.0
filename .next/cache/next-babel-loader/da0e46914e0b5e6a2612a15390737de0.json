{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport \"antd/lib/input/style\";\nimport _Input from \"antd/lib/input\";\nvar _jsxFileName = \"/code/ben/getch/frontend/pages/index.js\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useRouter } from \"next/router\";\nimport { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport FacebookLogin from 'react-facebook-login/dist/facebook-login-render-props';\nimport DashboardLayout from '../components/dashboardLayout';\nimport Header from '../components/header';\nimport InterestTable from '../components/table';\nimport { tableColumns } from '../utils/table';\nimport { addScore, getInterestNames } from '../utils/search';\nimport decodeToken from \"../utils/auth\";\nimport { addingCurrentUser, authFacebook } from \"../redux/user/user-actions\";\nimport { searchStart } from '../redux/search/search-actions';\n\nvar Index = function Index(props) {\n  var _useState = useState({}),\n      state = _useState[0],\n      setState = _useState[1];\n\n  var token = props.token,\n      user = props.user,\n      addUser = props.addUser,\n      fbToken = props.fbToken,\n      interestData = props.interestData,\n      searchInterest = props.searchInterest;\n  var Search = _Input.Search;\n  var router = useRouter();\n  useEffect(function () {\n    if (token) {\n      var decoded = decodeToken(props.token);\n      var _id = decoded._id,\n          name = decoded.name,\n          email = decoded.email,\n          domain = decoded.domain;\n      var userData = {\n        id: _id,\n        name: name,\n        email: email,\n        domain: domain\n      };\n      addUser(userData);\n    } else if (user) {\n      console.log(user);\n    } else {\n      router.push(\"/signin\");\n    }\n\n    setState({\n      interestData: interestData\n    });\n  }, []);\n\n  var faceAuthStart = function faceAuthStart() {\n    console.log('#### FB auth start');\n  };\n\n  var responseFacebook = function responseFacebook(res) {\n    var authFb, user, accessToken;\n    return _regeneratorRuntime.async(function responseFacebook$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            authFb = props.authFb, user = props.user;\n            accessToken = res.accessToken;\n            authFb(accessToken, user.id);\n\n          case 3:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    });\n  };\n\n  var getInterest = function getInterest(value) {\n    var interests, data;\n    return _regeneratorRuntime.async(function getInterest$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            interests = [];\n            _context2.next = 3;\n            return _regeneratorRuntime.awrap(searchInterest(fbToken.token, value, 500));\n\n          case 3:\n            data = _context2.sent;\n\n          case 4:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    });\n  };\n\n  var onSelectionChange = function onSelectionChange(selectedRowKeys, selectedRows) {\n    var selectedInterest = selectedRows.map(function (interest) {\n      return interest.name;\n    });\n    console.log(selectedInterest);\n    setState(_objectSpread({}, state, {\n      selectedRowKeys: selectedRowKeys,\n      selectedInterest: selectedInterest\n    }));\n  };\n\n  var actions = [__jsx(FacebookLogin, {\n    appId: process.env.FB_APP_ID,\n    autoLoad: true,\n    fields: \"name,email,id\",\n    onClick: faceAuthStart,\n    scope: \"ads_management, email\",\n    callback: responseFacebook,\n    render: function render(renderProps) {\n      return __jsx(_Button, {\n        type: \"primary\",\n        onClick: renderProps.onClick,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90\n        },\n        __self: this\n      }, \"Connect Facebook\");\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82\n    },\n    __self: this\n  })];\n  var interests = state.interests,\n      selectedRowKeys = state.selectedRowKeys;\n  return __jsx(DashboardLayout, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    id: \"wrapper\",\n    className: \"jsx-685445646\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98\n    },\n    __self: this\n  }, __jsx(Header, {\n    actions: actions,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99\n    },\n    __self: this\n  }), __jsx(\"div\", {\n    id: \"main-content\",\n    className: \"jsx-685445646\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100\n    },\n    __self: this\n  }, __jsx(Search, {\n    placeholder: \"Find Facebook interest for a keyword\",\n    enterButton: \"Getch\",\n    size: \"large\",\n    onSearch: function onSearch(value) {\n      return getInterest(value);\n    },\n    className: \"jsx-685445646\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101\n    },\n    __self: this\n  }), __jsx(\"div\", {\n    id: \"table\",\n    className: \"jsx-685445646\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107\n    },\n    __self: this\n  }, __jsx(InterestTable, {\n    onSelection: onSelectionChange,\n    selectedRowKeys: selectedRowKeys,\n    className: \"table\",\n    columns: tableColumns,\n    dataSource: interests,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108\n    },\n    __self: this\n  }))), __jsx(_JSXStyle, {\n    id: \"685445646\",\n    __self: this\n  }, \"#wrapper.jsx-685445646{margin:10px;}#main-content.jsx-685445646{margin-top:30px;}#table.jsx-685445646{margin-top:30px;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9jb2RlL2Jlbi9nZXRjaC9mcm9udGVuZC9wYWdlcy9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFxSGtCLEFBR3VCLEFBR0ksQUFHQSxZQUxsQixJQUdBLEFBR0EiLCJmaWxlIjoiL2NvZGUvYmVuL2dldGNoL2Zyb250ZW5kL3BhZ2VzL2luZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdXNlUm91dGVyIH0gZnJvbSBcIm5leHQvcm91dGVyXCI7XG5pbXBvcnQgeyB1c2VFZmZlY3QsIHVzZVN0YXRlIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBjb25uZWN0IH0gZnJvbSBcInJlYWN0LXJlZHV4XCI7XG5pbXBvcnQgeyBCdXR0b24sIElucHV0LCBUYWcgfSBmcm9tIFwiYW50ZFwiO1xuaW1wb3J0IEZhY2Vib29rTG9naW4gZnJvbSAncmVhY3QtZmFjZWJvb2stbG9naW4vZGlzdC9mYWNlYm9vay1sb2dpbi1yZW5kZXItcHJvcHMnO1xuXG5pbXBvcnQgRGFzaGJvYXJkTGF5b3V0IGZyb20gJy4uL2NvbXBvbmVudHMvZGFzaGJvYXJkTGF5b3V0J1xuaW1wb3J0IEhlYWRlciBmcm9tICcuLi9jb21wb25lbnRzL2hlYWRlcidcbmltcG9ydCBJbnRlcmVzdFRhYmxlIGZyb20gJy4uL2NvbXBvbmVudHMvdGFibGUnXG5cbmltcG9ydCB7dGFibGVDb2x1bW5zfSBmcm9tICcuLi91dGlscy90YWJsZSdcbmltcG9ydCB7YWRkU2NvcmUsIGdldEludGVyZXN0TmFtZXN9IGZyb20gJy4uL3V0aWxzL3NlYXJjaCdcblxuaW1wb3J0IGRlY29kZVRva2VuIGZyb20gXCIuLi91dGlscy9hdXRoXCI7XG5pbXBvcnQgeyBhZGRpbmdDdXJyZW50VXNlciwgYXV0aEZhY2Vib29rIH0gZnJvbSBcIi4uL3JlZHV4L3VzZXIvdXNlci1hY3Rpb25zXCI7XG5pbXBvcnQge3NlYXJjaFN0YXJ0fSBmcm9tICcuLi9yZWR1eC9zZWFyY2gvc2VhcmNoLWFjdGlvbnMnXG5cblxuY29uc3QgSW5kZXggPSBwcm9wcyA9PiB7XG4gIGNvbnN0IFtzdGF0ZSwgc2V0U3RhdGVdID0gdXNlU3RhdGUoe30pXG4gIGNvbnN0IHsgdG9rZW4sIHVzZXIsIGFkZFVzZXIsIGZiVG9rZW4sIGludGVyZXN0RGF0YSwgc2VhcmNoSW50ZXJlc3QgfSA9IHByb3BzO1xuICBjb25zdCB7IFNlYXJjaCB9ID0gSW5wdXQ7XG4gIGNvbnN0IHJvdXRlciA9IHVzZVJvdXRlcigpO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKHRva2VuKSB7XG4gICAgICBjb25zdCBkZWNvZGVkID0gZGVjb2RlVG9rZW4ocHJvcHMudG9rZW4pO1xuICAgICAgY29uc3QgeyBfaWQsIG5hbWUsIGVtYWlsLCBkb21haW4gfSA9IGRlY29kZWQ7XG4gICAgICBjb25zdCB1c2VyRGF0YSA9IHtcbiAgICAgICAgaWQ6IF9pZCxcbiAgICAgICAgbmFtZSwgXG4gICAgICAgIGVtYWlsLCBcbiAgICAgICAgZG9tYWluXG4gICAgICB9O1xuICAgICAgYWRkVXNlcih1c2VyRGF0YSk7XG4gICAgfSBlbHNlIGlmICh1c2VyKSB7XG4gICAgICBjb25zb2xlLmxvZyh1c2VyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcm91dGVyLnB1c2goXCIvc2lnbmluXCIpO1xuICAgIH1cblxuICAgIHNldFN0YXRlKHtcbiAgICAgIGludGVyZXN0RGF0YVxuICAgIH0pXG4gIH0sIFtdKTtcblxuICBjb25zdCBmYWNlQXV0aFN0YXJ0ID0gKCkgPT4ge1xuICAgIGNvbnNvbGUubG9nKCcjIyMjIEZCIGF1dGggc3RhcnQnKVxuICB9XG5cbiAgY29uc3QgcmVzcG9uc2VGYWNlYm9vayA9IGFzeW5jIChyZXMpID0+IHtcbiAgICBjb25zdCB7YXV0aEZiLCB1c2VyfSA9IHByb3BzXG4gICAgY29uc3Qge2FjY2Vzc1Rva2VufSA9IHJlc1xuICAgIGF1dGhGYihhY2Nlc3NUb2tlbiwgdXNlci5pZClcbiAgfVxuXG4gIGNvbnN0IGdldEludGVyZXN0ID0gYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgbGV0IGludGVyZXN0cyA9IFtdXG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHNlYXJjaEludGVyZXN0KGZiVG9rZW4udG9rZW4sIHZhbHVlLCA1MDApXG4gICAgLy8gY29uc3QgbGV2ZWxPbmUgPSBhZGRTY29yZShkYXRhLmRhdGEsIDUpXG4gICAgLy8gY29uc3QgbmFtZXMgPSBnZXRJbnRlcmVzdE5hbWVzKGRhdGEuZGF0YSlcbiAgICAvLyBjb25zb2xlLmxvZyhuYW1lcylcbiAgICAvLyBzZXRTdGF0ZSh7XG4gICAgLy8gICBpbnRlcmVzdHM6IGxldmVsT25lXG4gICAgLy8gfSlcbiAgfVxuXG4gIGNvbnN0IG9uU2VsZWN0aW9uQ2hhbmdlID0gKHNlbGVjdGVkUm93S2V5cywgc2VsZWN0ZWRSb3dzKSA9PiB7XG4gICAgXG4gICAgY29uc3Qgc2VsZWN0ZWRJbnRlcmVzdCA9IHNlbGVjdGVkUm93cy5tYXAoaW50ZXJlc3QgPT4ge1xuICAgICAgcmV0dXJuIGludGVyZXN0Lm5hbWVcbiAgICB9KVxuICAgIGNvbnNvbGUubG9nKHNlbGVjdGVkSW50ZXJlc3QpXG4gICAgc2V0U3RhdGUoe1xuICAgICAgLi4uc3RhdGUsXG4gICAgICBzZWxlY3RlZFJvd0tleXMsXG4gICAgICBzZWxlY3RlZEludGVyZXN0XG4gICAgfSlcbiAgfVxuXG4gIGNvbnN0IGFjdGlvbnMgPSBbXG4gICAgPEZhY2Vib29rTG9naW5cbiAgICAgICAgYXBwSWQ9e3Byb2Nlc3MuZW52LkZCX0FQUF9JRH1cbiAgICAgICAgYXV0b0xvYWQ9e3RydWV9XG4gICAgICAgIGZpZWxkcz1cIm5hbWUsZW1haWwsaWRcIlxuICAgICAgICBvbkNsaWNrPXtmYWNlQXV0aFN0YXJ0fVxuICAgICAgICBzY29wZT1cImFkc19tYW5hZ2VtZW50LCBlbWFpbFwiXG4gICAgICAgIGNhbGxiYWNrPXtyZXNwb25zZUZhY2Vib29rfSBcbiAgICAgICAgcmVuZGVyPXtyZW5kZXJQcm9wcyA9PiAoXG4gICAgICAgICAgPEJ1dHRvbiB0eXBlPVwicHJpbWFyeVwiIG9uQ2xpY2s9e3JlbmRlclByb3BzLm9uQ2xpY2t9PkNvbm5lY3QgRmFjZWJvb2s8L0J1dHRvbj5cbiAgICAgICAgKX1cbiAgICAgICAgLz5cbiAgXVxuXG4gIGNvbnN0IHtpbnRlcmVzdHMsIHNlbGVjdGVkUm93S2V5c30gPSBzdGF0ZVxuICByZXR1cm4gKFxuICAgIDxEYXNoYm9hcmRMYXlvdXQ+XG4gICAgPGRpdiBpZD1cIndyYXBwZXJcIj5cbiAgICAgIDxIZWFkZXIgYWN0aW9ucz17YWN0aW9uc30vPlxuICAgICAgPGRpdiBpZD1cIm1haW4tY29udGVudFwiPlxuICAgICAgICA8U2VhcmNoXG4gICAgICAgICAgICBwbGFjZWhvbGRlcj1cIkZpbmQgRmFjZWJvb2sgaW50ZXJlc3QgZm9yIGEga2V5d29yZFwiXG4gICAgICAgICAgICBlbnRlckJ1dHRvbj1cIkdldGNoXCJcbiAgICAgICAgICAgIHNpemU9XCJsYXJnZVwiXG4gICAgICAgICAgICBvblNlYXJjaD17KHZhbHVlKSA9PiBnZXRJbnRlcmVzdCh2YWx1ZSl9XG4gICAgICAgICAgLz5cbiAgICAgICAgICA8ZGl2IGlkPVwidGFibGVcIj5cbiAgICAgICAgICAgIDxJbnRlcmVzdFRhYmxlIFxuICAgICAgICAgICAgb25TZWxlY3Rpb249e29uU2VsZWN0aW9uQ2hhbmdlfSBcbiAgICAgICAgICAgIHNlbGVjdGVkUm93S2V5cz17c2VsZWN0ZWRSb3dLZXlzfSBcbiAgICAgICAgICAgIGNsYXNzTmFtZT1cInRhYmxlXCIgY29sdW1ucz17dGFibGVDb2x1bW5zfSBcbiAgICAgICAgICAgIGRhdGFTb3VyY2U9e2ludGVyZXN0c30vPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIFxuICAgICAgPC9kaXY+XG4gICAgICAgIFxuXG4gICAgICA8c3R5bGUganN4PntgXG4gICAgICAgICN3cmFwcGVyIHtcbiAgICAgICAgICBtYXJnaW46IDEwcHg7XG4gICAgICAgIH1cbiAgICAgICAgI21haW4tY29udGVudCB7XG4gICAgICAgICAgbWFyZ2luLXRvcDogMzBweDtcbiAgICAgICAgfVxuICAgICAgICAjdGFibGUge1xuICAgICAgICAgIG1hcmdpbi10b3A6IDMwcHg7XG4gICAgICAgIH1cbiAgICAgIGB9PC9zdHlsZT5cbiAgICA8L2Rpdj5cbiAgICA8L0Rhc2hib2FyZExheW91dD5cbiAgKTtcbn07XG5cbkluZGV4LmdldEluaXRpYWxQcm9wcyA9IGFzeW5jIGZ1bmN0aW9uKGNvbnRleHQpIHtcbiAgY29uc3QgdG9rZW4gPSBjb250ZXh0LnF1ZXJ5LmF0O1xuICByZXR1cm4ge1xuICAgIHRva2VuXG4gIH07XG59O1xuXG5jb25zdCBtYXBTdGF0ZVRvUHJvcHMgPSBzdGF0ZSA9PiAoe1xuICB1c2VyOiBzdGF0ZS51c2VyLmN1cnJlbnRVc2VyLFxuICBmYlRva2VuOiBzdGF0ZS51c2VyLmZiVG9rZW4sXG4gIGludGVyZXN0RGF0YTogc3RhdGUuc2VhcmNoLmludGVyZXN0c1xufSk7XG5cbmNvbnN0IG1hcERpc3BhdGNoVG9Qcm9wcyA9IGRpc3BhdGNoID0+ICh7XG4gIGFkZFVzZXI6IGl0ZW0gPT4gZGlzcGF0Y2goYWRkaW5nQ3VycmVudFVzZXIoaXRlbSkpLFxuICBhdXRoRmI6ICh0b2tlbiwgaWQpID0+IGRpc3BhdGNoKGF1dGhGYWNlYm9vayh7dG9rZW4sIGlkfSkpLFxuICBzZWFyY2hJbnRlcmVzdDogKHRva2VuLCB2YWx1ZSwgbGltaXQpID0+IGRpc3BhdGNoKHNlYXJjaFN0YXJ0KHt0b2tlbiwgdmFsdWUsIGxpbWl0fSkpXG59KTtcblxuZXhwb3J0IGRlZmF1bHQgY29ubmVjdChtYXBTdGF0ZVRvUHJvcHMsIG1hcERpc3BhdGNoVG9Qcm9wcykoSW5kZXgpO1xuIl19 */\\n/*@ sourceURL=/code/ben/getch/frontend/pages/index.js */\")));\n};\n\nIndex.getInitialProps = function _callee(context) {\n  var token;\n  return _regeneratorRuntime.async(function _callee$(_context3) {\n    while (1) {\n      switch (_context3.prev = _context3.next) {\n        case 0:\n          token = context.query.at;\n          return _context3.abrupt(\"return\", {\n            token: token\n          });\n\n        case 2:\n        case \"end\":\n          return _context3.stop();\n      }\n    }\n  });\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    user: state.user.currentUser,\n    fbToken: state.user.fbToken,\n    interestData: state.search.interests\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    addUser: function addUser(item) {\n      return dispatch(addingCurrentUser(item));\n    },\n    authFb: function authFb(token, id) {\n      return dispatch(authFacebook({\n        token: token,\n        id: id\n      }));\n    },\n    searchInterest: function searchInterest(token, value, limit) {\n      return dispatch(searchStart({\n        token: token,\n        value: value,\n        limit: limit\n      }));\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Index);","map":{"version":3,"sources":["/code/ben/getch/frontend/pages/index.js"],"names":["useRouter","useEffect","useState","connect","FacebookLogin","DashboardLayout","Header","InterestTable","tableColumns","addScore","getInterestNames","decodeToken","addingCurrentUser","authFacebook","searchStart","Index","props","state","setState","token","user","addUser","fbToken","interestData","searchInterest","Search","router","decoded","_id","name","email","domain","userData","id","console","log","push","faceAuthStart","responseFacebook","res","authFb","accessToken","getInterest","value","interests","data","onSelectionChange","selectedRowKeys","selectedRows","selectedInterest","map","interest","actions","process","env","FB_APP_ID","renderProps","onClick","getInitialProps","context","query","at","mapStateToProps","currentUser","search","mapDispatchToProps","dispatch","item","limit"],"mappings":"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","sourcesContent":["import { useRouter } from \"next/router\";\nimport { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport { Button, Input, Tag } from \"antd\";\nimport FacebookLogin from 'react-facebook-login/dist/facebook-login-render-props';\n\nimport DashboardLayout from '../components/dashboardLayout'\nimport Header from '../components/header'\nimport InterestTable from '../components/table'\n\nimport {tableColumns} from '../utils/table'\nimport {addScore, getInterestNames} from '../utils/search'\n\nimport decodeToken from \"../utils/auth\";\nimport { addingCurrentUser, authFacebook } from \"../redux/user/user-actions\";\nimport {searchStart} from '../redux/search/search-actions'\n\n\nconst Index = props => {\n  const [state, setState] = useState({})\n  const { token, user, addUser, fbToken, interestData, searchInterest } = props;\n  const { Search } = Input;\n  const router = useRouter();\n\n  useEffect(() => {\n    if (token) {\n      const decoded = decodeToken(props.token);\n      const { _id, name, email, domain } = decoded;\n      const userData = {\n        id: _id,\n        name, \n        email, \n        domain\n      };\n      addUser(userData);\n    } else if (user) {\n      console.log(user);\n    } else {\n      router.push(\"/signin\");\n    }\n\n    setState({\n      interestData\n    })\n  }, []);\n\n  const faceAuthStart = () => {\n    console.log('#### FB auth start')\n  }\n\n  const responseFacebook = async (res) => {\n    const {authFb, user} = props\n    const {accessToken} = res\n    authFb(accessToken, user.id)\n  }\n\n  const getInterest = async (value) => {\n    let interests = []\n    const data = await searchInterest(fbToken.token, value, 500)\n    // const levelOne = addScore(data.data, 5)\n    // const names = getInterestNames(data.data)\n    // console.log(names)\n    // setState({\n    //   interests: levelOne\n    // })\n  }\n\n  const onSelectionChange = (selectedRowKeys, selectedRows) => {\n    \n    const selectedInterest = selectedRows.map(interest => {\n      return interest.name\n    })\n    console.log(selectedInterest)\n    setState({\n      ...state,\n      selectedRowKeys,\n      selectedInterest\n    })\n  }\n\n  const actions = [\n    <FacebookLogin\n        appId={process.env.FB_APP_ID}\n        autoLoad={true}\n        fields=\"name,email,id\"\n        onClick={faceAuthStart}\n        scope=\"ads_management, email\"\n        callback={responseFacebook} \n        render={renderProps => (\n          <Button type=\"primary\" onClick={renderProps.onClick}>Connect Facebook</Button>\n        )}\n        />\n  ]\n\n  const {interests, selectedRowKeys} = state\n  return (\n    <DashboardLayout>\n    <div id=\"wrapper\">\n      <Header actions={actions}/>\n      <div id=\"main-content\">\n        <Search\n            placeholder=\"Find Facebook interest for a keyword\"\n            enterButton=\"Getch\"\n            size=\"large\"\n            onSearch={(value) => getInterest(value)}\n          />\n          <div id=\"table\">\n            <InterestTable \n            onSelection={onSelectionChange} \n            selectedRowKeys={selectedRowKeys} \n            className=\"table\" columns={tableColumns} \n            dataSource={interests}/>\n          </div>\n          \n      </div>\n        \n\n      <style jsx>{`\n        #wrapper {\n          margin: 10px;\n        }\n        #main-content {\n          margin-top: 30px;\n        }\n        #table {\n          margin-top: 30px;\n        }\n      `}</style>\n    </div>\n    </DashboardLayout>\n  );\n};\n\nIndex.getInitialProps = async function(context) {\n  const token = context.query.at;\n  return {\n    token\n  };\n};\n\nconst mapStateToProps = state => ({\n  user: state.user.currentUser,\n  fbToken: state.user.fbToken,\n  interestData: state.search.interests\n});\n\nconst mapDispatchToProps = dispatch => ({\n  addUser: item => dispatch(addingCurrentUser(item)),\n  authFb: (token, id) => dispatch(authFacebook({token, id})),\n  searchInterest: (token, value, limit) => dispatch(searchStart({token, value, limit}))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Index);\n"]},"metadata":{},"sourceType":"module"}