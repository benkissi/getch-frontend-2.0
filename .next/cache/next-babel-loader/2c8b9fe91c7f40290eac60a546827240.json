{"ast":null,"code":"import \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nvar _jsxFileName = \"/code/ben/getch/frontend/pages/index.js\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useRouter } from \"next/router\";\nimport { useEffect } from \"react\";\nimport { connect } from \"react-redux\";\nimport FacebookLogin from 'react-facebook-login';\nimport { getProducts, fbAuthentication, searchInterest } from '../api/api';\nimport decodeToken from \"../utils/auth\";\nimport { addingCurrentUser, authFacebook } from \"../redux/user/user-actions\";\n\nvar Index = function Index(props) {\n  var router = useRouter();\n  useEffect(function () {\n    var token = props.token,\n        user = props.user,\n        addUser = props.addUser,\n        authFb = props.authFb;\n\n    if (token) {\n      var decoded = decodeToken(props.token);\n      var _id = decoded._id,\n          name = decoded.name,\n          email = decoded.email,\n          domain = decoded.domain;\n      var userData = {\n        id: _id,\n        name: name,\n        email: email,\n        domain: domain\n      };\n      addUser(userData);\n    } else if (user) {\n      console.log(user);\n    } else {\n      router.push(\"/signin\");\n    }\n  }, []);\n\n  var faceAuthStart = function faceAuthStart() {\n    console.log('#### FB auth start');\n  };\n\n  var responseFacebook = function responseFacebook(res) {\n    var accessToken;\n    return _regeneratorRuntime.async(function responseFacebook$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            console.log(res);\n            accessToken = res.accessToken;\n            _context.next = 4;\n            return _regeneratorRuntime.awrap(authFb(accessToken, user.id));\n\n          case 4:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    });\n  };\n\n  var fbAccess = \"EAAHq70ZCGT5QBAAZBVZBiPMgGUFpxnQehvZCmlTMZA3YeeJOALIiZAHtqEQwZBTHG7rPxb7qgAUZAD2Eo4ZAP9DUUN0Sv3iQR4vVgq2FsZANd8Dr3zhxMVhH5mFniuIQLF58Yfi0GObXdBRXCKflLJqJRKELxIhrhYXVYZD\";\n  return __jsx(\"div\", {\n    id: \"wrapper\",\n    className: \"jsx-1857536138\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47\n    },\n    __self: this\n  }, __jsx(\"p\", {\n    className: \"jsx-1857536138\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 48\n    },\n    __self: this\n  }, \"Hello Next.js\"), __jsx(FacebookLogin, {\n    appId: process.env.FB_APP_ID,\n    autoLoad: true,\n    fields: \"name,email,id\",\n    onClick: faceAuthStart,\n    scope: \"ads_management, email\",\n    callback: responseFacebook,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49\n    },\n    __self: this\n  }), __jsx(_Button, {\n    onClick: function onClick() {\n      return searchInterest(fbAccess, 'fish', 50);\n    },\n    type: \"danger\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56\n    },\n    __self: this\n  }, \"Primary\"), __jsx(\"p\", {\n    className: \"jsx-1857536138\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57\n    },\n    __self: this\n  }, \"Secret: \", process.env.FB_APP_SECRET), __jsx(_JSXStyle, {\n    id: \"1857536138\",\n    __self: this\n  }, \"#wrapper.jsx-1857536138{margin:10px;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9jb2RlL2Jlbi9nZXRjaC9mcm9udGVuZC9wYWdlcy9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUEwRGtCLEFBR3VCLFlBQ2QiLCJmaWxlIjoiL2NvZGUvYmVuL2dldGNoL2Zyb250ZW5kL3BhZ2VzL2luZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdXNlUm91dGVyIH0gZnJvbSBcIm5leHQvcm91dGVyXCI7XG5pbXBvcnQgeyB1c2VFZmZlY3QgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IGNvbm5lY3QgfSBmcm9tIFwicmVhY3QtcmVkdXhcIjtcbmltcG9ydCB7IEJ1dHRvbiB9IGZyb20gXCJhbnRkXCI7XG5pbXBvcnQgRmFjZWJvb2tMb2dpbiBmcm9tICdyZWFjdC1mYWNlYm9vay1sb2dpbic7XG5cbmltcG9ydCB7Z2V0UHJvZHVjdHMsIGZiQXV0aGVudGljYXRpb24sIHNlYXJjaEludGVyZXN0fSBmcm9tICcuLi9hcGkvYXBpJ1xuXG5pbXBvcnQgZGVjb2RlVG9rZW4gZnJvbSBcIi4uL3V0aWxzL2F1dGhcIjtcbmltcG9ydCB7IGFkZGluZ0N1cnJlbnRVc2VyLCBhdXRoRmFjZWJvb2sgfSBmcm9tIFwiLi4vcmVkdXgvdXNlci91c2VyLWFjdGlvbnNcIjtcblxuY29uc3QgSW5kZXggPSBwcm9wcyA9PiB7XG4gIGNvbnN0IHJvdXRlciA9IHVzZVJvdXRlcigpO1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGNvbnN0IHsgdG9rZW4sIHVzZXIsIGFkZFVzZXIsIGF1dGhGYiB9ID0gcHJvcHM7XG4gICAgaWYgKHRva2VuKSB7XG4gICAgICBjb25zdCBkZWNvZGVkID0gZGVjb2RlVG9rZW4ocHJvcHMudG9rZW4pO1xuICAgICAgY29uc3QgeyBfaWQsIG5hbWUsIGVtYWlsLCBkb21haW4gfSA9IGRlY29kZWQ7XG4gICAgICBjb25zdCB1c2VyRGF0YSA9IHtcbiAgICAgICAgaWQ6IF9pZCxcbiAgICAgICAgbmFtZSwgXG4gICAgICAgIGVtYWlsLCBcbiAgICAgICAgZG9tYWluXG4gICAgICB9O1xuICAgICAgYWRkVXNlcih1c2VyRGF0YSk7XG4gICAgfSBlbHNlIGlmICh1c2VyKSB7XG4gICAgICBjb25zb2xlLmxvZyh1c2VyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcm91dGVyLnB1c2goXCIvc2lnbmluXCIpO1xuICAgIH1cbiAgfSwgW10pO1xuXG4gIGNvbnN0IGZhY2VBdXRoU3RhcnQgPSAoKSA9PiB7XG4gICAgY29uc29sZS5sb2coJyMjIyMgRkIgYXV0aCBzdGFydCcpXG4gIH1cblxuICBjb25zdCByZXNwb25zZUZhY2Vib29rID0gYXN5bmMgKHJlcykgPT4ge1xuICAgIGNvbnNvbGUubG9nKHJlcylcbiAgICBjb25zdCB7YWNjZXNzVG9rZW59ID0gcmVzXG4gICAgYXdhaXQgYXV0aEZiKGFjY2Vzc1Rva2VuLCB1c2VyLmlkKVxuICB9XG5cbiAgY29uc3QgZmJBY2Nlc3MgPSBcIkVBQUhxNzBaQ0dUNVFCQUFaQlZaQmlQTWdHVUZweG5RZWh2WkNtbFRNWkEzWWVlSk9BTElpWkFIdHFFUXdaQlRIRzdyUHhiN3FnQVVaQUQyRW80WkFQOURVVU4wU3YzaVFSNHZWZ3EyRnNaQU5kOERyM3poeE1WaEg1bUZuaXVJUUxGNThZZmkwR09iWGRCUlhDS2ZsTEpxSlJLRUx4SWhyaFlYVllaRFwiXG4gIFxuXG4gIHJldHVybiAoXG4gICAgPGRpdiBpZD1cIndyYXBwZXJcIj5cbiAgICAgIDxwPkhlbGxvIE5leHQuanM8L3A+XG4gICAgICA8RmFjZWJvb2tMb2dpblxuICAgICAgICBhcHBJZD17cHJvY2Vzcy5lbnYuRkJfQVBQX0lEfVxuICAgICAgICBhdXRvTG9hZD17dHJ1ZX1cbiAgICAgICAgZmllbGRzPVwibmFtZSxlbWFpbCxpZFwiXG4gICAgICAgIG9uQ2xpY2s9e2ZhY2VBdXRoU3RhcnR9XG4gICAgICAgIHNjb3BlPVwiYWRzX21hbmFnZW1lbnQsIGVtYWlsXCJcbiAgICAgICAgY2FsbGJhY2s9e3Jlc3BvbnNlRmFjZWJvb2t9IC8+XG4gICAgICA8QnV0dG9uIG9uQ2xpY2s9eygpID0+IHNlYXJjaEludGVyZXN0KGZiQWNjZXNzLCAnZmlzaCcsIDUwKX0gdHlwZT1cImRhbmdlclwiPlByaW1hcnk8L0J1dHRvbj5cbiAgICAgIDxwPlNlY3JldDoge3Byb2Nlc3MuZW52LkZCX0FQUF9TRUNSRVR9PC9wPlxuXG4gICAgICA8c3R5bGUganN4PntgXG4gICAgICAgICN3cmFwcGVyIHtcbiAgICAgICAgICBtYXJnaW46IDEwcHg7XG4gICAgICAgIH1cbiAgICAgIGB9PC9zdHlsZT5cbiAgICA8L2Rpdj5cbiAgKTtcbn07XG5cbkluZGV4LmdldEluaXRpYWxQcm9wcyA9IGFzeW5jIGZ1bmN0aW9uKGNvbnRleHQpIHtcbiAgY29uc3QgdG9rZW4gPSBjb250ZXh0LnF1ZXJ5LmF0O1xuICByZXR1cm4ge1xuICAgIHRva2VuXG4gIH07XG59O1xuXG5jb25zdCBtYXBTdGF0ZVRvUHJvcHMgPSBzdGF0ZSA9PiAoe1xuICB1c2VyOiBzdGF0ZS51c2VyLmN1cnJlbnRVc2VyXG59KTtcblxuY29uc3QgbWFwRGlzcGF0Y2hUb1Byb3BzID0gZGlzcGF0Y2ggPT4gKHtcbiAgYWRkVXNlcjogaXRlbSA9PiBkaXNwYXRjaChhZGRpbmdDdXJyZW50VXNlcihpdGVtKSksXG4gIGF1dGhGYjogZGF0YSA9PiBkaXNwYXRjaChhdXRoRmFjZWJvb2soZGF0YSkpXG59KTtcblxuZXhwb3J0IGRlZmF1bHQgY29ubmVjdChtYXBTdGF0ZVRvUHJvcHMsIG1hcERpc3BhdGNoVG9Qcm9wcykoSW5kZXgpO1xuIl19 */\\n/*@ sourceURL=/code/ben/getch/frontend/pages/index.js */\"));\n};\n\nIndex.getInitialProps = function _callee(context) {\n  var token;\n  return _regeneratorRuntime.async(function _callee$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          token = context.query.at;\n          return _context2.abrupt(\"return\", {\n            token: token\n          });\n\n        case 2:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  });\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    user: state.user.currentUser\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    addUser: function addUser(item) {\n      return dispatch(addingCurrentUser(item));\n    },\n    authFb: function authFb(data) {\n      return dispatch(authFacebook(data));\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Index);","map":{"version":3,"sources":["/code/ben/getch/frontend/pages/index.js"],"names":["useRouter","useEffect","connect","FacebookLogin","getProducts","fbAuthentication","searchInterest","decodeToken","addingCurrentUser","authFacebook","Index","props","router","token","user","addUser","authFb","decoded","_id","name","email","domain","userData","id","console","log","push","faceAuthStart","responseFacebook","res","accessToken","fbAccess","process","env","FB_APP_ID","FB_APP_SECRET","getInitialProps","context","query","at","mapStateToProps","state","currentUser","mapDispatchToProps","dispatch","item","data"],"mappings":"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","sourcesContent":["import { useRouter } from \"next/router\";\nimport { useEffect } from \"react\";\nimport { connect } from \"react-redux\";\nimport { Button } from \"antd\";\nimport FacebookLogin from 'react-facebook-login';\n\nimport {getProducts, fbAuthentication, searchInterest} from '../api/api'\n\nimport decodeToken from \"../utils/auth\";\nimport { addingCurrentUser, authFacebook } from \"../redux/user/user-actions\";\n\nconst Index = props => {\n  const router = useRouter();\n  useEffect(() => {\n    const { token, user, addUser, authFb } = props;\n    if (token) {\n      const decoded = decodeToken(props.token);\n      const { _id, name, email, domain } = decoded;\n      const userData = {\n        id: _id,\n        name, \n        email, \n        domain\n      };\n      addUser(userData);\n    } else if (user) {\n      console.log(user);\n    } else {\n      router.push(\"/signin\");\n    }\n  }, []);\n\n  const faceAuthStart = () => {\n    console.log('#### FB auth start')\n  }\n\n  const responseFacebook = async (res) => {\n    console.log(res)\n    const {accessToken} = res\n    await authFb(accessToken, user.id)\n  }\n\n  const fbAccess = \"EAAHq70ZCGT5QBAAZBVZBiPMgGUFpxnQehvZCmlTMZA3YeeJOALIiZAHtqEQwZBTHG7rPxb7qgAUZAD2Eo4ZAP9DUUN0Sv3iQR4vVgq2FsZANd8Dr3zhxMVhH5mFniuIQLF58Yfi0GObXdBRXCKflLJqJRKELxIhrhYXVYZD\"\n  \n\n  return (\n    <div id=\"wrapper\">\n      <p>Hello Next.js</p>\n      <FacebookLogin\n        appId={process.env.FB_APP_ID}\n        autoLoad={true}\n        fields=\"name,email,id\"\n        onClick={faceAuthStart}\n        scope=\"ads_management, email\"\n        callback={responseFacebook} />\n      <Button onClick={() => searchInterest(fbAccess, 'fish', 50)} type=\"danger\">Primary</Button>\n      <p>Secret: {process.env.FB_APP_SECRET}</p>\n\n      <style jsx>{`\n        #wrapper {\n          margin: 10px;\n        }\n      `}</style>\n    </div>\n  );\n};\n\nIndex.getInitialProps = async function(context) {\n  const token = context.query.at;\n  return {\n    token\n  };\n};\n\nconst mapStateToProps = state => ({\n  user: state.user.currentUser\n});\n\nconst mapDispatchToProps = dispatch => ({\n  addUser: item => dispatch(addingCurrentUser(item)),\n  authFb: data => dispatch(authFacebook(data))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Index);\n"]},"metadata":{},"sourceType":"module"}