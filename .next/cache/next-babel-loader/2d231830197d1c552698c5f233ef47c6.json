{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport \"antd/lib/modal/style\";\nimport _Modal from \"antd/lib/modal\";\nimport \"antd/lib/row/style\";\nimport _Row from \"antd/lib/row\";\nimport \"antd/lib/col/style\";\nimport _Col from \"antd/lib/col\";\nimport \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/select/style\";\nimport _Select from \"antd/lib/select\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/home/benkissi/projects/getch/getch-frontend-2.0/pages/performance.js\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useState, useEffect } from \"react\";\nimport { connect } from \"react-redux\";\nimport { chartData } from \"../utils/table\";\nimport Table from \"../components/table\";\nimport AdAccount from \"../components/adAccount\";\nimport { performanceColumns } from \"../utils/table\";\nimport { getAdAccounts, fbPaginate, getCampaigns } from \"../api/api\";\n\nfunction Performance(props) {\n  var _useState = useState({\n    accountModalVisible: false,\n    campaignModalVisible: false,\n    selectedRowKeys: null,\n    pagingAccounts: {\n      next: \"\",\n      previous: \"\"\n    },\n    pagingCampaigns: {\n      next: \"\",\n      previous: \"\"\n    },\n    selectedAdAccount: {},\n    selectedCampaign: {},\n    fetchingCampaigns: false\n  }),\n      state = _useState[0],\n      setState = _useState[1];\n\n  var fbId = props.fbId,\n      user = props.user;\n  useEffect(function () {\n    if (true) {\n      console.log(\"on browser\");\n\n      var _require = require(\"@antv/g2plot\"),\n          Column = _require.Column;\n\n      var chart = new Column(document.getElementById(\"chart\"), {\n        data: chartData,\n        xField: \"name\",\n        yField: \"value\",\n        padding: \"auto\",\n        title: {\n          visible: true,\n          text: \"Interest stats\"\n        },\n        forceFit: true\n      });\n      console.log(\"el\", document.getElementById(\"chart\"));\n      chart.render();\n    }\n  }, []);\n  useEffect(function () {\n    fetchAdAccounts();\n  }, [state.accountModalVisible]);\n  useEffect(function () {\n    if (state.selectedAdAccount.id) {\n      fetchCampaigns();\n    }\n  }, [state.selectedAdAccount]);\n  useEffect(function () {}, [state.campaigns]);\n\n  var setModalVisible = function setModalVisible(status, modalName) {\n    setState(_objectSpread({}, state, _defineProperty({}, modalName, status)));\n  };\n\n  var setCampaignsModal = function setCampaignsModal(modalVisible) {\n    setState(_objectSpread({}, state, {\n      campaignModalVisible: modalVisible\n    }));\n  };\n\n  var fetchAdAccounts = function fetchAdAccounts() {\n    var adAccounts;\n    return _regeneratorRuntime.async(function fetchAdAccounts$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (!state.accountModalVisible) {\n              _context.next = 5;\n              break;\n            }\n\n            _context.next = 3;\n            return _regeneratorRuntime.awrap(getAdAccounts(fbId, user.xToken));\n\n          case 3:\n            adAccounts = _context.sent;\n            setState(_objectSpread({}, state, {\n              adAccounts: adAccounts,\n              pagingAccounts: {\n                next: adAccounts.paging.next && adAccounts.paging.next,\n                previous: adAccounts.paging.previous && adAccounts.paging.previous\n              }\n            }));\n\n          case 5:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    });\n  };\n\n  var fetchCampaigns = function fetchCampaigns() {\n    var accountId, res;\n    return _regeneratorRuntime.async(function fetchCampaigns$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            setState(_objectSpread({}, state, {\n              fetchingCampaigns: true\n            }));\n            accountId = state.selectedAdAccount.id;\n            _context2.next = 4;\n            return _regeneratorRuntime.awrap(getCampaigns(accountId, user.xToken));\n\n          case 4:\n            res = _context2.sent;\n            console.log(\"campaigns\", res);\n            setState(_objectSpread({}, state, {\n              campaigns: res,\n              fetchingCampaigns: false,\n              pagingCampaigns: {\n                next: res.paging && res.paging.next,\n                previous: res.paging && res.paging.previous\n              }\n            }));\n\n          case 7:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    });\n  };\n\n  var handleAccountPagination = function handleAccountPagination(page) {\n    var adAccounts;\n    return _regeneratorRuntime.async(function handleAccountPagination$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.next = 2;\n            return _regeneratorRuntime.awrap(fbPaginate(page));\n\n          case 2:\n            adAccounts = _context3.sent;\n            console.log(\"paginate\", adAccounts);\n            setState(_objectSpread({}, state, {\n              adAccounts: adAccounts,\n              pagingAccounts: {\n                next: adAccounts.paging && adAccounts.paging.next,\n                previous: adAccounts.paging && adAccounts.paging.previous\n              }\n            }));\n\n          case 5:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    });\n  };\n\n  var handleCampaignPagination = function handleCampaignPagination(page) {\n    var campaigns;\n    return _regeneratorRuntime.async(function handleCampaignPagination$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            _context4.next = 2;\n            return _regeneratorRuntime.awrap(fbPaginate(page));\n\n          case 2:\n            campaigns = _context4.sent;\n            console.log(\"paginate\", campaigns);\n            setState(_objectSpread({}, state, {\n              campaigns: campaigns,\n              pagingCampaigns: {\n                next: campaigns.paging && campaigns.paging.next,\n                previous: campaigns.paging && campaigns.paging.previous\n              }\n            }));\n\n          case 5:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    });\n  };\n\n  var onSelectionChange = function onSelectionChange(selectedRowKeys, selectedRows) {\n    console.log(\"rows\", selectedRows);\n    var selectedInterest = selectedRows.map(function (interest) {\n      return interest.name;\n    });\n    setState(_objectSpread({}, state, {\n      selectedRowKeys: selectedRowKeys,\n      selectedInterest: selectedInterest,\n      selectedRows: selectedRows\n    }));\n  };\n\n  var handleAccountSelect = function handleAccountSelect(id, name) {\n    setState(_objectSpread({}, state, {\n      selectedAdAccount: {\n        id: id,\n        name: name\n      },\n      accountModalVisible: false\n    }));\n  };\n\n  var handleCampaignSelect = function handleCampaignSelect(id, name) {\n    setState(_objectSpread({}, state, {\n      selectedCampaign: {\n        id: id,\n        name: name\n      },\n      campaignModalVisible: false\n    }));\n  };\n\n  var onOptionScroll = function onOptionScroll() {\n    return _regeneratorRuntime.async(function onOptionScroll$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            if (state.campaigns.paging.next) {// const res = await fbPaginate(state.campaigns.paging.next)\n              // console.log('paging',res)\n            }\n\n          case 1:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    });\n  };\n\n  var Option = _Select.Option;\n  var selectedRowKeys = state.selectedRowKeys;\n  return __jsx(\"div\", {\n    id: \"performance\",\n    className: \"jsx-232318478\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185\n    },\n    __self: this\n  }, __jsx(_Row, {\n    gutter: 16,\n    style: {\n      width: \"100%\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186\n    },\n    __self: this\n  }, __jsx(_Col, {\n    span: 4,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"jsx-232318478\" + \" \" + \"selection\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"jsx-232318478\" + \" \" + \"button item\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189\n    },\n    __self: this\n  }, __jsx(_Button, {\n    onClick: function onClick() {\n      return setModalVisible(true, 'accountModalVisible');\n    },\n    block: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190\n    },\n    __self: this\n  }, state.selectedAdAccount.name ? state.selectedAdAccount.name : \"Select Ad Account\")), __jsx(\"div\", {\n    className: \"jsx-232318478\" + \" \" + \"select item\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196\n    },\n    __self: this\n  }, __jsx(_Button, {\n    onClick: function onClick() {\n      return setCampaignsModal(true);\n    },\n    block: true,\n    loading: state.fetchingCampaigns,\n    disabled: !!state.selectedAdAccount.name,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197\n    },\n    __self: this\n  }, state.selectedCampaign.name ? state.selectedCampaign.name : \"Select Campaign\")), __jsx(\"div\", {\n    className: \"jsx-232318478\" + \" \" + \"select item\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227\n    },\n    __self: this\n  }, __jsx(_Select, {\n    style: {\n      width: \"100%\"\n    },\n    placeholder: \"Select adset\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228\n    },\n    __self: this\n  }, __jsx(Option, {\n    value: \"jack\",\n    className: \"jsx-232318478\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229\n    },\n    __self: this\n  }, \"Jack\"), __jsx(Option, {\n    value: \"lucy\",\n    className: \"jsx-232318478\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230\n    },\n    __self: this\n  }, \"Lucy\"), __jsx(Option, {\n    value: \"disabled\",\n    disabled: true,\n    className: \"jsx-232318478\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231\n    },\n    __self: this\n  }, \"Disabled\"), __jsx(Option, {\n    value: \"Yiminghe\",\n    className: \"jsx-232318478\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234\n    },\n    __self: this\n  }, \"yiminghe\"))), __jsx(\"div\", {\n    className: \"jsx-232318478\" + \" \" + \"select item\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237\n    },\n    __self: this\n  }, __jsx(_Select, {\n    style: {\n      width: \"100%\"\n    },\n    placeholder: \"Select ad\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238\n    },\n    __self: this\n  }, __jsx(Option, {\n    value: \"jack\",\n    className: \"jsx-232318478\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239\n    },\n    __self: this\n  }, \"Jack\"), __jsx(Option, {\n    value: \"lucy\",\n    className: \"jsx-232318478\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 240\n    },\n    __self: this\n  }, \"Lucy\"), __jsx(Option, {\n    value: \"disabled\",\n    disabled: true,\n    className: \"jsx-232318478\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241\n    },\n    __self: this\n  }, \"Disabled\"), __jsx(Option, {\n    value: \"Yiminghe\",\n    className: \"jsx-232318478\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 244\n    },\n    __self: this\n  }, \"yiminghe\"))))), __jsx(_Col, {\n    span: 20,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 249\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"jsx-232318478\" + \" \" + \"stats\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 250\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    id: \"chart\",\n    className: \"jsx-232318478\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251\n    },\n    __self: this\n  }), __jsx(\"div\", {\n    className: \"jsx-232318478\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252\n    },\n    __self: this\n  }, __jsx(Table, {\n    columns: performanceColumns,\n    onSelection: onSelectionChange,\n    selectedRowKeys: selectedRowKeys,\n    className: \"table\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253\n    },\n    __self: this\n  }))))), __jsx(_Modal, {\n    title: \"Select an Ad account\",\n    centered: true,\n    visible: state.accountModalVisible,\n    onOk: function onOk() {\n      return setModalVisible(false, 'accountModalVisible');\n    },\n    onCancel: function onCancel() {\n      return setModalVisible(false, 'accountModalVisible');\n    },\n    okText: \"Next\",\n    cancelText: \"Previous\",\n    okButtonProps: {\n      disabled: !!!state.pagingAccounts.next,\n      onClick: function onClick() {\n        return handleAccountPagination(state.pagingAccounts.next);\n      }\n    },\n    cancelButtonProps: {\n      disabled: !!!state.pagingAccounts.previous,\n      onClick: function onClick() {\n        return handleAccountPagination(state.pagingAccounts.previous);\n      }\n    },\n    width: 1300,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 263\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"jsx-232318478\" + \" \" + \"adAccounts\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 281\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"jsx-232318478\" + \" \" + \"inner\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 282\n    },\n    __self: this\n  }, state.adAccounts ? state.adAccounts.data.map(function (item, index) {\n    return __jsx(\"div\", {\n      key: index,\n      className: \"jsx-232318478\" + \" \" + \"account\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 285\n      },\n      __self: this\n    }, __jsx(AdAccount, {\n      name: item.name,\n      accountId: item.id,\n      status: item.account_status,\n      onSelect: handleAccountSelect,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 286\n      },\n      __self: this\n    }));\n  }) : \"Loading...\"))), __jsx(_Modal, {\n    title: \"Select a campaign\",\n    centered: true,\n    visible: state.campaignModalVisible,\n    onOk: function onOk() {\n      return setCampaignsModal(false, \"campaignModalVisible\");\n    },\n    onCancel: function onCancel() {\n      return setCampaignsModal(false, \"campaignModalVisible\");\n    },\n    okText: \"Next\",\n    cancelText: \"Previous\",\n    okButtonProps: {\n      disabled: !!!state.pagingCampaigns.next,\n      onClick: function onClick() {\n        return handleCampaignPagination(state.pagingCampaigns.next);\n      }\n    },\n    cancelButtonProps: {\n      disabled: !!!state.pagingCampaigns.previous,\n      onClick: function onClick() {\n        return handleCampaignPagination(state.pagingCampaigns.previous);\n      }\n    },\n    width: 1300,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 298\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"jsx-232318478\" + \" \" + \"adAccounts\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 316\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"jsx-232318478\" + \" \" + \"inner\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 317\n    },\n    __self: this\n  }, state.campaigns ? state.campaigns.data.map(function (item, index) {\n    return __jsx(\"div\", {\n      key: index,\n      className: \"jsx-232318478\" + \" \" + \"account\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 320\n      },\n      __self: this\n    }, __jsx(AdAccount, {\n      name: item.name,\n      accountId: item.id // status={item.account_status}\n      ,\n      onSelect: handleCampaignSelect,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 321\n      },\n      __self: this\n    }));\n  }) : \"Loading...\"))), __jsx(_JSXStyle, {\n    id: \"232318478\",\n    __self: this\n  }, \"#performance.jsx-232318478{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;position:relative;margin-top:70px;width:100%;}.selection.jsx-232318478{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;border:1px solid #ccc;border-radius:4px;height:auto;padding:10px;}.item.jsx-232318478{margin-bottom:30px;width:100%;}.stats.jsx-232318478{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.adAccounts.jsx-232318478{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}.adAccounts.jsx-232318478 .inner.jsx-232318478{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;width:90%;}.account.jsx-232318478{min-width:20%;margin:10px;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2Jlbmtpc3NpL3Byb2plY3RzL2dldGNoL2dldGNoLWZyb250ZW5kLTIuMC9wYWdlcy9wZXJmb3JtYW5jZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUE2VVMsQUFHMEIsQUFPQSxBQVNNLEFBSU4sQUFLQSxBQUtBLEFBTUMsY0FDRixLQXBCRCxPQXFCYixJQXBCQSw0Q0FqQm9CLEFBT0ksQUFhQSxBQUtDLEFBS1Isa0JBN0JDLGdCQUNMLFdBQ2IsWUE0QlksVUFDWixXQXhCd0IsQUFheEIscUJBS0EsQ0FqQm9CLGtCQUNOLFlBQ0MsYUFDZiIsImZpbGUiOiIvaG9tZS9iZW5raXNzaS9wcm9qZWN0cy9nZXRjaC9nZXRjaC1mcm9udGVuZC0yLjAvcGFnZXMvcGVyZm9ybWFuY2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB1c2VTdGF0ZSwgdXNlRWZmZWN0IH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBjb25uZWN0IH0gZnJvbSBcInJlYWN0LXJlZHV4XCI7XG5pbXBvcnQgeyBNb2RhbCwgQnV0dG9uLCBTZWxlY3QsIFJvdywgQ29sIH0gZnJvbSBcImFudGRcIjtcblxuaW1wb3J0IHsgY2hhcnREYXRhIH0gZnJvbSBcIi4uL3V0aWxzL3RhYmxlXCI7XG5cbmltcG9ydCBUYWJsZSBmcm9tIFwiLi4vY29tcG9uZW50cy90YWJsZVwiO1xuaW1wb3J0IEFkQWNjb3VudCBmcm9tIFwiLi4vY29tcG9uZW50cy9hZEFjY291bnRcIjtcbmltcG9ydCB7IHBlcmZvcm1hbmNlQ29sdW1ucyB9IGZyb20gXCIuLi91dGlscy90YWJsZVwiO1xuaW1wb3J0IHsgZ2V0QWRBY2NvdW50cywgZmJQYWdpbmF0ZSwgZ2V0Q2FtcGFpZ25zIH0gZnJvbSBcIi4uL2FwaS9hcGlcIjtcblxuZnVuY3Rpb24gUGVyZm9ybWFuY2UocHJvcHMpIHtcbiAgY29uc3QgW3N0YXRlLCBzZXRTdGF0ZV0gPSB1c2VTdGF0ZSh7XG4gICAgYWNjb3VudE1vZGFsVmlzaWJsZTogZmFsc2UsXG4gICAgY2FtcGFpZ25Nb2RhbFZpc2libGU6IGZhbHNlLFxuICAgIHNlbGVjdGVkUm93S2V5czogbnVsbCxcbiAgICBwYWdpbmdBY2NvdW50czoge1xuICAgICAgbmV4dDogXCJcIixcbiAgICAgIHByZXZpb3VzOiBcIlwiXG4gICAgfSxcbiAgICBwYWdpbmdDYW1wYWlnbnM6IHtcbiAgICAgIG5leHQ6IFwiXCIsXG4gICAgICBwcmV2aW91czogXCJcIlxuICAgIH0sXG4gICAgc2VsZWN0ZWRBZEFjY291bnQ6IHt9LFxuICAgIHNlbGVjdGVkQ2FtcGFpZ246IHt9LFxuICAgIGZldGNoaW5nQ2FtcGFpZ25zOiBmYWxzZVxuICB9KTtcblxuICBjb25zdCB7IGZiSWQsIHVzZXIgfSA9IHByb3BzO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwib24gYnJvd3NlclwiKTtcbiAgICAgIGNvbnN0IHsgQ29sdW1uIH0gPSByZXF1aXJlKFwiQGFudHYvZzJwbG90XCIpO1xuXG4gICAgICBjb25zdCBjaGFydCA9IG5ldyBDb2x1bW4oZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjaGFydFwiKSwge1xuICAgICAgICBkYXRhOiBjaGFydERhdGEsXG4gICAgICAgIHhGaWVsZDogXCJuYW1lXCIsXG4gICAgICAgIHlGaWVsZDogXCJ2YWx1ZVwiLFxuICAgICAgICBwYWRkaW5nOiBcImF1dG9cIixcbiAgICAgICAgdGl0bGU6IHtcbiAgICAgICAgICB2aXNpYmxlOiB0cnVlLFxuICAgICAgICAgIHRleHQ6IFwiSW50ZXJlc3Qgc3RhdHNcIlxuICAgICAgICB9LFxuICAgICAgICBmb3JjZUZpdDogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBjb25zb2xlLmxvZyhcImVsXCIsIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2hhcnRcIikpO1xuICAgICAgY2hhcnQucmVuZGVyKCk7XG4gICAgfVxuICB9LCBbXSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBmZXRjaEFkQWNjb3VudHMoKTtcbiAgfSwgW3N0YXRlLmFjY291bnRNb2RhbFZpc2libGVdKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChzdGF0ZS5zZWxlY3RlZEFkQWNjb3VudC5pZCkge1xuICAgICAgZmV0Y2hDYW1wYWlnbnMoKTtcbiAgICB9XG4gIH0sIFtzdGF0ZS5zZWxlY3RlZEFkQWNjb3VudF0pO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgXG4gIH0sIFtzdGF0ZS5jYW1wYWlnbnNdKTtcblxuICBjb25zdCBzZXRNb2RhbFZpc2libGUgPSAoc3RhdHVzLCBtb2RhbE5hbWUpID0+IHtcbiAgICBzZXRTdGF0ZSh7XG4gICAgICAuLi5zdGF0ZSxcbiAgICAgIFttb2RhbE5hbWVdOiBzdGF0dXNcbiAgICB9KTtcbiAgfTtcblxuICBjb25zdCBzZXRDYW1wYWlnbnNNb2RhbCA9IChtb2RhbFZpc2libGUpID0+IHtcbiAgICBzZXRTdGF0ZSh7XG4gICAgICAuLi5zdGF0ZSxcbiAgICAgIGNhbXBhaWduTW9kYWxWaXNpYmxlOiBtb2RhbFZpc2libGVcbiAgICB9KTtcbiAgfVxuXG4gIGNvbnN0IGZldGNoQWRBY2NvdW50cyA9IGFzeW5jICgpID0+IHtcbiAgICBpZiAoc3RhdGUuYWNjb3VudE1vZGFsVmlzaWJsZSkge1xuICAgICAgY29uc3QgYWRBY2NvdW50cyA9IGF3YWl0IGdldEFkQWNjb3VudHMoZmJJZCwgdXNlci54VG9rZW4pO1xuICAgICAgc2V0U3RhdGUoe1xuICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgYWRBY2NvdW50czogYWRBY2NvdW50cyxcbiAgICAgICAgcGFnaW5nQWNjb3VudHM6IHtcbiAgICAgICAgICBuZXh0OiBhZEFjY291bnRzLnBhZ2luZy5uZXh0ICYmIGFkQWNjb3VudHMucGFnaW5nLm5leHQsXG4gICAgICAgICAgcHJldmlvdXM6IGFkQWNjb3VudHMucGFnaW5nLnByZXZpb3VzICYmIGFkQWNjb3VudHMucGFnaW5nLnByZXZpb3VzXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBmZXRjaENhbXBhaWducyA9IGFzeW5jICgpID0+IHtcbiAgICBzZXRTdGF0ZSh7XG4gICAgICAuLi5zdGF0ZSxcbiAgICAgIGZldGNoaW5nQ2FtcGFpZ25zOiB0cnVlXG4gICAgfSlcbiAgICBjb25zdCBhY2NvdW50SWQgPSBzdGF0ZS5zZWxlY3RlZEFkQWNjb3VudC5pZDtcbiAgICBjb25zdCByZXMgPSBhd2FpdCBnZXRDYW1wYWlnbnMoYWNjb3VudElkLCB1c2VyLnhUb2tlbik7XG4gICAgY29uc29sZS5sb2coXCJjYW1wYWlnbnNcIiwgcmVzKTtcbiAgICBzZXRTdGF0ZSh7XG4gICAgICAuLi5zdGF0ZSxcbiAgICAgIGNhbXBhaWduczogcmVzLFxuICAgICAgZmV0Y2hpbmdDYW1wYWlnbnM6IGZhbHNlLFxuICAgICAgcGFnaW5nQ2FtcGFpZ25zOiB7XG4gICAgICAgIG5leHQ6IHJlcy5wYWdpbmcgJiYgcmVzLnBhZ2luZy5uZXh0LFxuICAgICAgICBwcmV2aW91czogcmVzLnBhZ2luZyAmJiByZXMucGFnaW5nLnByZXZpb3VzXG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgY29uc3QgaGFuZGxlQWNjb3VudFBhZ2luYXRpb24gPSBhc3luYyBwYWdlID0+IHtcbiAgICBjb25zdCBhZEFjY291bnRzID0gYXdhaXQgZmJQYWdpbmF0ZShwYWdlKTtcbiAgICBjb25zb2xlLmxvZyhcInBhZ2luYXRlXCIsIGFkQWNjb3VudHMpO1xuICAgIHNldFN0YXRlKHtcbiAgICAgIC4uLnN0YXRlLFxuICAgICAgYWRBY2NvdW50czogYWRBY2NvdW50cyxcbiAgICAgIHBhZ2luZ0FjY291bnRzOiB7XG4gICAgICAgIG5leHQ6IGFkQWNjb3VudHMucGFnaW5nICYmIGFkQWNjb3VudHMucGFnaW5nLm5leHQsXG4gICAgICAgIHByZXZpb3VzOiBhZEFjY291bnRzLnBhZ2luZyAmJiBhZEFjY291bnRzLnBhZ2luZy5wcmV2aW91c1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xuXG4gIGNvbnN0IGhhbmRsZUNhbXBhaWduUGFnaW5hdGlvbiA9IGFzeW5jIHBhZ2UgPT4ge1xuICAgIGNvbnN0IGNhbXBhaWducyA9IGF3YWl0IGZiUGFnaW5hdGUocGFnZSk7XG4gICAgY29uc29sZS5sb2coXCJwYWdpbmF0ZVwiLCBjYW1wYWlnbnMpO1xuICAgIHNldFN0YXRlKHtcbiAgICAgIC4uLnN0YXRlLFxuICAgICAgY2FtcGFpZ25zOiBjYW1wYWlnbnMsXG4gICAgICBwYWdpbmdDYW1wYWlnbnM6IHtcbiAgICAgICAgbmV4dDogY2FtcGFpZ25zLnBhZ2luZyAmJiBjYW1wYWlnbnMucGFnaW5nLm5leHQsXG4gICAgICAgIHByZXZpb3VzOiBjYW1wYWlnbnMucGFnaW5nICYmIGNhbXBhaWducy5wYWdpbmcucHJldmlvdXNcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICBjb25zdCBvblNlbGVjdGlvbkNoYW5nZSA9IChzZWxlY3RlZFJvd0tleXMsIHNlbGVjdGVkUm93cykgPT4ge1xuICAgIGNvbnNvbGUubG9nKFwicm93c1wiLCBzZWxlY3RlZFJvd3MpO1xuICAgIGNvbnN0IHNlbGVjdGVkSW50ZXJlc3QgPSBzZWxlY3RlZFJvd3MubWFwKGludGVyZXN0ID0+IHtcbiAgICAgIHJldHVybiBpbnRlcmVzdC5uYW1lO1xuICAgIH0pO1xuICAgIHNldFN0YXRlKHtcbiAgICAgIC4uLnN0YXRlLFxuICAgICAgc2VsZWN0ZWRSb3dLZXlzLFxuICAgICAgc2VsZWN0ZWRJbnRlcmVzdCxcbiAgICAgIHNlbGVjdGVkUm93c1xuICAgIH0pO1xuICB9O1xuXG4gIGNvbnN0IGhhbmRsZUFjY291bnRTZWxlY3QgPSAoaWQsIG5hbWUpID0+IHtcbiAgICBzZXRTdGF0ZSh7XG4gICAgICAuLi5zdGF0ZSxcbiAgICAgIHNlbGVjdGVkQWRBY2NvdW50OiB7XG4gICAgICAgIGlkLFxuICAgICAgICBuYW1lXG4gICAgICB9LFxuICAgICAgYWNjb3VudE1vZGFsVmlzaWJsZTogZmFsc2UsXG4gICAgfSk7XG4gIH07XG5cbiAgY29uc3QgaGFuZGxlQ2FtcGFpZ25TZWxlY3QgPSAoaWQsIG5hbWUpID0+IHtcbiAgICBzZXRTdGF0ZSh7XG4gICAgICAuLi5zdGF0ZSxcbiAgICAgIHNlbGVjdGVkQ2FtcGFpZ246IHtcbiAgICAgICAgaWQsXG4gICAgICAgIG5hbWVcbiAgICAgIH0sXG4gICAgICBjYW1wYWlnbk1vZGFsVmlzaWJsZTogZmFsc2UsXG4gICAgfSk7XG4gIH1cblxuICBjb25zdCBvbk9wdGlvblNjcm9sbCA9IGFzeW5jICgpID0+IHtcbiAgICBpZihzdGF0ZS5jYW1wYWlnbnMucGFnaW5nLm5leHQpe1xuICAgICAgLy8gY29uc3QgcmVzID0gYXdhaXQgZmJQYWdpbmF0ZShzdGF0ZS5jYW1wYWlnbnMucGFnaW5nLm5leHQpXG4gICAgICAvLyBjb25zb2xlLmxvZygncGFnaW5nJyxyZXMpXG4gICAgfVxuICB9XG5cbiAgY29uc3QgeyBPcHRpb24gfSA9IFNlbGVjdDtcbiAgY29uc3QgeyBzZWxlY3RlZFJvd0tleXMgfSA9IHN0YXRlO1xuICByZXR1cm4gKFxuICAgIDxkaXYgaWQ9XCJwZXJmb3JtYW5jZVwiPlxuICAgICAgPFJvdyBndXR0ZXI9ezE2fSBzdHlsZT17eyB3aWR0aDogXCIxMDAlXCIgfX0+XG4gICAgICAgIDxDb2wgc3Bhbj17NH0+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzZWxlY3Rpb25cIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYnV0dG9uIGl0ZW1cIj5cbiAgICAgICAgICAgICAgPEJ1dHRvbiBvbkNsaWNrPXsoKSA9PiBzZXRNb2RhbFZpc2libGUodHJ1ZSwgJ2FjY291bnRNb2RhbFZpc2libGUnKX0gYmxvY2s+XG4gICAgICAgICAgICAgICAge3N0YXRlLnNlbGVjdGVkQWRBY2NvdW50Lm5hbWVcbiAgICAgICAgICAgICAgICAgID8gc3RhdGUuc2VsZWN0ZWRBZEFjY291bnQubmFtZVxuICAgICAgICAgICAgICAgICAgOiBcIlNlbGVjdCBBZCBBY2NvdW50XCJ9XG4gICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNlbGVjdCBpdGVtXCI+XG4gICAgICAgICAgICA8QnV0dG9uIG9uQ2xpY2s9eygpID0+IHNldENhbXBhaWduc01vZGFsKHRydWUpfSBibG9jayBsb2FkaW5nPXtzdGF0ZS5mZXRjaGluZ0NhbXBhaWduc30gZGlzYWJsZWQ9eyEhc3RhdGUuc2VsZWN0ZWRBZEFjY291bnQubmFtZX0+XG4gICAgICAgICAgICAgICAge3N0YXRlLnNlbGVjdGVkQ2FtcGFpZ24ubmFtZVxuICAgICAgICAgICAgICAgICAgPyBzdGF0ZS5zZWxlY3RlZENhbXBhaWduLm5hbWVcbiAgICAgICAgICAgICAgICAgIDogXCJTZWxlY3QgQ2FtcGFpZ25cIn1cbiAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgIHsvKiA8U2VsZWN0XG4gICAgICAgICAgICAgICAgc2hvd1NlYXJjaFxuICAgICAgICAgICAgICAgIHN0eWxlPXt7IHdpZHRoOiBcIjEwMCVcIiB9fVxuICAgICAgICAgICAgICAgIGxvYWRpbmc9e3N0YXRlLmZldGNoaW5nQ2FtcGFpZ25zfVxuICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiU2VsZWN0IGEgY2FtcGFpZ25cIlxuICAgICAgICAgICAgICAgIG9wdGlvbkZpbHRlclByb3A9XCJjaGlsZHJlblwiXG4gICAgICAgICAgICAgICAgLy8gb25DaGFuZ2U9e29uQ2hhbmdlfVxuICAgICAgICAgICAgICAgIC8vIG9uRm9jdXM9e29uRm9jdXN9XG4gICAgICAgICAgICAgICAgLy8gb25CbHVyPXtvbkJsdXJ9XG4gICAgICAgICAgICAgICAgLy8gb25TZWFyY2g9e29uU2VhcmNofVxuICAgICAgICAgICAgICAgIG9uUG9wdXBTY3JvbGw9e29uT3B0aW9uU2Nyb2xsfVxuICAgICAgICAgICAgICAgIGZpbHRlck9wdGlvbj17KGlucHV0LCBvcHRpb24pID0+XG4gICAgICAgICAgICAgICAgICBvcHRpb24ucHJvcHMuY2hpbGRyZW5cbiAgICAgICAgICAgICAgICAgICAgLnRvTG93ZXJDYXNlKClcbiAgICAgICAgICAgICAgICAgICAgLmluZGV4T2YoaW5wdXQudG9Mb3dlckNhc2UoKSkgPj0gMFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIHN0YXRlLmNhbXBhaWducyA/XG4gICAgICAgICAgICAgICAgICBzdGF0ZS5jYW1wYWlnbnMuZGF0YS5tYXAoKGl0ZW0sIGluZGV4KSA9PiB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gPE9wdGlvbiB2YWx1ZT17aXRlbS5pZH0ga2V5PXtpbmRleH0+e2l0ZW0ubmFtZX08L09wdGlvbj5cbiAgICAgICAgICAgICAgICAgIH0pIDogJydcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIDwvU2VsZWN0PiAqL31cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzZWxlY3QgaXRlbVwiPlxuICAgICAgICAgICAgICA8U2VsZWN0IHN0eWxlPXt7IHdpZHRoOiBcIjEwMCVcIiB9fSBwbGFjZWhvbGRlcj1cIlNlbGVjdCBhZHNldFwiPlxuICAgICAgICAgICAgICAgIDxPcHRpb24gdmFsdWU9XCJqYWNrXCI+SmFjazwvT3B0aW9uPlxuICAgICAgICAgICAgICAgIDxPcHRpb24gdmFsdWU9XCJsdWN5XCI+THVjeTwvT3B0aW9uPlxuICAgICAgICAgICAgICAgIDxPcHRpb24gdmFsdWU9XCJkaXNhYmxlZFwiIGRpc2FibGVkPlxuICAgICAgICAgICAgICAgICAgRGlzYWJsZWRcbiAgICAgICAgICAgICAgICA8L09wdGlvbj5cbiAgICAgICAgICAgICAgICA8T3B0aW9uIHZhbHVlPVwiWWltaW5naGVcIj55aW1pbmdoZTwvT3B0aW9uPlxuICAgICAgICAgICAgICA8L1NlbGVjdD5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzZWxlY3QgaXRlbVwiPlxuICAgICAgICAgICAgICA8U2VsZWN0IHN0eWxlPXt7IHdpZHRoOiBcIjEwMCVcIiB9fSBwbGFjZWhvbGRlcj1cIlNlbGVjdCBhZFwiPlxuICAgICAgICAgICAgICAgIDxPcHRpb24gdmFsdWU9XCJqYWNrXCI+SmFjazwvT3B0aW9uPlxuICAgICAgICAgICAgICAgIDxPcHRpb24gdmFsdWU9XCJsdWN5XCI+THVjeTwvT3B0aW9uPlxuICAgICAgICAgICAgICAgIDxPcHRpb24gdmFsdWU9XCJkaXNhYmxlZFwiIGRpc2FibGVkPlxuICAgICAgICAgICAgICAgICAgRGlzYWJsZWRcbiAgICAgICAgICAgICAgICA8L09wdGlvbj5cbiAgICAgICAgICAgICAgICA8T3B0aW9uIHZhbHVlPVwiWWltaW5naGVcIj55aW1pbmdoZTwvT3B0aW9uPlxuICAgICAgICAgICAgICA8L1NlbGVjdD5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L0NvbD5cbiAgICAgICAgPENvbCBzcGFuPXsyMH0+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdGF0c1wiPlxuICAgICAgICAgICAgPGRpdiBpZD1cImNoYXJ0XCI+PC9kaXY+XG4gICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICA8VGFibGVcbiAgICAgICAgICAgICAgICBjb2x1bW5zPXtwZXJmb3JtYW5jZUNvbHVtbnN9XG4gICAgICAgICAgICAgICAgb25TZWxlY3Rpb249e29uU2VsZWN0aW9uQ2hhbmdlfVxuICAgICAgICAgICAgICAgIHNlbGVjdGVkUm93S2V5cz17c2VsZWN0ZWRSb3dLZXlzfVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInRhYmxlXCJcbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L0NvbD5cbiAgICAgIDwvUm93PlxuICAgICAgPE1vZGFsXG4gICAgICAgIHRpdGxlPVwiU2VsZWN0IGFuIEFkIGFjY291bnRcIlxuICAgICAgICBjZW50ZXJlZFxuICAgICAgICB2aXNpYmxlPXtzdGF0ZS5hY2NvdW50TW9kYWxWaXNpYmxlfVxuICAgICAgICBvbk9rPXsoKSA9PiBzZXRNb2RhbFZpc2libGUoZmFsc2UsICdhY2NvdW50TW9kYWxWaXNpYmxlJyl9XG4gICAgICAgIG9uQ2FuY2VsPXsoKSA9PiBzZXRNb2RhbFZpc2libGUoZmFsc2UsICdhY2NvdW50TW9kYWxWaXNpYmxlJyl9XG4gICAgICAgIG9rVGV4dD1cIk5leHRcIlxuICAgICAgICBjYW5jZWxUZXh0PVwiUHJldmlvdXNcIlxuICAgICAgICBva0J1dHRvblByb3BzPXt7XG4gICAgICAgICAgZGlzYWJsZWQ6ICEhIXN0YXRlLnBhZ2luZ0FjY291bnRzLm5leHQsXG4gICAgICAgICAgb25DbGljazogKCkgPT4gaGFuZGxlQWNjb3VudFBhZ2luYXRpb24oc3RhdGUucGFnaW5nQWNjb3VudHMubmV4dClcbiAgICAgICAgfX1cbiAgICAgICAgY2FuY2VsQnV0dG9uUHJvcHM9e3tcbiAgICAgICAgICBkaXNhYmxlZDogISEhc3RhdGUucGFnaW5nQWNjb3VudHMucHJldmlvdXMsXG4gICAgICAgICAgb25DbGljazogKCkgPT4gaGFuZGxlQWNjb3VudFBhZ2luYXRpb24oc3RhdGUucGFnaW5nQWNjb3VudHMucHJldmlvdXMpXG4gICAgICAgIH19XG4gICAgICAgIHdpZHRoPXsxMzAwfVxuICAgICAgPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFkQWNjb3VudHNcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlubmVyXCI+XG4gICAgICAgICAgICB7c3RhdGUuYWRBY2NvdW50c1xuICAgICAgICAgICAgICA/IHN0YXRlLmFkQWNjb3VudHMuZGF0YS5tYXAoKGl0ZW0sIGluZGV4KSA9PiAoXG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFjY291bnRcIiBrZXk9e2luZGV4fT5cbiAgICAgICAgICAgICAgICAgICAgPEFkQWNjb3VudFxuICAgICAgICAgICAgICAgICAgICAgIG5hbWU9e2l0ZW0ubmFtZX1cbiAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ9e2l0ZW0uaWR9XG4gICAgICAgICAgICAgICAgICAgICAgc3RhdHVzPXtpdGVtLmFjY291bnRfc3RhdHVzfVxuICAgICAgICAgICAgICAgICAgICAgIG9uU2VsZWN0PXtoYW5kbGVBY2NvdW50U2VsZWN0fVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgKSlcbiAgICAgICAgICAgICAgOiBcIkxvYWRpbmcuLi5cIn1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L01vZGFsPlxuICAgICAgPE1vZGFsXG4gICAgICAgIHRpdGxlPVwiU2VsZWN0IGEgY2FtcGFpZ25cIlxuICAgICAgICBjZW50ZXJlZFxuICAgICAgICB2aXNpYmxlPXtzdGF0ZS5jYW1wYWlnbk1vZGFsVmlzaWJsZX1cbiAgICAgICAgb25Paz17KCkgPT4gc2V0Q2FtcGFpZ25zTW9kYWwoZmFsc2UsIFwiY2FtcGFpZ25Nb2RhbFZpc2libGVcIil9XG4gICAgICAgIG9uQ2FuY2VsPXsoKSA9PiBzZXRDYW1wYWlnbnNNb2RhbChmYWxzZSwgXCJjYW1wYWlnbk1vZGFsVmlzaWJsZVwiKX1cbiAgICAgICAgb2tUZXh0PVwiTmV4dFwiXG4gICAgICAgIGNhbmNlbFRleHQ9XCJQcmV2aW91c1wiXG4gICAgICAgIG9rQnV0dG9uUHJvcHM9e3tcbiAgICAgICAgICBkaXNhYmxlZDogISEhc3RhdGUucGFnaW5nQ2FtcGFpZ25zLm5leHQsXG4gICAgICAgICAgb25DbGljazogKCkgPT4gaGFuZGxlQ2FtcGFpZ25QYWdpbmF0aW9uKHN0YXRlLnBhZ2luZ0NhbXBhaWducy5uZXh0KVxuICAgICAgICB9fVxuICAgICAgICBjYW5jZWxCdXR0b25Qcm9wcz17e1xuICAgICAgICAgIGRpc2FibGVkOiAhISFzdGF0ZS5wYWdpbmdDYW1wYWlnbnMucHJldmlvdXMsXG4gICAgICAgICAgb25DbGljazogKCkgPT4gaGFuZGxlQ2FtcGFpZ25QYWdpbmF0aW9uKHN0YXRlLnBhZ2luZ0NhbXBhaWducy5wcmV2aW91cylcbiAgICAgICAgfX1cbiAgICAgICAgd2lkdGg9ezEzMDB9XG4gICAgICA+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWRBY2NvdW50c1wiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaW5uZXJcIj5cbiAgICAgICAgICAgIHtzdGF0ZS5jYW1wYWlnbnNcbiAgICAgICAgICAgICAgPyBzdGF0ZS5jYW1wYWlnbnMuZGF0YS5tYXAoKGl0ZW0sIGluZGV4KSA9PiAoXG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFjY291bnRcIiBrZXk9e2luZGV4fT5cbiAgICAgICAgICAgICAgICAgICAgPEFkQWNjb3VudFxuICAgICAgICAgICAgICAgICAgICAgIG5hbWU9e2l0ZW0ubmFtZX1cbiAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ9e2l0ZW0uaWR9XG4gICAgICAgICAgICAgICAgICAgICAgLy8gc3RhdHVzPXtpdGVtLmFjY291bnRfc3RhdHVzfVxuICAgICAgICAgICAgICAgICAgICAgIG9uU2VsZWN0PXtoYW5kbGVDYW1wYWlnblNlbGVjdH1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICkpXG4gICAgICAgICAgICAgIDogXCJMb2FkaW5nLi4uXCJ9XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9Nb2RhbD5cbiAgICAgIDxzdHlsZSBqc3g+XG4gICAgICAgIHtgXG4gICAgICAgICAgI3BlcmZvcm1hbmNlIHtcbiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gICAgICAgICAgICBtYXJnaW4tdG9wOiA3MHB4O1xuICAgICAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLnNlbGVjdGlvbiB7XG4gICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkICNjY2M7XG4gICAgICAgICAgICBib3JkZXItcmFkaXVzOiA0cHg7XG4gICAgICAgICAgICBoZWlnaHQ6IGF1dG87XG4gICAgICAgICAgICBwYWRkaW5nOiAxMHB4O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC5pdGVtIHtcbiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDMwcHg7XG4gICAgICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLnN0YXRzIHtcbiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC5hZEFjY291bnRzIHtcbiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAuYWRBY2NvdW50cyAuaW5uZXIge1xuICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgIGZsZXgtd3JhcDogd3JhcDtcbiAgICAgICAgICAgIHdpZHRoOiA5MCU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLmFjY291bnQge1xuICAgICAgICAgICAgbWluLXdpZHRoOiAyMCU7XG4gICAgICAgICAgICBtYXJnaW46IDEwcHg7XG4gICAgICAgICAgfVxuICAgICAgICBgfVxuICAgICAgPC9zdHlsZT5cbiAgICA8L2Rpdj5cbiAgKTtcbn1cblxuY29uc3QgbWFwU3RhdGVUb1Byb3BzID0gc3RhdGUgPT4gKHtcbiAgdXNlcjogc3RhdGUudXNlci5jdXJyZW50VXNlcixcbiAgZmJJZDogc3RhdGUudXNlci5mYlRva2VuLmZiSWRcbn0pO1xuXG5leHBvcnQgZGVmYXVsdCBjb25uZWN0KG1hcFN0YXRlVG9Qcm9wcykoUGVyZm9ybWFuY2UpO1xuIl19 */\\n/*@ sourceURL=/home/benkissi/projects/getch/getch-frontend-2.0/pages/performance.js */\"));\n}\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    user: state.user.currentUser,\n    fbId: state.user.fbToken.fbId\n  };\n};\n\nexport default connect(mapStateToProps)(Performance);","map":{"version":3,"sources":["/home/benkissi/projects/getch/getch-frontend-2.0/pages/performance.js"],"names":["useState","useEffect","connect","chartData","Table","AdAccount","performanceColumns","getAdAccounts","fbPaginate","getCampaigns","Performance","props","accountModalVisible","campaignModalVisible","selectedRowKeys","pagingAccounts","next","previous","pagingCampaigns","selectedAdAccount","selectedCampaign","fetchingCampaigns","state","setState","fbId","user","console","log","require","Column","chart","document","getElementById","data","xField","yField","padding","title","visible","text","forceFit","render","fetchAdAccounts","id","fetchCampaigns","campaigns","setModalVisible","status","modalName","setCampaignsModal","modalVisible","xToken","adAccounts","paging","accountId","res","handleAccountPagination","page","handleCampaignPagination","onSelectionChange","selectedRows","selectedInterest","map","interest","name","handleAccountSelect","handleCampaignSelect","onOptionScroll","Option","width","disabled","onClick","item","index","account_status","mapStateToProps","currentUser","fbToken"],"mappings":"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","sourcesContent":["import { useState, useEffect } from \"react\";\nimport { connect } from \"react-redux\";\nimport { Modal, Button, Select, Row, Col } from \"antd\";\n\nimport { chartData } from \"../utils/table\";\n\nimport Table from \"../components/table\";\nimport AdAccount from \"../components/adAccount\";\nimport { performanceColumns } from \"../utils/table\";\nimport { getAdAccounts, fbPaginate, getCampaigns } from \"../api/api\";\n\nfunction Performance(props) {\n  const [state, setState] = useState({\n    accountModalVisible: false,\n    campaignModalVisible: false,\n    selectedRowKeys: null,\n    pagingAccounts: {\n      next: \"\",\n      previous: \"\"\n    },\n    pagingCampaigns: {\n      next: \"\",\n      previous: \"\"\n    },\n    selectedAdAccount: {},\n    selectedCampaign: {},\n    fetchingCampaigns: false\n  });\n\n  const { fbId, user } = props;\n\n  useEffect(() => {\n    if (typeof window !== \"undefined\") {\n      console.log(\"on browser\");\n      const { Column } = require(\"@antv/g2plot\");\n\n      const chart = new Column(document.getElementById(\"chart\"), {\n        data: chartData,\n        xField: \"name\",\n        yField: \"value\",\n        padding: \"auto\",\n        title: {\n          visible: true,\n          text: \"Interest stats\"\n        },\n        forceFit: true\n      });\n      console.log(\"el\", document.getElementById(\"chart\"));\n      chart.render();\n    }\n  }, []);\n\n  useEffect(() => {\n    fetchAdAccounts();\n  }, [state.accountModalVisible]);\n\n  useEffect(() => {\n    if (state.selectedAdAccount.id) {\n      fetchCampaigns();\n    }\n  }, [state.selectedAdAccount]);\n\n  useEffect(() => {\n    \n  }, [state.campaigns]);\n\n  const setModalVisible = (status, modalName) => {\n    setState({\n      ...state,\n      [modalName]: status\n    });\n  };\n\n  const setCampaignsModal = (modalVisible) => {\n    setState({\n      ...state,\n      campaignModalVisible: modalVisible\n    });\n  }\n\n  const fetchAdAccounts = async () => {\n    if (state.accountModalVisible) {\n      const adAccounts = await getAdAccounts(fbId, user.xToken);\n      setState({\n        ...state,\n        adAccounts: adAccounts,\n        pagingAccounts: {\n          next: adAccounts.paging.next && adAccounts.paging.next,\n          previous: adAccounts.paging.previous && adAccounts.paging.previous\n        }\n      });\n    }\n  };\n\n  const fetchCampaigns = async () => {\n    setState({\n      ...state,\n      fetchingCampaigns: true\n    })\n    const accountId = state.selectedAdAccount.id;\n    const res = await getCampaigns(accountId, user.xToken);\n    console.log(\"campaigns\", res);\n    setState({\n      ...state,\n      campaigns: res,\n      fetchingCampaigns: false,\n      pagingCampaigns: {\n        next: res.paging && res.paging.next,\n        previous: res.paging && res.paging.previous\n      }\n    });\n  };\n\n  const handleAccountPagination = async page => {\n    const adAccounts = await fbPaginate(page);\n    console.log(\"paginate\", adAccounts);\n    setState({\n      ...state,\n      adAccounts: adAccounts,\n      pagingAccounts: {\n        next: adAccounts.paging && adAccounts.paging.next,\n        previous: adAccounts.paging && adAccounts.paging.previous\n      }\n    });\n  };\n\n  const handleCampaignPagination = async page => {\n    const campaigns = await fbPaginate(page);\n    console.log(\"paginate\", campaigns);\n    setState({\n      ...state,\n      campaigns: campaigns,\n      pagingCampaigns: {\n        next: campaigns.paging && campaigns.paging.next,\n        previous: campaigns.paging && campaigns.paging.previous\n      }\n    });\n  };\n\n  const onSelectionChange = (selectedRowKeys, selectedRows) => {\n    console.log(\"rows\", selectedRows);\n    const selectedInterest = selectedRows.map(interest => {\n      return interest.name;\n    });\n    setState({\n      ...state,\n      selectedRowKeys,\n      selectedInterest,\n      selectedRows\n    });\n  };\n\n  const handleAccountSelect = (id, name) => {\n    setState({\n      ...state,\n      selectedAdAccount: {\n        id,\n        name\n      },\n      accountModalVisible: false,\n    });\n  };\n\n  const handleCampaignSelect = (id, name) => {\n    setState({\n      ...state,\n      selectedCampaign: {\n        id,\n        name\n      },\n      campaignModalVisible: false,\n    });\n  }\n\n  const onOptionScroll = async () => {\n    if(state.campaigns.paging.next){\n      // const res = await fbPaginate(state.campaigns.paging.next)\n      // console.log('paging',res)\n    }\n  }\n\n  const { Option } = Select;\n  const { selectedRowKeys } = state;\n  return (\n    <div id=\"performance\">\n      <Row gutter={16} style={{ width: \"100%\" }}>\n        <Col span={4}>\n          <div className=\"selection\">\n            <div className=\"button item\">\n              <Button onClick={() => setModalVisible(true, 'accountModalVisible')} block>\n                {state.selectedAdAccount.name\n                  ? state.selectedAdAccount.name\n                  : \"Select Ad Account\"}\n              </Button>\n            </div>\n            <div className=\"select item\">\n            <Button onClick={() => setCampaignsModal(true)} block loading={state.fetchingCampaigns} disabled={!!state.selectedAdAccount.name}>\n                {state.selectedCampaign.name\n                  ? state.selectedCampaign.name\n                  : \"Select Campaign\"}\n              </Button>\n              {/* <Select\n                showSearch\n                style={{ width: \"100%\" }}\n                loading={state.fetchingCampaigns}\n                placeholder=\"Select a campaign\"\n                optionFilterProp=\"children\"\n                // onChange={onChange}\n                // onFocus={onFocus}\n                // onBlur={onBlur}\n                // onSearch={onSearch}\n                onPopupScroll={onOptionScroll}\n                filterOption={(input, option) =>\n                  option.props.children\n                    .toLowerCase()\n                    .indexOf(input.toLowerCase()) >= 0\n                }\n              >\n                {\n                  state.campaigns ?\n                  state.campaigns.data.map((item, index) => {\n                  return <Option value={item.id} key={index}>{item.name}</Option>\n                  }) : ''\n                }\n              </Select> */}\n            </div>\n            <div className=\"select item\">\n              <Select style={{ width: \"100%\" }} placeholder=\"Select adset\">\n                <Option value=\"jack\">Jack</Option>\n                <Option value=\"lucy\">Lucy</Option>\n                <Option value=\"disabled\" disabled>\n                  Disabled\n                </Option>\n                <Option value=\"Yiminghe\">yiminghe</Option>\n              </Select>\n            </div>\n            <div className=\"select item\">\n              <Select style={{ width: \"100%\" }} placeholder=\"Select ad\">\n                <Option value=\"jack\">Jack</Option>\n                <Option value=\"lucy\">Lucy</Option>\n                <Option value=\"disabled\" disabled>\n                  Disabled\n                </Option>\n                <Option value=\"Yiminghe\">yiminghe</Option>\n              </Select>\n            </div>\n          </div>\n        </Col>\n        <Col span={20}>\n          <div className=\"stats\">\n            <div id=\"chart\"></div>\n            <div>\n              <Table\n                columns={performanceColumns}\n                onSelection={onSelectionChange}\n                selectedRowKeys={selectedRowKeys}\n                className=\"table\"\n              />\n            </div>\n          </div>\n        </Col>\n      </Row>\n      <Modal\n        title=\"Select an Ad account\"\n        centered\n        visible={state.accountModalVisible}\n        onOk={() => setModalVisible(false, 'accountModalVisible')}\n        onCancel={() => setModalVisible(false, 'accountModalVisible')}\n        okText=\"Next\"\n        cancelText=\"Previous\"\n        okButtonProps={{\n          disabled: !!!state.pagingAccounts.next,\n          onClick: () => handleAccountPagination(state.pagingAccounts.next)\n        }}\n        cancelButtonProps={{\n          disabled: !!!state.pagingAccounts.previous,\n          onClick: () => handleAccountPagination(state.pagingAccounts.previous)\n        }}\n        width={1300}\n      >\n        <div className=\"adAccounts\">\n          <div className=\"inner\">\n            {state.adAccounts\n              ? state.adAccounts.data.map((item, index) => (\n                  <div className=\"account\" key={index}>\n                    <AdAccount\n                      name={item.name}\n                      accountId={item.id}\n                      status={item.account_status}\n                      onSelect={handleAccountSelect}\n                    />\n                  </div>\n                ))\n              : \"Loading...\"}\n          </div>\n        </div>\n      </Modal>\n      <Modal\n        title=\"Select a campaign\"\n        centered\n        visible={state.campaignModalVisible}\n        onOk={() => setCampaignsModal(false, \"campaignModalVisible\")}\n        onCancel={() => setCampaignsModal(false, \"campaignModalVisible\")}\n        okText=\"Next\"\n        cancelText=\"Previous\"\n        okButtonProps={{\n          disabled: !!!state.pagingCampaigns.next,\n          onClick: () => handleCampaignPagination(state.pagingCampaigns.next)\n        }}\n        cancelButtonProps={{\n          disabled: !!!state.pagingCampaigns.previous,\n          onClick: () => handleCampaignPagination(state.pagingCampaigns.previous)\n        }}\n        width={1300}\n      >\n        <div className=\"adAccounts\">\n          <div className=\"inner\">\n            {state.campaigns\n              ? state.campaigns.data.map((item, index) => (\n                  <div className=\"account\" key={index}>\n                    <AdAccount\n                      name={item.name}\n                      accountId={item.id}\n                      // status={item.account_status}\n                      onSelect={handleCampaignSelect}\n                    />\n                  </div>\n                ))\n              : \"Loading...\"}\n          </div>\n        </div>\n      </Modal>\n      <style jsx>\n        {`\n          #performance {\n            display: flex;\n            position: relative;\n            margin-top: 70px;\n            width: 100%;\n          }\n\n          .selection {\n            display: flex;\n            flex-direction: column;\n            border: 1px solid #ccc;\n            border-radius: 4px;\n            height: auto;\n            padding: 10px;\n          }\n\n          .item {\n            margin-bottom: 30px;\n            width: 100%;\n          }\n          .stats {\n            display: flex;\n            flex-direction: column;\n          }\n\n          .adAccounts {\n            display: flex;\n            justify-content: center;\n          }\n\n          .adAccounts .inner {\n            display: flex;\n            flex-wrap: wrap;\n            width: 90%;\n          }\n\n          .account {\n            min-width: 20%;\n            margin: 10px;\n          }\n        `}\n      </style>\n    </div>\n  );\n}\n\nconst mapStateToProps = state => ({\n  user: state.user.currentUser,\n  fbId: state.user.fbToken.fbId\n});\n\nexport default connect(mapStateToProps)(Performance);\n"]},"metadata":{},"sourceType":"module"}