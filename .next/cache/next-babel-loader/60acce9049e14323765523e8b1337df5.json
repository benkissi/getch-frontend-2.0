{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"antd/lib/input/style\";\nimport _Input from \"antd/lib/input\";\nvar _jsxFileName = \"/code/ben/getch/frontend/pages/index.js\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useRouter } from \"next/router\";\nimport { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport FacebookLogin from 'react-facebook-login/dist/facebook-login-render-props';\nimport DashboardLayout from '../components/dashboardLayout';\nimport Header from '../components/header';\nimport InterestTable from '../components/table';\nimport { searchInterest } from '../api/api';\nimport { tableColumns } from '../utils/table';\nimport { addScore } from '../utils/search';\nimport decodeToken from \"../utils/auth\";\nimport { addingCurrentUser, authFacebook } from \"../redux/user/user-actions\";\n\nconst Index = props => {\n  const {\n    0: state,\n    1: setState\n  } = useState({});\n  const {\n    token,\n    user,\n    addUser,\n    fbToken\n  } = props;\n  const {\n    Search\n  } = _Input;\n  const router = useRouter();\n  useEffect(() => {\n    if (token) {\n      const decoded = decodeToken(props.token);\n      const {\n        _id,\n        name,\n        email,\n        domain\n      } = decoded;\n      const userData = {\n        id: _id,\n        name,\n        email,\n        domain\n      };\n      addUser(userData);\n    } else if (user) {\n      console.log(user);\n    } else {\n      router.push(\"/signin\");\n    }\n  }, []);\n\n  const faceAuthStart = () => {\n    console.log('#### FB auth start');\n  };\n\n  const responseFacebook = async res => {\n    const {\n      authFb,\n      user\n    } = props;\n    const {\n      accessToken\n    } = res;\n    authFb(accessToken, user.id);\n  };\n\n  const getInterest = async value => {\n    const data = await searchInterest(fbToken.token, value, 50);\n    const levelOne = addScore(data.data, 5);\n    console.log(data);\n    setState({\n      interests: levelOne\n    });\n  };\n\n  const onSelectionChange = (selectedRowKeys, selectedRows) => {\n    const selectedInterest = selectedRows.map(interest => {\n      return interest.name;\n    });\n    console.log(selectedInterest);\n    setState(_objectSpread({}, state, {\n      selectedRowKeys,\n      selectedInterest\n    }));\n  };\n\n  const actions = [__jsx(FacebookLogin, {\n    appId: process.env.FB_APP_ID,\n    autoLoad: true,\n    fields: \"name,email,id\",\n    onClick: faceAuthStart,\n    scope: \"ads_management, email\",\n    callback: responseFacebook,\n    render: renderProps => __jsx(_Button, {\n      type: \"primary\",\n      onClick: renderProps.onClick,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }, \"Connect Facebook\"),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77\n    },\n    __self: this\n  })];\n  const {\n    interests,\n    selectedRowKeys\n  } = state;\n  return __jsx(DashboardLayout, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    id: \"wrapper\",\n    className: \"jsx-685445646\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93\n    },\n    __self: this\n  }, __jsx(Header, {\n    actions: actions,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94\n    },\n    __self: this\n  }), __jsx(\"div\", {\n    id: \"main-content\",\n    className: \"jsx-685445646\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95\n    },\n    __self: this\n  }, __jsx(Search, {\n    placeholder: \"Find Facebook interest for a keyword\",\n    enterButton: \"Getch\",\n    size: \"large\",\n    onSearch: value => getInterest(value),\n    className: \"jsx-685445646\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96\n    },\n    __self: this\n  }), __jsx(\"div\", {\n    id: \"table\",\n    className: \"jsx-685445646\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102\n    },\n    __self: this\n  }, __jsx(InterestTable, {\n    onSelection: onSelectionChange,\n    selectedRowKeys: selectedRowKeys,\n    className: \"table\",\n    columns: tableColumns,\n    dataSource: interests,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103\n    },\n    __self: this\n  }))), __jsx(_JSXStyle, {\n    id: \"685445646\",\n    __self: this\n  }, \"#wrapper.jsx-685445646{margin:10px;}#main-content.jsx-685445646{margin-top:30px;}#table.jsx-685445646{margin-top:30px;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9jb2RlL2Jlbi9nZXRjaC9mcm9udGVuZC9wYWdlcy9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFnSGtCLEFBR3VCLEFBR0ksQUFHQSxZQUxsQixJQUdBLEFBR0EiLCJmaWxlIjoiL2NvZGUvYmVuL2dldGNoL2Zyb250ZW5kL3BhZ2VzL2luZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdXNlUm91dGVyIH0gZnJvbSBcIm5leHQvcm91dGVyXCI7XG5pbXBvcnQgeyB1c2VFZmZlY3QsIHVzZVN0YXRlIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBjb25uZWN0IH0gZnJvbSBcInJlYWN0LXJlZHV4XCI7XG5pbXBvcnQgeyBCdXR0b24sIElucHV0LCBUYWcgfSBmcm9tIFwiYW50ZFwiO1xuaW1wb3J0IEZhY2Vib29rTG9naW4gZnJvbSAncmVhY3QtZmFjZWJvb2stbG9naW4vZGlzdC9mYWNlYm9vay1sb2dpbi1yZW5kZXItcHJvcHMnO1xuXG5pbXBvcnQgRGFzaGJvYXJkTGF5b3V0IGZyb20gJy4uL2NvbXBvbmVudHMvZGFzaGJvYXJkTGF5b3V0J1xuaW1wb3J0IEhlYWRlciBmcm9tICcuLi9jb21wb25lbnRzL2hlYWRlcidcbmltcG9ydCBJbnRlcmVzdFRhYmxlIGZyb20gJy4uL2NvbXBvbmVudHMvdGFibGUnXG5cbmltcG9ydCB7c2VhcmNoSW50ZXJlc3R9IGZyb20gJy4uL2FwaS9hcGknXG5pbXBvcnQge3RhYmxlQ29sdW1uc30gZnJvbSAnLi4vdXRpbHMvdGFibGUnXG5pbXBvcnQge2FkZFNjb3JlfSBmcm9tICcuLi91dGlscy9zZWFyY2gnXG5cbmltcG9ydCBkZWNvZGVUb2tlbiBmcm9tIFwiLi4vdXRpbHMvYXV0aFwiO1xuaW1wb3J0IHsgYWRkaW5nQ3VycmVudFVzZXIsIGF1dGhGYWNlYm9vayB9IGZyb20gXCIuLi9yZWR1eC91c2VyL3VzZXItYWN0aW9uc1wiO1xuXG5cbmNvbnN0IEluZGV4ID0gcHJvcHMgPT4ge1xuICBjb25zdCBbc3RhdGUsIHNldFN0YXRlXSA9IHVzZVN0YXRlKHt9KVxuICBjb25zdCB7IHRva2VuLCB1c2VyLCBhZGRVc2VyLCBmYlRva2VuIH0gPSBwcm9wcztcbiAgY29uc3QgeyBTZWFyY2ggfSA9IElucHV0O1xuICBjb25zdCByb3V0ZXIgPSB1c2VSb3V0ZXIoKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmICh0b2tlbikge1xuICAgICAgY29uc3QgZGVjb2RlZCA9IGRlY29kZVRva2VuKHByb3BzLnRva2VuKTtcbiAgICAgIGNvbnN0IHsgX2lkLCBuYW1lLCBlbWFpbCwgZG9tYWluIH0gPSBkZWNvZGVkO1xuICAgICAgY29uc3QgdXNlckRhdGEgPSB7XG4gICAgICAgIGlkOiBfaWQsXG4gICAgICAgIG5hbWUsIFxuICAgICAgICBlbWFpbCwgXG4gICAgICAgIGRvbWFpblxuICAgICAgfTtcbiAgICAgIGFkZFVzZXIodXNlckRhdGEpO1xuICAgIH0gZWxzZSBpZiAodXNlcikge1xuICAgICAgY29uc29sZS5sb2codXNlcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJvdXRlci5wdXNoKFwiL3NpZ25pblwiKTtcbiAgICB9XG4gIH0sIFtdKTtcblxuICBjb25zdCBmYWNlQXV0aFN0YXJ0ID0gKCkgPT4ge1xuICAgIGNvbnNvbGUubG9nKCcjIyMjIEZCIGF1dGggc3RhcnQnKVxuICB9XG5cbiAgY29uc3QgcmVzcG9uc2VGYWNlYm9vayA9IGFzeW5jIChyZXMpID0+IHtcbiAgICBjb25zdCB7YXV0aEZiLCB1c2VyfSA9IHByb3BzXG4gICAgY29uc3Qge2FjY2Vzc1Rva2VufSA9IHJlc1xuICAgIGF1dGhGYihhY2Nlc3NUb2tlbiwgdXNlci5pZClcbiAgfVxuXG4gIGNvbnN0IGdldEludGVyZXN0ID0gYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHNlYXJjaEludGVyZXN0KGZiVG9rZW4udG9rZW4sIHZhbHVlLCA1MClcbiAgICBjb25zdCBsZXZlbE9uZSA9IGFkZFNjb3JlKGRhdGEuZGF0YSwgNSlcbiAgICBjb25zb2xlLmxvZyhkYXRhKVxuICAgIHNldFN0YXRlKHtcbiAgICAgIGludGVyZXN0czogbGV2ZWxPbmVcbiAgICB9KVxuXG4gIH1cblxuICBjb25zdCBvblNlbGVjdGlvbkNoYW5nZSA9IChzZWxlY3RlZFJvd0tleXMsIHNlbGVjdGVkUm93cykgPT4ge1xuICAgIFxuICAgIGNvbnN0IHNlbGVjdGVkSW50ZXJlc3QgPSBzZWxlY3RlZFJvd3MubWFwKGludGVyZXN0ID0+IHtcbiAgICAgIHJldHVybiBpbnRlcmVzdC5uYW1lXG4gICAgfSlcbiAgICBjb25zb2xlLmxvZyhzZWxlY3RlZEludGVyZXN0KVxuICAgIHNldFN0YXRlKHtcbiAgICAgIC4uLnN0YXRlLFxuICAgICAgc2VsZWN0ZWRSb3dLZXlzLFxuICAgICAgc2VsZWN0ZWRJbnRlcmVzdFxuICAgIH0pXG4gIH1cblxuICBjb25zdCBhY3Rpb25zID0gW1xuICAgIDxGYWNlYm9va0xvZ2luXG4gICAgICAgIGFwcElkPXtwcm9jZXNzLmVudi5GQl9BUFBfSUR9XG4gICAgICAgIGF1dG9Mb2FkPXt0cnVlfVxuICAgICAgICBmaWVsZHM9XCJuYW1lLGVtYWlsLGlkXCJcbiAgICAgICAgb25DbGljaz17ZmFjZUF1dGhTdGFydH1cbiAgICAgICAgc2NvcGU9XCJhZHNfbWFuYWdlbWVudCwgZW1haWxcIlxuICAgICAgICBjYWxsYmFjaz17cmVzcG9uc2VGYWNlYm9va30gXG4gICAgICAgIHJlbmRlcj17cmVuZGVyUHJvcHMgPT4gKFxuICAgICAgICAgIDxCdXR0b24gdHlwZT1cInByaW1hcnlcIiBvbkNsaWNrPXtyZW5kZXJQcm9wcy5vbkNsaWNrfT5Db25uZWN0IEZhY2Vib29rPC9CdXR0b24+XG4gICAgICAgICl9XG4gICAgICAgIC8+XG4gIF1cblxuICBjb25zdCB7aW50ZXJlc3RzLCBzZWxlY3RlZFJvd0tleXN9ID0gc3RhdGVcbiAgcmV0dXJuIChcbiAgICA8RGFzaGJvYXJkTGF5b3V0PlxuICAgIDxkaXYgaWQ9XCJ3cmFwcGVyXCI+XG4gICAgICA8SGVhZGVyIGFjdGlvbnM9e2FjdGlvbnN9Lz5cbiAgICAgIDxkaXYgaWQ9XCJtYWluLWNvbnRlbnRcIj5cbiAgICAgICAgPFNlYXJjaFxuICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJGaW5kIEZhY2Vib29rIGludGVyZXN0IGZvciBhIGtleXdvcmRcIlxuICAgICAgICAgICAgZW50ZXJCdXR0b249XCJHZXRjaFwiXG4gICAgICAgICAgICBzaXplPVwibGFyZ2VcIlxuICAgICAgICAgICAgb25TZWFyY2g9eyh2YWx1ZSkgPT4gZ2V0SW50ZXJlc3QodmFsdWUpfVxuICAgICAgICAgIC8+XG4gICAgICAgICAgPGRpdiBpZD1cInRhYmxlXCI+XG4gICAgICAgICAgICA8SW50ZXJlc3RUYWJsZSBcbiAgICAgICAgICAgIG9uU2VsZWN0aW9uPXtvblNlbGVjdGlvbkNoYW5nZX0gXG4gICAgICAgICAgICBzZWxlY3RlZFJvd0tleXM9e3NlbGVjdGVkUm93S2V5c30gXG4gICAgICAgICAgICBjbGFzc05hbWU9XCJ0YWJsZVwiIGNvbHVtbnM9e3RhYmxlQ29sdW1uc30gXG4gICAgICAgICAgICBkYXRhU291cmNlPXtpbnRlcmVzdHN9Lz5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICBcbiAgICAgIDwvZGl2PlxuICAgICAgICBcblxuICAgICAgPHN0eWxlIGpzeD57YFxuICAgICAgICAjd3JhcHBlciB7XG4gICAgICAgICAgbWFyZ2luOiAxMHB4O1xuICAgICAgICB9XG4gICAgICAgICNtYWluLWNvbnRlbnQge1xuICAgICAgICAgIG1hcmdpbi10b3A6IDMwcHg7XG4gICAgICAgIH1cbiAgICAgICAgI3RhYmxlIHtcbiAgICAgICAgICBtYXJnaW4tdG9wOiAzMHB4O1xuICAgICAgICB9XG4gICAgICBgfTwvc3R5bGU+XG4gICAgPC9kaXY+XG4gICAgPC9EYXNoYm9hcmRMYXlvdXQ+XG4gICk7XG59O1xuXG5JbmRleC5nZXRJbml0aWFsUHJvcHMgPSBhc3luYyBmdW5jdGlvbihjb250ZXh0KSB7XG4gIGNvbnN0IHRva2VuID0gY29udGV4dC5xdWVyeS5hdDtcbiAgcmV0dXJuIHtcbiAgICB0b2tlblxuICB9O1xufTtcblxuY29uc3QgbWFwU3RhdGVUb1Byb3BzID0gc3RhdGUgPT4gKHtcbiAgdXNlcjogc3RhdGUudXNlci5jdXJyZW50VXNlcixcbiAgZmJUb2tlbjogc3RhdGUudXNlci5mYlRva2VuXG59KTtcblxuY29uc3QgbWFwRGlzcGF0Y2hUb1Byb3BzID0gZGlzcGF0Y2ggPT4gKHtcbiAgYWRkVXNlcjogaXRlbSA9PiBkaXNwYXRjaChhZGRpbmdDdXJyZW50VXNlcihpdGVtKSksXG4gIGF1dGhGYjogKHRva2VuLCBpZCkgPT4gZGlzcGF0Y2goYXV0aEZhY2Vib29rKHt0b2tlbiwgaWR9KSlcbn0pO1xuXG5leHBvcnQgZGVmYXVsdCBjb25uZWN0KG1hcFN0YXRlVG9Qcm9wcywgbWFwRGlzcGF0Y2hUb1Byb3BzKShJbmRleCk7XG4iXX0= */\\n/*@ sourceURL=/code/ben/getch/frontend/pages/index.js */\")));\n};\n\nIndex.getInitialProps = async function (context) {\n  const token = context.query.at;\n  return {\n    token\n  };\n};\n\nconst mapStateToProps = state => ({\n  user: state.user.currentUser,\n  fbToken: state.user.fbToken\n});\n\nconst mapDispatchToProps = dispatch => ({\n  addUser: item => dispatch(addingCurrentUser(item)),\n  authFb: (token, id) => dispatch(authFacebook({\n    token,\n    id\n  }))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Index);","map":{"version":3,"sources":["/code/ben/getch/frontend/pages/index.js"],"names":["useRouter","useEffect","useState","connect","FacebookLogin","DashboardLayout","Header","InterestTable","searchInterest","tableColumns","addScore","decodeToken","addingCurrentUser","authFacebook","Index","props","state","setState","token","user","addUser","fbToken","Search","router","decoded","_id","name","email","domain","userData","id","console","log","push","faceAuthStart","responseFacebook","res","authFb","accessToken","getInterest","value","data","levelOne","interests","onSelectionChange","selectedRowKeys","selectedRows","selectedInterest","map","interest","actions","process","env","FB_APP_ID","renderProps","onClick","getInitialProps","context","query","at","mapStateToProps","currentUser","mapDispatchToProps","dispatch","item"],"mappings":"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","sourcesContent":["import { useRouter } from \"next/router\";\nimport { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport { Button, Input, Tag } from \"antd\";\nimport FacebookLogin from 'react-facebook-login/dist/facebook-login-render-props';\n\nimport DashboardLayout from '../components/dashboardLayout'\nimport Header from '../components/header'\nimport InterestTable from '../components/table'\n\nimport {searchInterest} from '../api/api'\nimport {tableColumns} from '../utils/table'\nimport {addScore} from '../utils/search'\n\nimport decodeToken from \"../utils/auth\";\nimport { addingCurrentUser, authFacebook } from \"../redux/user/user-actions\";\n\n\nconst Index = props => {\n  const [state, setState] = useState({})\n  const { token, user, addUser, fbToken } = props;\n  const { Search } = Input;\n  const router = useRouter();\n\n  useEffect(() => {\n    if (token) {\n      const decoded = decodeToken(props.token);\n      const { _id, name, email, domain } = decoded;\n      const userData = {\n        id: _id,\n        name, \n        email, \n        domain\n      };\n      addUser(userData);\n    } else if (user) {\n      console.log(user);\n    } else {\n      router.push(\"/signin\");\n    }\n  }, []);\n\n  const faceAuthStart = () => {\n    console.log('#### FB auth start')\n  }\n\n  const responseFacebook = async (res) => {\n    const {authFb, user} = props\n    const {accessToken} = res\n    authFb(accessToken, user.id)\n  }\n\n  const getInterest = async (value) => {\n    const data = await searchInterest(fbToken.token, value, 50)\n    const levelOne = addScore(data.data, 5)\n    console.log(data)\n    setState({\n      interests: levelOne\n    })\n\n  }\n\n  const onSelectionChange = (selectedRowKeys, selectedRows) => {\n    \n    const selectedInterest = selectedRows.map(interest => {\n      return interest.name\n    })\n    console.log(selectedInterest)\n    setState({\n      ...state,\n      selectedRowKeys,\n      selectedInterest\n    })\n  }\n\n  const actions = [\n    <FacebookLogin\n        appId={process.env.FB_APP_ID}\n        autoLoad={true}\n        fields=\"name,email,id\"\n        onClick={faceAuthStart}\n        scope=\"ads_management, email\"\n        callback={responseFacebook} \n        render={renderProps => (\n          <Button type=\"primary\" onClick={renderProps.onClick}>Connect Facebook</Button>\n        )}\n        />\n  ]\n\n  const {interests, selectedRowKeys} = state\n  return (\n    <DashboardLayout>\n    <div id=\"wrapper\">\n      <Header actions={actions}/>\n      <div id=\"main-content\">\n        <Search\n            placeholder=\"Find Facebook interest for a keyword\"\n            enterButton=\"Getch\"\n            size=\"large\"\n            onSearch={(value) => getInterest(value)}\n          />\n          <div id=\"table\">\n            <InterestTable \n            onSelection={onSelectionChange} \n            selectedRowKeys={selectedRowKeys} \n            className=\"table\" columns={tableColumns} \n            dataSource={interests}/>\n          </div>\n          \n      </div>\n        \n\n      <style jsx>{`\n        #wrapper {\n          margin: 10px;\n        }\n        #main-content {\n          margin-top: 30px;\n        }\n        #table {\n          margin-top: 30px;\n        }\n      `}</style>\n    </div>\n    </DashboardLayout>\n  );\n};\n\nIndex.getInitialProps = async function(context) {\n  const token = context.query.at;\n  return {\n    token\n  };\n};\n\nconst mapStateToProps = state => ({\n  user: state.user.currentUser,\n  fbToken: state.user.fbToken\n});\n\nconst mapDispatchToProps = dispatch => ({\n  addUser: item => dispatch(addingCurrentUser(item)),\n  authFb: (token, id) => dispatch(authFacebook({token, id}))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Index);\n"]},"metadata":{},"sourceType":"module"}