{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"antd/lib/input/style\";\nimport _Input from \"antd/lib/input\";\nvar _jsxFileName = \"/home/benkissi/projects/getch/getch-frontend-2.0/pages/index.js\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useRouter } from \"next/router\";\nimport { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport FacebookLogin from \"react-facebook-login/dist/facebook-login-render-props\";\nimport { ExportToCsv } from \"export-to-csv\";\nimport { ToastContainer, toast } from \"react-toastify\";\nimport DashboardLayout from \"../components/dashboardLayout\";\nimport Header from \"../components/header\";\nimport InterestTable from \"../components/table\";\nimport SideBar from \"../components/sideBar\";\nimport { tableColumns } from \"../utils/table\";\nimport { addScore, getInterestNames } from \"../utils/search\";\nimport decodeToken from \"../utils/auth\";\nimport { addingCurrentUser, authFacebook } from \"../redux/user/user-actions\";\nimport { searchStart } from \"../redux/search/search-actions\";\nimport \"react-toastify/scss/main.scss\";\n\nvar Index = function Index(props) {\n  var _useState = useState({\n    selectedInterest: []\n  }),\n      state = _useState[0],\n      setState = _useState[1];\n\n  var token = props.token,\n      user = props.user,\n      addUser = props.addUser,\n      fbToken = props.fbToken,\n      interestData = props.interestData,\n      searchInterest = props.searchInterest,\n      keyword = props.keyword,\n      interestCount = props.interestCount,\n      loading = props.loading;\n  var Search = _Input.Search;\n  var router = useRouter();\n  useEffect(function () {\n    if (token) {\n      var decoded = decodeToken(token);\n      var _id = decoded._id,\n          name = decoded.name,\n          email = decoded.email,\n          domain = decoded.domain;\n      var userData = {\n        id: _id,\n        name: name,\n        email: email,\n        domain: domain\n      };\n      addUser(userData);\n    } else if (user) {\n      console.log(user);\n    } else {\n      router.push(\"/signin\");\n    }\n  }, []);\n  useEffect(function () {\n    setState(_objectSpread({}, state, {\n      interests: interestData,\n      interestNumber: interestCount\n    }));\n  }, [interestData, interestCount]);\n\n  var faceAuthStart = function faceAuthStart() {\n    console.log(\"#### FB auth start\");\n  };\n\n  var responseFacebook = function responseFacebook(res) {\n    var authFb, user, accessToken;\n    return _regeneratorRuntime.async(function responseFacebook$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            authFb = props.authFb, user = props.user;\n            accessToken = res.accessToken;\n            authFb(accessToken, user.id);\n\n          case 3:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    });\n  };\n\n  var getInterest = function getInterest(value) {\n    return _regeneratorRuntime.async(function getInterest$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return _regeneratorRuntime.awrap(searchInterest(fbToken.token, value, 500));\n\n          case 2:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    });\n  };\n\n  var onSelectionChange = function onSelectionChange(selectedRowKeys, selectedRows) {\n    console.log(\"rows\", selectedRows);\n    var selectedInterest = selectedRows.map(function (interest) {\n      return interest.name;\n    });\n    setState(_objectSpread({}, state, {\n      selectedRowKeys: selectedRowKeys,\n      selectedInterest: selectedInterest,\n      selectedRows: selectedRows\n    }));\n  };\n\n  var onCopy = function onCopy() {\n    var selectedInterest = state.selectedInterest;\n    console.log(\"copy\", selectedInterest);\n\n    if (selectedInterest) {\n      navigator.clipboard.writeText(selectedInterest).then(function () {\n        console.log(\"you copied\", selectedInterest.length);\n        toast.success(\"You copied \".concat(selectedInterest.length, \" items\"), {\n          position: \"top-right\",\n          autoClose: 5000,\n          hideProgressBar: false,\n          closeOnClick: true,\n          pauseOnHover: true,\n          draggable: true\n        });\n      });\n    }\n  };\n\n  var actions = [__jsx(FacebookLogin, {\n    appId: process.env.FB_APP_ID,\n    autoLoad: true,\n    fields: \"name,email,id\",\n    onClick: faceAuthStart,\n    scope: \"ads_management, email\",\n    callback: responseFacebook,\n    render: function render(renderProps) {\n      return __jsx(_Button, {\n        disabled: !!fbToken,\n        type: \"primary\",\n        onClick: renderProps.onClick,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        },\n        __self: this\n      }, \"Connect Facebook\");\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  })];\n\n  var sideBar = __jsx(SideBar, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131\n    },\n    __self: this\n  });\n\n  var options = {\n    fieldSeparator: \",\",\n    quoteStrings: '\"',\n    decimalSeparator: \".\",\n    showLabels: true,\n    showTitle: true,\n    title: \"Interest List\",\n    useTextFile: false,\n    useBom: true,\n    useKeysAsHeaders: true\n  };\n  var csvExporter = new ExportToCsv(options);\n\n  var handleExport = function handleExport() {\n    var exportArray = [];\n    state.selectedRows.forEach(function (item) {\n      var readyExport = {};\n      readyExport.id = item.id;\n      readyExport.name = item.name;\n      readyExport.audience = item.audience_size;\n      readyExport.description = item.description;\n      readyExport.topic = item.topic;\n      readyExport.path = _JSON$stringify(item.path);\n      readyExport.score = item.relevance;\n      exportArray.push(readyExport);\n    });\n    csvExporter.generateCsv(exportArray);\n  };\n\n  var interests = state.interests,\n      selectedRowKeys = state.selectedRowKeys,\n      interestNumber = state.interestNumber;\n  console.log(\"user\", user);\n  return user.loading ? \"Loading ....\" : __jsx(DashboardLayout, {\n    sidebar: sideBar,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    id: \"wrapper\",\n    className: \"jsx-495169614\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168\n    },\n    __self: this\n  }, __jsx(ToastContainer, {\n    position: \"top-left\",\n    autoClose: 5000,\n    hideProgressBar: false,\n    newestOnTop: false,\n    closeOnClick: true,\n    rtl: false,\n    pauseOnVisibilityChange: true,\n    draggable: true,\n    pauseOnHover: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169\n    },\n    __self: this\n  }), __jsx(Header, {\n    actions: actions,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180\n    },\n    __self: this\n  }), __jsx(\"div\", {\n    id: \"main-content\",\n    className: \"jsx-495169614\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181\n    },\n    __self: this\n  }, __jsx(Search, {\n    placeholder: \"Find Facebook interest for a keyword\",\n    enterButton: \"Getch\",\n    size: \"large\",\n    onSearch: function onSearch(value) {\n      return getInterest(value);\n    },\n    className: \"jsx-495169614\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182\n    },\n    __self: this\n  }), __jsx(\"div\", {\n    className: \"jsx-495169614\" + \" \" + \"controls\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"jsx-495169614\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189\n    },\n    __self: this\n  }, interestNumber ? __jsx(\"p\", {\n    className: \"jsx-495169614\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191\n    },\n    __self: this\n  }, __jsx(\"b\", {\n    className: \"jsx-495169614\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192\n    },\n    __self: this\n  }, interestNumber), \" interest found for \\\"\", keyword, \"\\\"\") : \"\"), __jsx(\"div\", {\n    className: \"jsx-495169614\" + \" \" + \"actions\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"jsx-495169614\" + \" \" + \"button\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199\n    },\n    __self: this\n  }, __jsx(_Button, {\n    onClick: onCopy,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200\n    },\n    __self: this\n  }, \"Copy\")), __jsx(\"div\", {\n    className: \"jsx-495169614\" + \" \" + \"button\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202\n    },\n    __self: this\n  }, __jsx(_Button, {\n    onClick: handleExport,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203\n    },\n    __self: this\n  }, \"Download as CSV\")))), __jsx(\"div\", {\n    id: \"table\",\n    className: \"jsx-495169614\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208\n    },\n    __self: this\n  }, __jsx(InterestTable, {\n    onSelection: onSelectionChange,\n    selectedRowKeys: selectedRowKeys,\n    className: \"table\",\n    columns: tableColumns,\n    dataSource: interests,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209\n    },\n    __self: this\n  }))), __jsx(_JSXStyle, {\n    id: \"495169614\",\n    __self: this\n  }, \"#wrapper.jsx-495169614{margin:10px;}#main-content.jsx-495169614{margin-top:30px;}#table.jsx-495169614{margin-top:30px;}.controls.jsx-495169614{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin-top:10px;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}.actions.jsx-495169614{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}.actions.jsx-495169614>*.jsx-495169614{margin-left:5px;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2Jlbmtpc3NpL3Byb2plY3RzL2dldGNoL2dldGNoLWZyb250ZW5kLTIuMC9wYWdlcy9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUEwTm9CLEFBR3lCLEFBR0ksQUFHQSxBQUlILEFBTUEsQUFJRyxZQW5CbEIsSUFHQSxBQUdBLEFBY0EsMERBVmtCLEFBTWxCLGdCQUxnQyxtSEFDaEMiLCJmaWxlIjoiL2hvbWUvYmVua2lzc2kvcHJvamVjdHMvZ2V0Y2gvZ2V0Y2gtZnJvbnRlbmQtMi4wL3BhZ2VzL2luZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdXNlUm91dGVyIH0gZnJvbSBcIm5leHQvcm91dGVyXCI7XG5pbXBvcnQgeyB1c2VFZmZlY3QsIHVzZVN0YXRlIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBjb25uZWN0IH0gZnJvbSBcInJlYWN0LXJlZHV4XCI7XG5pbXBvcnQgeyBCdXR0b24sIElucHV0LCBUYWcgfSBmcm9tIFwiYW50ZFwiO1xuaW1wb3J0IEZhY2Vib29rTG9naW4gZnJvbSBcInJlYWN0LWZhY2Vib29rLWxvZ2luL2Rpc3QvZmFjZWJvb2stbG9naW4tcmVuZGVyLXByb3BzXCI7XG5pbXBvcnQgeyBFeHBvcnRUb0NzdiB9IGZyb20gXCJleHBvcnQtdG8tY3N2XCI7XG5pbXBvcnQgeyBUb2FzdENvbnRhaW5lciwgdG9hc3QgfSBmcm9tIFwicmVhY3QtdG9hc3RpZnlcIjtcblxuaW1wb3J0IERhc2hib2FyZExheW91dCBmcm9tIFwiLi4vY29tcG9uZW50cy9kYXNoYm9hcmRMYXlvdXRcIjtcbmltcG9ydCBIZWFkZXIgZnJvbSBcIi4uL2NvbXBvbmVudHMvaGVhZGVyXCI7XG5pbXBvcnQgSW50ZXJlc3RUYWJsZSBmcm9tIFwiLi4vY29tcG9uZW50cy90YWJsZVwiO1xuaW1wb3J0IFNpZGVCYXIgZnJvbSBcIi4uL2NvbXBvbmVudHMvc2lkZUJhclwiO1xuXG5pbXBvcnQgeyB0YWJsZUNvbHVtbnMgfSBmcm9tIFwiLi4vdXRpbHMvdGFibGVcIjtcbmltcG9ydCB7IGFkZFNjb3JlLCBnZXRJbnRlcmVzdE5hbWVzIH0gZnJvbSBcIi4uL3V0aWxzL3NlYXJjaFwiO1xuXG5pbXBvcnQgZGVjb2RlVG9rZW4gZnJvbSBcIi4uL3V0aWxzL2F1dGhcIjtcbmltcG9ydCB7IGFkZGluZ0N1cnJlbnRVc2VyLCBhdXRoRmFjZWJvb2sgfSBmcm9tIFwiLi4vcmVkdXgvdXNlci91c2VyLWFjdGlvbnNcIjtcbmltcG9ydCB7IHNlYXJjaFN0YXJ0IH0gZnJvbSBcIi4uL3JlZHV4L3NlYXJjaC9zZWFyY2gtYWN0aW9uc1wiO1xuXG5pbXBvcnQgXCJyZWFjdC10b2FzdGlmeS9zY3NzL21haW4uc2Nzc1wiO1xuXG5jb25zdCBJbmRleCA9IHByb3BzID0+IHtcbiAgY29uc3QgW3N0YXRlLCBzZXRTdGF0ZV0gPSB1c2VTdGF0ZSh7IHNlbGVjdGVkSW50ZXJlc3Q6IFtdIH0pO1xuICBjb25zdCB7XG4gICAgdG9rZW4sXG4gICAgdXNlcixcbiAgICBhZGRVc2VyLFxuICAgIGZiVG9rZW4sXG4gICAgaW50ZXJlc3REYXRhLFxuICAgIHNlYXJjaEludGVyZXN0LFxuICAgIGtleXdvcmQsXG4gICAgaW50ZXJlc3RDb3VudCxcbiAgICBsb2FkaW5nXG4gIH0gPSBwcm9wcztcbiAgY29uc3QgeyBTZWFyY2ggfSA9IElucHV0O1xuICBjb25zdCByb3V0ZXIgPSB1c2VSb3V0ZXIoKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmICh0b2tlbikge1xuICAgICAgY29uc3QgZGVjb2RlZCA9IGRlY29kZVRva2VuKHRva2VuKTtcbiAgICAgIGNvbnN0IHsgX2lkLCBuYW1lLCBlbWFpbCwgZG9tYWluIH0gPSBkZWNvZGVkO1xuICAgICAgY29uc3QgdXNlckRhdGEgPSB7XG4gICAgICAgIGlkOiBfaWQsXG4gICAgICAgIG5hbWUsXG4gICAgICAgIGVtYWlsLFxuICAgICAgICBkb21haW5cbiAgICAgIH07XG4gICAgICBhZGRVc2VyKHVzZXJEYXRhKTtcbiAgICB9IGVsc2UgaWYgKHVzZXIpIHtcbiAgICAgIGNvbnNvbGUubG9nKHVzZXIpO1xuICAgIH0gZWxzZSB7XG4gICAgICByb3V0ZXIucHVzaChcIi9zaWduaW5cIik7XG4gICAgfVxuICB9LCBbXSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBzZXRTdGF0ZSh7XG4gICAgICAuLi5zdGF0ZSxcbiAgICAgIGludGVyZXN0czogaW50ZXJlc3REYXRhLFxuICAgICAgaW50ZXJlc3ROdW1iZXI6IGludGVyZXN0Q291bnRcbiAgICB9KTtcbiAgfSwgW2ludGVyZXN0RGF0YSwgaW50ZXJlc3RDb3VudF0pO1xuXG4gIGNvbnN0IGZhY2VBdXRoU3RhcnQgPSAoKSA9PiB7XG4gICAgY29uc29sZS5sb2coXCIjIyMjIEZCIGF1dGggc3RhcnRcIik7XG4gIH07XG5cbiAgY29uc3QgcmVzcG9uc2VGYWNlYm9vayA9IGFzeW5jIHJlcyA9PiB7XG4gICAgY29uc3QgeyBhdXRoRmIsIHVzZXIgfSA9IHByb3BzO1xuICAgIGNvbnN0IHsgYWNjZXNzVG9rZW4gfSA9IHJlcztcbiAgICBhdXRoRmIoYWNjZXNzVG9rZW4sIHVzZXIuaWQpO1xuICB9O1xuXG4gIGNvbnN0IGdldEludGVyZXN0ID0gYXN5bmMgdmFsdWUgPT4ge1xuICAgIGF3YWl0IHNlYXJjaEludGVyZXN0KGZiVG9rZW4udG9rZW4sIHZhbHVlLCA1MDApO1xuICB9O1xuXG4gIGNvbnN0IG9uU2VsZWN0aW9uQ2hhbmdlID0gKHNlbGVjdGVkUm93S2V5cywgc2VsZWN0ZWRSb3dzKSA9PiB7XG4gICAgY29uc29sZS5sb2coXCJyb3dzXCIsIHNlbGVjdGVkUm93cyk7XG4gICAgY29uc3Qgc2VsZWN0ZWRJbnRlcmVzdCA9IHNlbGVjdGVkUm93cy5tYXAoaW50ZXJlc3QgPT4ge1xuICAgICAgcmV0dXJuIGludGVyZXN0Lm5hbWU7XG4gICAgfSk7XG4gICAgc2V0U3RhdGUoe1xuICAgICAgLi4uc3RhdGUsXG4gICAgICBzZWxlY3RlZFJvd0tleXMsXG4gICAgICBzZWxlY3RlZEludGVyZXN0LFxuICAgICAgc2VsZWN0ZWRSb3dzXG4gICAgfSk7XG4gIH07XG5cbiAgY29uc3Qgb25Db3B5ID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgc2VsZWN0ZWRJbnRlcmVzdCB9ID0gc3RhdGU7XG4gICAgY29uc29sZS5sb2coXCJjb3B5XCIsIHNlbGVjdGVkSW50ZXJlc3QpO1xuICAgIGlmIChzZWxlY3RlZEludGVyZXN0KSB7XG4gICAgICBuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChzZWxlY3RlZEludGVyZXN0KS50aGVuKCgpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coXCJ5b3UgY29waWVkXCIsIHNlbGVjdGVkSW50ZXJlc3QubGVuZ3RoKTtcblxuICAgICAgICB0b2FzdC5zdWNjZXNzKGBZb3UgY29waWVkICR7c2VsZWN0ZWRJbnRlcmVzdC5sZW5ndGh9IGl0ZW1zYCwge1xuICAgICAgICAgIHBvc2l0aW9uOiBcInRvcC1yaWdodFwiLFxuICAgICAgICAgIGF1dG9DbG9zZTogNTAwMCxcbiAgICAgICAgICBoaWRlUHJvZ3Jlc3NCYXI6IGZhbHNlLFxuICAgICAgICAgIGNsb3NlT25DbGljazogdHJ1ZSxcbiAgICAgICAgICBwYXVzZU9uSG92ZXI6IHRydWUsXG4gICAgICAgICAgZHJhZ2dhYmxlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGFjdGlvbnMgPSBbXG4gICAgPEZhY2Vib29rTG9naW5cbiAgICAgIGFwcElkPXtwcm9jZXNzLmVudi5GQl9BUFBfSUR9XG4gICAgICBhdXRvTG9hZD17dHJ1ZX1cbiAgICAgIGZpZWxkcz1cIm5hbWUsZW1haWwsaWRcIlxuICAgICAgb25DbGljaz17ZmFjZUF1dGhTdGFydH1cbiAgICAgIHNjb3BlPVwiYWRzX21hbmFnZW1lbnQsIGVtYWlsXCJcbiAgICAgIGNhbGxiYWNrPXtyZXNwb25zZUZhY2Vib29rfVxuICAgICAgcmVuZGVyPXtyZW5kZXJQcm9wcyA9PiAoXG4gICAgICAgIDxCdXR0b25cbiAgICAgICAgICBkaXNhYmxlZD17ISFmYlRva2VufVxuICAgICAgICAgIHR5cGU9XCJwcmltYXJ5XCJcbiAgICAgICAgICBvbkNsaWNrPXtyZW5kZXJQcm9wcy5vbkNsaWNrfVxuICAgICAgICA+XG4gICAgICAgICAgQ29ubmVjdCBGYWNlYm9va1xuICAgICAgICA8L0J1dHRvbj5cbiAgICAgICl9XG4gICAgLz5cbiAgXTtcblxuICBjb25zdCBzaWRlQmFyID0gPFNpZGVCYXIgLz47XG5cbiAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICBmaWVsZFNlcGFyYXRvcjogXCIsXCIsXG4gICAgcXVvdGVTdHJpbmdzOiAnXCInLFxuICAgIGRlY2ltYWxTZXBhcmF0b3I6IFwiLlwiLFxuICAgIHNob3dMYWJlbHM6IHRydWUsXG4gICAgc2hvd1RpdGxlOiB0cnVlLFxuICAgIHRpdGxlOiBcIkludGVyZXN0IExpc3RcIixcbiAgICB1c2VUZXh0RmlsZTogZmFsc2UsXG4gICAgdXNlQm9tOiB0cnVlLFxuICAgIHVzZUtleXNBc0hlYWRlcnM6IHRydWVcbiAgfTtcbiAgY29uc3QgY3N2RXhwb3J0ZXIgPSBuZXcgRXhwb3J0VG9Dc3Yob3B0aW9ucyk7XG5cbiAgY29uc3QgaGFuZGxlRXhwb3J0ID0gKCkgPT4ge1xuICAgIGxldCBleHBvcnRBcnJheSA9IFtdO1xuICAgIHN0YXRlLnNlbGVjdGVkUm93cy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgbGV0IHJlYWR5RXhwb3J0ID0ge307XG4gICAgICByZWFkeUV4cG9ydC5pZCA9IGl0ZW0uaWQ7XG4gICAgICByZWFkeUV4cG9ydC5uYW1lID0gaXRlbS5uYW1lO1xuICAgICAgcmVhZHlFeHBvcnQuYXVkaWVuY2UgPSBpdGVtLmF1ZGllbmNlX3NpemU7XG4gICAgICByZWFkeUV4cG9ydC5kZXNjcmlwdGlvbiA9IGl0ZW0uZGVzY3JpcHRpb247XG4gICAgICByZWFkeUV4cG9ydC50b3BpYyA9IGl0ZW0udG9waWM7XG4gICAgICByZWFkeUV4cG9ydC5wYXRoID0gSlNPTi5zdHJpbmdpZnkoaXRlbS5wYXRoKTtcbiAgICAgIHJlYWR5RXhwb3J0LnNjb3JlID0gaXRlbS5yZWxldmFuY2U7XG5cbiAgICAgIGV4cG9ydEFycmF5LnB1c2gocmVhZHlFeHBvcnQpO1xuICAgIH0pO1xuICAgIGNzdkV4cG9ydGVyLmdlbmVyYXRlQ3N2KGV4cG9ydEFycmF5KTtcbiAgfTtcblxuICBjb25zdCB7IGludGVyZXN0cywgc2VsZWN0ZWRSb3dLZXlzLCBpbnRlcmVzdE51bWJlciB9ID0gc3RhdGU7XG4gIGNvbnNvbGUubG9nKFwidXNlclwiLCB1c2VyKTtcbiAgcmV0dXJuIChcbiAgICB1c2VyLmxvYWRpbmc/IFwiTG9hZGluZyAuLi4uXCI6XG4gICAgPERhc2hib2FyZExheW91dCBzaWRlYmFyPXtzaWRlQmFyfT5cbiAgICAgIDxkaXYgaWQ9XCJ3cmFwcGVyXCI+XG4gICAgICAgIDxUb2FzdENvbnRhaW5lclxuICAgICAgICAgIHBvc2l0aW9uPVwidG9wLWxlZnRcIlxuICAgICAgICAgIGF1dG9DbG9zZT17NTAwMH1cbiAgICAgICAgICBoaWRlUHJvZ3Jlc3NCYXI9e2ZhbHNlfVxuICAgICAgICAgIG5ld2VzdE9uVG9wPXtmYWxzZX1cbiAgICAgICAgICBjbG9zZU9uQ2xpY2tcbiAgICAgICAgICBydGw9e2ZhbHNlfVxuICAgICAgICAgIHBhdXNlT25WaXNpYmlsaXR5Q2hhbmdlXG4gICAgICAgICAgZHJhZ2dhYmxlXG4gICAgICAgICAgcGF1c2VPbkhvdmVyXG4gICAgICAgIC8+XG4gICAgICAgIDxIZWFkZXIgYWN0aW9ucz17YWN0aW9uc30gLz5cbiAgICAgICAgPGRpdiBpZD1cIm1haW4tY29udGVudFwiPlxuICAgICAgICAgIDxTZWFyY2hcbiAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiRmluZCBGYWNlYm9vayBpbnRlcmVzdCBmb3IgYSBrZXl3b3JkXCJcbiAgICAgICAgICAgIGVudGVyQnV0dG9uPVwiR2V0Y2hcIlxuICAgICAgICAgICAgc2l6ZT1cImxhcmdlXCJcbiAgICAgICAgICAgIG9uU2VhcmNoPXt2YWx1ZSA9PiBnZXRJbnRlcmVzdCh2YWx1ZSl9XG4gICAgICAgICAgLz5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRyb2xzXCI+XG4gICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICB7aW50ZXJlc3ROdW1iZXIgPyAoXG4gICAgICAgICAgICAgICAgPHA+XG4gICAgICAgICAgICAgICAgICA8Yj57aW50ZXJlc3ROdW1iZXJ9PC9iPiBpbnRlcmVzdCBmb3VuZCBmb3IgXCJ7a2V5d29yZH1cIlxuICAgICAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICBcIlwiXG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWN0aW9uc1wiPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJ1dHRvblwiPlxuICAgICAgICAgICAgICAgIDxCdXR0b24gb25DbGljaz17b25Db3B5fT5Db3B5PC9CdXR0b24+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJ1dHRvblwiPlxuICAgICAgICAgICAgICAgIDxCdXR0b24gb25DbGljaz17aGFuZGxlRXhwb3J0fT5Eb3dubG9hZCBhcyBDU1Y8L0J1dHRvbj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgIDxkaXYgaWQ9XCJ0YWJsZVwiPlxuICAgICAgICAgICAgPEludGVyZXN0VGFibGVcbiAgICAgICAgICAgICAgb25TZWxlY3Rpb249e29uU2VsZWN0aW9uQ2hhbmdlfVxuICAgICAgICAgICAgICBzZWxlY3RlZFJvd0tleXM9e3NlbGVjdGVkUm93S2V5c31cbiAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidGFibGVcIlxuICAgICAgICAgICAgICBjb2x1bW5zPXt0YWJsZUNvbHVtbnN9XG4gICAgICAgICAgICAgIGRhdGFTb3VyY2U9e2ludGVyZXN0c31cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuXG4gICAgICAgIDxzdHlsZSBqc3g+e2BcbiAgICAgICAgICAjd3JhcHBlciB7XG4gICAgICAgICAgICBtYXJnaW46IDEwcHg7XG4gICAgICAgICAgfVxuICAgICAgICAgICNtYWluLWNvbnRlbnQge1xuICAgICAgICAgICAgbWFyZ2luLXRvcDogMzBweDtcbiAgICAgICAgICB9XG4gICAgICAgICAgI3RhYmxlIHtcbiAgICAgICAgICAgIG1hcmdpbi10b3A6IDMwcHg7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLmNvbnRyb2xzIHtcbiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICBtYXJnaW4tdG9wOiAxMHB4O1xuICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC5hY3Rpb25zIHtcbiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLmFjdGlvbnMgPiAqIHtcbiAgICAgICAgICAgIG1hcmdpbi1sZWZ0OiA1cHg7XG4gICAgICAgICAgfVxuICAgICAgICBgfTwvc3R5bGU+XG4gICAgICA8L2Rpdj5cbiAgICA8L0Rhc2hib2FyZExheW91dD5cbiAgKTtcbn07XG5cbkluZGV4LmdldEluaXRpYWxQcm9wcyA9IGFzeW5jIGZ1bmN0aW9uKGNvbnRleHQpIHtcbiAgY29uc3QgdG9rZW4gPSBjb250ZXh0LnF1ZXJ5LmF0O1xuICByZXR1cm4ge1xuICAgIHRva2VuXG4gIH07XG59O1xuXG5jb25zdCBtYXBTdGF0ZVRvUHJvcHMgPSBzdGF0ZSA9PiAoe1xuICB1c2VyOiBzdGF0ZS51c2VyLmN1cnJlbnRVc2VyLFxuICBsb2FkaW5nOiBzdGF0ZS51c2VyLmxvYWRpbmcsXG4gIGZiVG9rZW46IHN0YXRlLnVzZXIuZmJUb2tlbixcbiAgaW50ZXJlc3REYXRhOiBzdGF0ZS5zZWFyY2guaW50ZXJlc3RzLFxuICBpbnRlcmVzdENvdW50OiBzdGF0ZS5zZWFyY2guaW50ZXJlc3RDb3VudCxcbiAga2V5d29yZDogc3RhdGUuc2VhcmNoLmtleXdvcmRcbn0pO1xuXG5jb25zdCBtYXBEaXNwYXRjaFRvUHJvcHMgPSBkaXNwYXRjaCA9PiAoe1xuICBhZGRVc2VyOiBpdGVtID0+IGRpc3BhdGNoKGFkZGluZ0N1cnJlbnRVc2VyKGl0ZW0pKSxcbiAgYXV0aEZiOiAodG9rZW4sIGlkKSA9PiBkaXNwYXRjaChhdXRoRmFjZWJvb2soeyB0b2tlbiwgaWQgfSkpLFxuICBzZWFyY2hJbnRlcmVzdDogKHRva2VuLCB2YWx1ZSwgbGltaXQpID0+XG4gICAgZGlzcGF0Y2goc2VhcmNoU3RhcnQoeyB0b2tlbiwgdmFsdWUsIGxpbWl0IH0pKVxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IGNvbm5lY3QobWFwU3RhdGVUb1Byb3BzLCBtYXBEaXNwYXRjaFRvUHJvcHMpKEluZGV4KTtcbiJdfQ== */\\n/*@ sourceURL=/home/benkissi/projects/getch/getch-frontend-2.0/pages/index.js */\")));\n};\n\nIndex.getInitialProps = function _callee(context) {\n  var token;\n  return _regeneratorRuntime.async(function _callee$(_context3) {\n    while (1) {\n      switch (_context3.prev = _context3.next) {\n        case 0:\n          token = context.query.at;\n          return _context3.abrupt(\"return\", {\n            token: token\n          });\n\n        case 2:\n        case \"end\":\n          return _context3.stop();\n      }\n    }\n  });\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    user: state.user.currentUser,\n    loading: state.user.loading,\n    fbToken: state.user.fbToken,\n    interestData: state.search.interests,\n    interestCount: state.search.interestCount,\n    keyword: state.search.keyword\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    addUser: function addUser(item) {\n      return dispatch(addingCurrentUser(item));\n    },\n    authFb: function authFb(token, id) {\n      return dispatch(authFacebook({\n        token: token,\n        id: id\n      }));\n    },\n    searchInterest: function searchInterest(token, value, limit) {\n      return dispatch(searchStart({\n        token: token,\n        value: value,\n        limit: limit\n      }));\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Index);","map":{"version":3,"sources":["/home/benkissi/projects/getch/getch-frontend-2.0/pages/index.js"],"names":["useRouter","useEffect","useState","connect","FacebookLogin","ExportToCsv","ToastContainer","toast","DashboardLayout","Header","InterestTable","SideBar","tableColumns","addScore","getInterestNames","decodeToken","addingCurrentUser","authFacebook","searchStart","Index","props","selectedInterest","state","setState","token","user","addUser","fbToken","interestData","searchInterest","keyword","interestCount","loading","Search","router","decoded","_id","name","email","domain","userData","id","console","log","push","interests","interestNumber","faceAuthStart","responseFacebook","res","authFb","accessToken","getInterest","value","onSelectionChange","selectedRowKeys","selectedRows","map","interest","onCopy","navigator","clipboard","writeText","then","length","success","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","actions","process","env","FB_APP_ID","renderProps","onClick","sideBar","options","fieldSeparator","quoteStrings","decimalSeparator","showLabels","showTitle","title","useTextFile","useBom","useKeysAsHeaders","csvExporter","handleExport","exportArray","forEach","item","readyExport","audience","audience_size","description","topic","path","score","relevance","generateCsv","getInitialProps","context","query","at","mapStateToProps","currentUser","search","mapDispatchToProps","dispatch","limit"],"mappings":"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","sourcesContent":["import { useRouter } from \"next/router\";\nimport { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport { Button, Input, Tag } from \"antd\";\nimport FacebookLogin from \"react-facebook-login/dist/facebook-login-render-props\";\nimport { ExportToCsv } from \"export-to-csv\";\nimport { ToastContainer, toast } from \"react-toastify\";\n\nimport DashboardLayout from \"../components/dashboardLayout\";\nimport Header from \"../components/header\";\nimport InterestTable from \"../components/table\";\nimport SideBar from \"../components/sideBar\";\n\nimport { tableColumns } from \"../utils/table\";\nimport { addScore, getInterestNames } from \"../utils/search\";\n\nimport decodeToken from \"../utils/auth\";\nimport { addingCurrentUser, authFacebook } from \"../redux/user/user-actions\";\nimport { searchStart } from \"../redux/search/search-actions\";\n\nimport \"react-toastify/scss/main.scss\";\n\nconst Index = props => {\n  const [state, setState] = useState({ selectedInterest: [] });\n  const {\n    token,\n    user,\n    addUser,\n    fbToken,\n    interestData,\n    searchInterest,\n    keyword,\n    interestCount,\n    loading\n  } = props;\n  const { Search } = Input;\n  const router = useRouter();\n\n  useEffect(() => {\n    if (token) {\n      const decoded = decodeToken(token);\n      const { _id, name, email, domain } = decoded;\n      const userData = {\n        id: _id,\n        name,\n        email,\n        domain\n      };\n      addUser(userData);\n    } else if (user) {\n      console.log(user);\n    } else {\n      router.push(\"/signin\");\n    }\n  }, []);\n\n  useEffect(() => {\n    setState({\n      ...state,\n      interests: interestData,\n      interestNumber: interestCount\n    });\n  }, [interestData, interestCount]);\n\n  const faceAuthStart = () => {\n    console.log(\"#### FB auth start\");\n  };\n\n  const responseFacebook = async res => {\n    const { authFb, user } = props;\n    const { accessToken } = res;\n    authFb(accessToken, user.id);\n  };\n\n  const getInterest = async value => {\n    await searchInterest(fbToken.token, value, 500);\n  };\n\n  const onSelectionChange = (selectedRowKeys, selectedRows) => {\n    console.log(\"rows\", selectedRows);\n    const selectedInterest = selectedRows.map(interest => {\n      return interest.name;\n    });\n    setState({\n      ...state,\n      selectedRowKeys,\n      selectedInterest,\n      selectedRows\n    });\n  };\n\n  const onCopy = () => {\n    const { selectedInterest } = state;\n    console.log(\"copy\", selectedInterest);\n    if (selectedInterest) {\n      navigator.clipboard.writeText(selectedInterest).then(() => {\n        console.log(\"you copied\", selectedInterest.length);\n\n        toast.success(`You copied ${selectedInterest.length} items`, {\n          position: \"top-right\",\n          autoClose: 5000,\n          hideProgressBar: false,\n          closeOnClick: true,\n          pauseOnHover: true,\n          draggable: true\n        });\n      });\n    }\n  };\n\n  const actions = [\n    <FacebookLogin\n      appId={process.env.FB_APP_ID}\n      autoLoad={true}\n      fields=\"name,email,id\"\n      onClick={faceAuthStart}\n      scope=\"ads_management, email\"\n      callback={responseFacebook}\n      render={renderProps => (\n        <Button\n          disabled={!!fbToken}\n          type=\"primary\"\n          onClick={renderProps.onClick}\n        >\n          Connect Facebook\n        </Button>\n      )}\n    />\n  ];\n\n  const sideBar = <SideBar />;\n\n  const options = {\n    fieldSeparator: \",\",\n    quoteStrings: '\"',\n    decimalSeparator: \".\",\n    showLabels: true,\n    showTitle: true,\n    title: \"Interest List\",\n    useTextFile: false,\n    useBom: true,\n    useKeysAsHeaders: true\n  };\n  const csvExporter = new ExportToCsv(options);\n\n  const handleExport = () => {\n    let exportArray = [];\n    state.selectedRows.forEach(item => {\n      let readyExport = {};\n      readyExport.id = item.id;\n      readyExport.name = item.name;\n      readyExport.audience = item.audience_size;\n      readyExport.description = item.description;\n      readyExport.topic = item.topic;\n      readyExport.path = JSON.stringify(item.path);\n      readyExport.score = item.relevance;\n\n      exportArray.push(readyExport);\n    });\n    csvExporter.generateCsv(exportArray);\n  };\n\n  const { interests, selectedRowKeys, interestNumber } = state;\n  console.log(\"user\", user);\n  return (\n    user.loading? \"Loading ....\":\n    <DashboardLayout sidebar={sideBar}>\n      <div id=\"wrapper\">\n        <ToastContainer\n          position=\"top-left\"\n          autoClose={5000}\n          hideProgressBar={false}\n          newestOnTop={false}\n          closeOnClick\n          rtl={false}\n          pauseOnVisibilityChange\n          draggable\n          pauseOnHover\n        />\n        <Header actions={actions} />\n        <div id=\"main-content\">\n          <Search\n            placeholder=\"Find Facebook interest for a keyword\"\n            enterButton=\"Getch\"\n            size=\"large\"\n            onSearch={value => getInterest(value)}\n          />\n          <div className=\"controls\">\n            <div>\n              {interestNumber ? (\n                <p>\n                  <b>{interestNumber}</b> interest found for \"{keyword}\"\n                </p>\n              ) : (\n                \"\"\n              )}\n            </div>\n            <div className=\"actions\">\n              <div className=\"button\">\n                <Button onClick={onCopy}>Copy</Button>\n              </div>\n              <div className=\"button\">\n                <Button onClick={handleExport}>Download as CSV</Button>\n              </div>\n            </div>\n          </div>\n\n          <div id=\"table\">\n            <InterestTable\n              onSelection={onSelectionChange}\n              selectedRowKeys={selectedRowKeys}\n              className=\"table\"\n              columns={tableColumns}\n              dataSource={interests}\n            />\n          </div>\n        </div>\n\n        <style jsx>{`\n          #wrapper {\n            margin: 10px;\n          }\n          #main-content {\n            margin-top: 30px;\n          }\n          #table {\n            margin-top: 30px;\n          }\n\n          .controls {\n            display: flex;\n            margin-top: 10px;\n            justify-content: space-between;\n          }\n\n          .actions {\n            display: flex;\n          }\n\n          .actions > * {\n            margin-left: 5px;\n          }\n        `}</style>\n      </div>\n    </DashboardLayout>\n  );\n};\n\nIndex.getInitialProps = async function(context) {\n  const token = context.query.at;\n  return {\n    token\n  };\n};\n\nconst mapStateToProps = state => ({\n  user: state.user.currentUser,\n  loading: state.user.loading,\n  fbToken: state.user.fbToken,\n  interestData: state.search.interests,\n  interestCount: state.search.interestCount,\n  keyword: state.search.keyword\n});\n\nconst mapDispatchToProps = dispatch => ({\n  addUser: item => dispatch(addingCurrentUser(item)),\n  authFb: (token, id) => dispatch(authFacebook({ token, id })),\n  searchInterest: (token, value, limit) =>\n    dispatch(searchStart({ token, value, limit }))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Index);\n"]},"metadata":{},"sourceType":"module"}