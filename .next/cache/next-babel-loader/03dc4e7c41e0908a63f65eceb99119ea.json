{"ast":null,"code":"import \"antd/lib/modal/style\";\nimport _Modal from \"antd/lib/modal\";\nimport \"antd/lib/row/style\";\nimport _Row from \"antd/lib/row\";\nimport \"antd/lib/col/style\";\nimport _Col from \"antd/lib/col\";\nimport \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/select/style\";\nimport _Select from \"antd/lib/select\";\nvar _jsxFileName = \"/home/benkissi/projects/getch/getch-frontend-2.0/pages/performance.js\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { useState, useEffect } from \"react\";\nimport { connect } from \"react-redux\";\nimport { chartData } from \"../utils/table\";\nimport Table from \"../components/table\";\nimport AdAccount from \"../components/adAccount\";\nimport { performanceColumns } from \"../utils/table\";\nimport { getAdAccounts, fbPaginate, getCampaigns } from \"../api/api\";\n\nfunction Performance(props) {\n  const {\n    0: state,\n    1: setState\n  } = useState({\n    accountModalVisible: false,\n    campaignModalVisible: false,\n    selectedRowKeys: null,\n    pagingAccounts: {\n      next: \"\",\n      previous: \"\"\n    },\n    pagingCampaigns: {\n      next: \"\",\n      previous: \"\"\n    },\n    selectedAdAccount: {},\n    selectedCampaign: {},\n    fetchingCampaigns: false\n  });\n  const {\n    fbId,\n    user\n  } = props;\n  useEffect(() => {\n    if (false) {\n      console.log(\"on browser\");\n\n      const {\n        Column\n      } = require(\"@antv/g2plot\");\n\n      const chart = new Column(document.getElementById(\"chart\"), {\n        data: chartData,\n        xField: \"name\",\n        yField: \"value\",\n        padding: \"auto\",\n        title: {\n          visible: true,\n          text: \"Interest stats\"\n        },\n        forceFit: true\n      });\n      console.log(\"el\", document.getElementById(\"chart\"));\n      chart.render();\n    }\n  }, []);\n  useEffect(() => {\n    fetchAdAccounts();\n  }, [state.accountModalVisible]);\n  useEffect(() => {\n    if (state.selectedAdAccount.id) {\n      fetchCampaigns();\n    }\n  }, [state.selectedAdAccount]);\n  useEffect(() => {\n    // if(state.selectedCampaign.id){\n    //   console.log('#####hey')\n    // }\n    console.log('#####hey');\n  }, [state.campaigns]);\n\n  const setModalVisible = (status, modalName) => {\n    setState(_objectSpread({}, state, {\n      [modalName]: status\n    }));\n  };\n\n  const setCampaignsModal = modalVisible => {\n    setState(_objectSpread({}, state, {\n      campaignModalVisible: modalVisible\n    }));\n  };\n\n  const fetchAdAccounts = async () => {\n    if (state.accountModalVisible) {\n      const adAccounts = await getAdAccounts(fbId, user.xToken);\n      setState(_objectSpread({}, state, {\n        adAccounts: adAccounts,\n        pagingAccounts: {\n          next: adAccounts.paging.next && adAccounts.paging.next,\n          previous: adAccounts.paging.previous && adAccounts.paging.previous\n        },\n        selectedCampaign: {}\n      }));\n    }\n  };\n\n  const fetchCampaigns = async () => {\n    setState(_objectSpread({}, state, {\n      fetchingCampaigns: true\n    }));\n    const accountId = state.selectedAdAccount.id;\n    const res = await getCampaigns(accountId, user.xToken);\n    setState(_objectSpread({}, state, {\n      campaigns: res,\n      fetchingCampaigns: false,\n      pagingCampaigns: {\n        next: res.paging && res.paging.next,\n        previous: res.paging && res.paging.previous\n      }\n    }));\n  };\n\n  const fetchAdsets = async () => {};\n\n  const handleAccountPagination = async page => {\n    const adAccounts = await fbPaginate(page);\n    console.log(\"paginate\", adAccounts);\n    setState(_objectSpread({}, state, {\n      adAccounts: adAccounts,\n      pagingAccounts: {\n        next: adAccounts.paging && adAccounts.paging.next,\n        previous: adAccounts.paging && adAccounts.paging.previous\n      }\n    }));\n  };\n\n  const handleCampaignPagination = async page => {\n    const campaigns = await fbPaginate(page);\n    console.log(\"paginate\", campaigns);\n    setState(_objectSpread({}, state, {\n      campaigns: campaigns,\n      pagingCampaigns: {\n        next: campaigns.paging && campaigns.paging.next,\n        previous: campaigns.paging && campaigns.paging.previous\n      }\n    }));\n  };\n\n  const onSelectionChange = (selectedRowKeys, selectedRows) => {\n    console.log(\"rows\", selectedRows);\n    const selectedInterest = selectedRows.map(interest => {\n      return interest.name;\n    });\n    setState(_objectSpread({}, state, {\n      selectedRowKeys,\n      selectedInterest,\n      selectedRows\n    }));\n  };\n\n  const handleAccountSelect = (id, name) => {\n    setState(_objectSpread({}, state, {\n      selectedAdAccount: {\n        id,\n        name\n      },\n      accountModalVisible: false\n    }));\n  };\n\n  const handleCampaignSelect = (id, name) => {\n    setState(_objectSpread({}, state, {\n      selectedCampaign: {\n        id,\n        name\n      },\n      campaignModalVisible: false\n    }));\n  };\n\n  const onOptionScroll = async () => {\n    if (state.campaigns.paging.next) {// const res = await fbPaginate(state.campaigns.paging.next)\n      // console.log('paging',res)\n    }\n  };\n\n  const {\n    Option\n  } = _Select;\n  const {\n    selectedRowKeys\n  } = state;\n  return __jsx(\"div\", {\n    id: \"performance\",\n    className: \"jsx-232318478\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192\n    },\n    __self: this\n  }, __jsx(_Row, {\n    gutter: 16,\n    style: {\n      width: \"100%\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193\n    },\n    __self: this\n  }, __jsx(_Col, {\n    span: 4,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"jsx-232318478\" + \" \" + \"selection\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"jsx-232318478\" + \" \" + \"button item\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196\n    },\n    __self: this\n  }, __jsx(_Button, {\n    onClick: () => setModalVisible(true, 'accountModalVisible'),\n    block: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197\n    },\n    __self: this\n  }, state.selectedAdAccount.name ? state.selectedAdAccount.name : \"Select Ad Account\")), __jsx(\"div\", {\n    className: \"jsx-232318478\" + \" \" + \"select item\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203\n    },\n    __self: this\n  }, __jsx(_Button, {\n    onClick: () => setCampaignsModal(true),\n    block: true,\n    loading: state.fetchingCampaigns,\n    disabled: !!!state.selectedAdAccount.name,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204\n    },\n    __self: this\n  }, state.selectedCampaign.name ? state.selectedCampaign.name : \"Select Campaign\")), __jsx(\"div\", {\n    className: \"jsx-232318478\" + \" \" + \"select item\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234\n    },\n    __self: this\n  }, __jsx(_Select, {\n    style: {\n      width: \"100%\"\n    },\n    placeholder: \"Select adset\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235\n    },\n    __self: this\n  }, __jsx(Option, {\n    value: \"jack\",\n    className: \"jsx-232318478\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236\n    },\n    __self: this\n  }, \"Jack\"), __jsx(Option, {\n    value: \"lucy\",\n    className: \"jsx-232318478\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237\n    },\n    __self: this\n  }, \"Lucy\"), __jsx(Option, {\n    value: \"disabled\",\n    disabled: true,\n    className: \"jsx-232318478\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238\n    },\n    __self: this\n  }, \"Disabled\"), __jsx(Option, {\n    value: \"Yiminghe\",\n    className: \"jsx-232318478\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241\n    },\n    __self: this\n  }, \"yiminghe\"))), __jsx(\"div\", {\n    className: \"jsx-232318478\" + \" \" + \"select item\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 244\n    },\n    __self: this\n  }, __jsx(_Select, {\n    style: {\n      width: \"100%\"\n    },\n    placeholder: \"Select ad\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245\n    },\n    __self: this\n  }, __jsx(Option, {\n    value: \"jack\",\n    className: \"jsx-232318478\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246\n    },\n    __self: this\n  }, \"Jack\"), __jsx(Option, {\n    value: \"lucy\",\n    className: \"jsx-232318478\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247\n    },\n    __self: this\n  }, \"Lucy\"), __jsx(Option, {\n    value: \"disabled\",\n    disabled: true,\n    className: \"jsx-232318478\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248\n    },\n    __self: this\n  }, \"Disabled\"), __jsx(Option, {\n    value: \"Yiminghe\",\n    className: \"jsx-232318478\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251\n    },\n    __self: this\n  }, \"yiminghe\"))))), __jsx(_Col, {\n    span: 20,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"jsx-232318478\" + \" \" + \"stats\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 257\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    id: \"chart\",\n    className: \"jsx-232318478\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 258\n    },\n    __self: this\n  }), __jsx(\"div\", {\n    className: \"jsx-232318478\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 259\n    },\n    __self: this\n  }, __jsx(Table, {\n    columns: performanceColumns,\n    onSelection: onSelectionChange,\n    selectedRowKeys: selectedRowKeys,\n    className: \"table\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260\n    },\n    __self: this\n  }))))), __jsx(_Modal, {\n    title: \"Select an Ad account\",\n    centered: true,\n    visible: state.accountModalVisible,\n    onOk: () => setModalVisible(false, 'accountModalVisible'),\n    onCancel: () => setModalVisible(false, 'accountModalVisible'),\n    okText: \"Next\",\n    cancelText: \"Previous\",\n    okButtonProps: {\n      disabled: !!!state.pagingAccounts.next,\n      onClick: () => handleAccountPagination(state.pagingAccounts.next)\n    },\n    cancelButtonProps: {\n      disabled: !!!state.pagingAccounts.previous,\n      onClick: () => handleAccountPagination(state.pagingAccounts.previous)\n    },\n    width: 1300,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 270\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"jsx-232318478\" + \" \" + \"adAccounts\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 288\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"jsx-232318478\" + \" \" + \"inner\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 289\n    },\n    __self: this\n  }, state.adAccounts ? state.adAccounts.data.map((item, index) => __jsx(\"div\", {\n    key: index,\n    className: \"jsx-232318478\" + \" \" + \"account\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 292\n    },\n    __self: this\n  }, __jsx(AdAccount, {\n    name: item.name,\n    accountId: item.id,\n    status: item.account_status,\n    onSelect: handleAccountSelect,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 293\n    },\n    __self: this\n  }))) : \"Loading...\"))), __jsx(_Modal, {\n    title: \"Select a campaign\",\n    centered: true,\n    visible: state.campaignModalVisible,\n    onOk: () => setCampaignsModal(false, \"campaignModalVisible\"),\n    onCancel: () => setCampaignsModal(false, \"campaignModalVisible\"),\n    okText: \"Next\",\n    cancelText: \"Previous\",\n    okButtonProps: {\n      disabled: !!!state.pagingCampaigns.next,\n      onClick: () => handleCampaignPagination(state.pagingCampaigns.next)\n    },\n    cancelButtonProps: {\n      disabled: !!!state.pagingCampaigns.previous,\n      onClick: () => handleCampaignPagination(state.pagingCampaigns.previous)\n    },\n    width: 1300,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 305\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"jsx-232318478\" + \" \" + \"adAccounts\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 323\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"jsx-232318478\" + \" \" + \"inner\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 324\n    },\n    __self: this\n  }, state.campaigns ? state.campaigns.data.map((item, index) => __jsx(\"div\", {\n    key: index,\n    className: \"jsx-232318478\" + \" \" + \"account\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 327\n    },\n    __self: this\n  }, __jsx(AdAccount, {\n    name: item.name,\n    accountId: item.id // status={item.account_status}\n    ,\n    onSelect: handleCampaignSelect,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 328\n    },\n    __self: this\n  }))) : \"Loading...\"))), __jsx(_JSXStyle, {\n    id: \"232318478\",\n    __self: this\n  }, \"#performance.jsx-232318478{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;position:relative;margin-top:70px;width:100%;}.selection.jsx-232318478{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;border:1px solid #ccc;border-radius:4px;height:auto;padding:10px;}.item.jsx-232318478{margin-bottom:30px;width:100%;}.stats.jsx-232318478{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.adAccounts.jsx-232318478{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}.adAccounts.jsx-232318478 .inner.jsx-232318478{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;width:90%;}.account.jsx-232318478{min-width:20%;margin:10px;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2Jlbmtpc3NpL3Byb2plY3RzL2dldGNoL2dldGNoLWZyb250ZW5kLTIuMC9wYWdlcy9wZXJmb3JtYW5jZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFvVlMsQUFHMEIsQUFPQSxBQVNNLEFBSU4sQUFLQSxBQUtBLEFBTUMsY0FDRixLQXBCRCxPQXFCYixJQXBCQSw0Q0FqQm9CLEFBT0ksQUFhQSxBQUtDLEFBS1Isa0JBN0JDLGdCQUNMLFdBQ2IsWUE0QlksVUFDWixXQXhCd0IsQUFheEIscUJBS0EsQ0FqQm9CLGtCQUNOLFlBQ0MsYUFDZiIsImZpbGUiOiIvaG9tZS9iZW5raXNzaS9wcm9qZWN0cy9nZXRjaC9nZXRjaC1mcm9udGVuZC0yLjAvcGFnZXMvcGVyZm9ybWFuY2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB1c2VTdGF0ZSwgdXNlRWZmZWN0IH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBjb25uZWN0IH0gZnJvbSBcInJlYWN0LXJlZHV4XCI7XG5pbXBvcnQgeyBNb2RhbCwgQnV0dG9uLCBTZWxlY3QsIFJvdywgQ29sIH0gZnJvbSBcImFudGRcIjtcblxuaW1wb3J0IHsgY2hhcnREYXRhIH0gZnJvbSBcIi4uL3V0aWxzL3RhYmxlXCI7XG5cbmltcG9ydCBUYWJsZSBmcm9tIFwiLi4vY29tcG9uZW50cy90YWJsZVwiO1xuaW1wb3J0IEFkQWNjb3VudCBmcm9tIFwiLi4vY29tcG9uZW50cy9hZEFjY291bnRcIjtcbmltcG9ydCB7IHBlcmZvcm1hbmNlQ29sdW1ucyB9IGZyb20gXCIuLi91dGlscy90YWJsZVwiO1xuaW1wb3J0IHsgZ2V0QWRBY2NvdW50cywgZmJQYWdpbmF0ZSwgZ2V0Q2FtcGFpZ25zIH0gZnJvbSBcIi4uL2FwaS9hcGlcIjtcblxuZnVuY3Rpb24gUGVyZm9ybWFuY2UocHJvcHMpIHtcbiAgY29uc3QgW3N0YXRlLCBzZXRTdGF0ZV0gPSB1c2VTdGF0ZSh7XG4gICAgYWNjb3VudE1vZGFsVmlzaWJsZTogZmFsc2UsXG4gICAgY2FtcGFpZ25Nb2RhbFZpc2libGU6IGZhbHNlLFxuICAgIHNlbGVjdGVkUm93S2V5czogbnVsbCxcbiAgICBwYWdpbmdBY2NvdW50czoge1xuICAgICAgbmV4dDogXCJcIixcbiAgICAgIHByZXZpb3VzOiBcIlwiXG4gICAgfSxcbiAgICBwYWdpbmdDYW1wYWlnbnM6IHtcbiAgICAgIG5leHQ6IFwiXCIsXG4gICAgICBwcmV2aW91czogXCJcIlxuICAgIH0sXG4gICAgc2VsZWN0ZWRBZEFjY291bnQ6IHt9LFxuICAgIHNlbGVjdGVkQ2FtcGFpZ246IHt9LFxuICAgIGZldGNoaW5nQ2FtcGFpZ25zOiBmYWxzZVxuICB9KTtcblxuICBjb25zdCB7IGZiSWQsIHVzZXIgfSA9IHByb3BzO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwib24gYnJvd3NlclwiKTtcbiAgICAgIGNvbnN0IHsgQ29sdW1uIH0gPSByZXF1aXJlKFwiQGFudHYvZzJwbG90XCIpO1xuXG4gICAgICBjb25zdCBjaGFydCA9IG5ldyBDb2x1bW4oZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjaGFydFwiKSwge1xuICAgICAgICBkYXRhOiBjaGFydERhdGEsXG4gICAgICAgIHhGaWVsZDogXCJuYW1lXCIsXG4gICAgICAgIHlGaWVsZDogXCJ2YWx1ZVwiLFxuICAgICAgICBwYWRkaW5nOiBcImF1dG9cIixcbiAgICAgICAgdGl0bGU6IHtcbiAgICAgICAgICB2aXNpYmxlOiB0cnVlLFxuICAgICAgICAgIHRleHQ6IFwiSW50ZXJlc3Qgc3RhdHNcIlxuICAgICAgICB9LFxuICAgICAgICBmb3JjZUZpdDogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBjb25zb2xlLmxvZyhcImVsXCIsIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2hhcnRcIikpO1xuICAgICAgY2hhcnQucmVuZGVyKCk7XG4gICAgfVxuICB9LCBbXSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBmZXRjaEFkQWNjb3VudHMoKTtcbiAgfSwgW3N0YXRlLmFjY291bnRNb2RhbFZpc2libGVdKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChzdGF0ZS5zZWxlY3RlZEFkQWNjb3VudC5pZCkge1xuICAgICAgZmV0Y2hDYW1wYWlnbnMoKTtcbiAgICB9XG4gIH0sIFtzdGF0ZS5zZWxlY3RlZEFkQWNjb3VudF0pO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgLy8gaWYoc3RhdGUuc2VsZWN0ZWRDYW1wYWlnbi5pZCl7XG4gICAgLy8gICBjb25zb2xlLmxvZygnIyMjIyNoZXknKVxuICAgIC8vIH1cbiAgICBjb25zb2xlLmxvZygnIyMjIyNoZXknKVxuICB9LCBbc3RhdGUuY2FtcGFpZ25zXSk7XG5cbiAgY29uc3Qgc2V0TW9kYWxWaXNpYmxlID0gKHN0YXR1cywgbW9kYWxOYW1lKSA9PiB7XG4gICAgc2V0U3RhdGUoe1xuICAgICAgLi4uc3RhdGUsXG4gICAgICBbbW9kYWxOYW1lXTogc3RhdHVzXG4gICAgfSk7XG4gIH07XG5cbiAgY29uc3Qgc2V0Q2FtcGFpZ25zTW9kYWwgPSAobW9kYWxWaXNpYmxlKSA9PiB7XG4gICAgc2V0U3RhdGUoe1xuICAgICAgLi4uc3RhdGUsXG4gICAgICBjYW1wYWlnbk1vZGFsVmlzaWJsZTogbW9kYWxWaXNpYmxlXG4gICAgfSk7XG4gIH1cblxuICBjb25zdCBmZXRjaEFkQWNjb3VudHMgPSBhc3luYyAoKSA9PiB7XG4gICAgaWYgKHN0YXRlLmFjY291bnRNb2RhbFZpc2libGUpIHtcbiAgICAgIGNvbnN0IGFkQWNjb3VudHMgPSBhd2FpdCBnZXRBZEFjY291bnRzKGZiSWQsIHVzZXIueFRva2VuKTtcbiAgICAgIHNldFN0YXRlKHtcbiAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgIGFkQWNjb3VudHM6IGFkQWNjb3VudHMsXG4gICAgICAgIHBhZ2luZ0FjY291bnRzOiB7XG4gICAgICAgICAgbmV4dDogYWRBY2NvdW50cy5wYWdpbmcubmV4dCAmJiBhZEFjY291bnRzLnBhZ2luZy5uZXh0LFxuICAgICAgICAgIHByZXZpb3VzOiBhZEFjY291bnRzLnBhZ2luZy5wcmV2aW91cyAmJiBhZEFjY291bnRzLnBhZ2luZy5wcmV2aW91c1xuICAgICAgICB9LFxuICAgICAgc2VsZWN0ZWRDYW1wYWlnbjoge31cbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBmZXRjaENhbXBhaWducyA9IGFzeW5jICgpID0+IHtcbiAgICBzZXRTdGF0ZSh7XG4gICAgICAuLi5zdGF0ZSxcbiAgICAgIGZldGNoaW5nQ2FtcGFpZ25zOiB0cnVlLFxuICAgIH0pXG4gICAgY29uc3QgYWNjb3VudElkID0gc3RhdGUuc2VsZWN0ZWRBZEFjY291bnQuaWQ7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgZ2V0Q2FtcGFpZ25zKGFjY291bnRJZCwgdXNlci54VG9rZW4pO1xuICAgIHNldFN0YXRlKHtcbiAgICAgIC4uLnN0YXRlLFxuICAgICAgY2FtcGFpZ25zOiByZXMsXG4gICAgICBmZXRjaGluZ0NhbXBhaWduczogZmFsc2UsXG4gICAgICBwYWdpbmdDYW1wYWlnbnM6IHtcbiAgICAgICAgbmV4dDogcmVzLnBhZ2luZyAmJiByZXMucGFnaW5nLm5leHQsXG4gICAgICAgIHByZXZpb3VzOiByZXMucGFnaW5nICYmIHJlcy5wYWdpbmcucHJldmlvdXNcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICBjb25zdCBmZXRjaEFkc2V0cyA9IGFzeW5jICgpID0+IHtcbiAgICBcbiAgfVxuXG4gIGNvbnN0IGhhbmRsZUFjY291bnRQYWdpbmF0aW9uID0gYXN5bmMgcGFnZSA9PiB7XG4gICAgY29uc3QgYWRBY2NvdW50cyA9IGF3YWl0IGZiUGFnaW5hdGUocGFnZSk7XG4gICAgY29uc29sZS5sb2coXCJwYWdpbmF0ZVwiLCBhZEFjY291bnRzKTtcbiAgICBzZXRTdGF0ZSh7XG4gICAgICAuLi5zdGF0ZSxcbiAgICAgIGFkQWNjb3VudHM6IGFkQWNjb3VudHMsXG4gICAgICBwYWdpbmdBY2NvdW50czoge1xuICAgICAgICBuZXh0OiBhZEFjY291bnRzLnBhZ2luZyAmJiBhZEFjY291bnRzLnBhZ2luZy5uZXh0LFxuICAgICAgICBwcmV2aW91czogYWRBY2NvdW50cy5wYWdpbmcgJiYgYWRBY2NvdW50cy5wYWdpbmcucHJldmlvdXNcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICBjb25zdCBoYW5kbGVDYW1wYWlnblBhZ2luYXRpb24gPSBhc3luYyBwYWdlID0+IHtcbiAgICBjb25zdCBjYW1wYWlnbnMgPSBhd2FpdCBmYlBhZ2luYXRlKHBhZ2UpO1xuICAgIGNvbnNvbGUubG9nKFwicGFnaW5hdGVcIiwgY2FtcGFpZ25zKTtcbiAgICBzZXRTdGF0ZSh7XG4gICAgICAuLi5zdGF0ZSxcbiAgICAgIGNhbXBhaWduczogY2FtcGFpZ25zLFxuICAgICAgcGFnaW5nQ2FtcGFpZ25zOiB7XG4gICAgICAgIG5leHQ6IGNhbXBhaWducy5wYWdpbmcgJiYgY2FtcGFpZ25zLnBhZ2luZy5uZXh0LFxuICAgICAgICBwcmV2aW91czogY2FtcGFpZ25zLnBhZ2luZyAmJiBjYW1wYWlnbnMucGFnaW5nLnByZXZpb3VzXG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgY29uc3Qgb25TZWxlY3Rpb25DaGFuZ2UgPSAoc2VsZWN0ZWRSb3dLZXlzLCBzZWxlY3RlZFJvd3MpID0+IHtcbiAgICBjb25zb2xlLmxvZyhcInJvd3NcIiwgc2VsZWN0ZWRSb3dzKTtcbiAgICBjb25zdCBzZWxlY3RlZEludGVyZXN0ID0gc2VsZWN0ZWRSb3dzLm1hcChpbnRlcmVzdCA9PiB7XG4gICAgICByZXR1cm4gaW50ZXJlc3QubmFtZTtcbiAgICB9KTtcbiAgICBzZXRTdGF0ZSh7XG4gICAgICAuLi5zdGF0ZSxcbiAgICAgIHNlbGVjdGVkUm93S2V5cyxcbiAgICAgIHNlbGVjdGVkSW50ZXJlc3QsXG4gICAgICBzZWxlY3RlZFJvd3NcbiAgICB9KTtcbiAgfTtcblxuICBjb25zdCBoYW5kbGVBY2NvdW50U2VsZWN0ID0gKGlkLCBuYW1lKSA9PiB7XG4gICAgc2V0U3RhdGUoe1xuICAgICAgLi4uc3RhdGUsXG4gICAgICBzZWxlY3RlZEFkQWNjb3VudDoge1xuICAgICAgICBpZCxcbiAgICAgICAgbmFtZVxuICAgICAgfSxcbiAgICAgIGFjY291bnRNb2RhbFZpc2libGU6IGZhbHNlLFxuICAgIH0pO1xuICB9O1xuXG4gIGNvbnN0IGhhbmRsZUNhbXBhaWduU2VsZWN0ID0gKGlkLCBuYW1lKSA9PiB7XG4gICAgc2V0U3RhdGUoe1xuICAgICAgLi4uc3RhdGUsXG4gICAgICBzZWxlY3RlZENhbXBhaWduOiB7XG4gICAgICAgIGlkLFxuICAgICAgICBuYW1lXG4gICAgICB9LFxuICAgICAgY2FtcGFpZ25Nb2RhbFZpc2libGU6IGZhbHNlLFxuICAgIH0pO1xuICB9XG5cbiAgY29uc3Qgb25PcHRpb25TY3JvbGwgPSBhc3luYyAoKSA9PiB7XG4gICAgaWYoc3RhdGUuY2FtcGFpZ25zLnBhZ2luZy5uZXh0KXtcbiAgICAgIC8vIGNvbnN0IHJlcyA9IGF3YWl0IGZiUGFnaW5hdGUoc3RhdGUuY2FtcGFpZ25zLnBhZ2luZy5uZXh0KVxuICAgICAgLy8gY29uc29sZS5sb2coJ3BhZ2luZycscmVzKVxuICAgIH1cbiAgfVxuXG4gIGNvbnN0IHsgT3B0aW9uIH0gPSBTZWxlY3Q7XG4gIGNvbnN0IHsgc2VsZWN0ZWRSb3dLZXlzIH0gPSBzdGF0ZTtcbiAgcmV0dXJuIChcbiAgICA8ZGl2IGlkPVwicGVyZm9ybWFuY2VcIj5cbiAgICAgIDxSb3cgZ3V0dGVyPXsxNn0gc3R5bGU9e3sgd2lkdGg6IFwiMTAwJVwiIH19PlxuICAgICAgICA8Q29sIHNwYW49ezR9PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic2VsZWN0aW9uXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJ1dHRvbiBpdGVtXCI+XG4gICAgICAgICAgICAgIDxCdXR0b24gb25DbGljaz17KCkgPT4gc2V0TW9kYWxWaXNpYmxlKHRydWUsICdhY2NvdW50TW9kYWxWaXNpYmxlJyl9IGJsb2NrPlxuICAgICAgICAgICAgICAgIHtzdGF0ZS5zZWxlY3RlZEFkQWNjb3VudC5uYW1lXG4gICAgICAgICAgICAgICAgICA/IHN0YXRlLnNlbGVjdGVkQWRBY2NvdW50Lm5hbWVcbiAgICAgICAgICAgICAgICAgIDogXCJTZWxlY3QgQWQgQWNjb3VudFwifVxuICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzZWxlY3QgaXRlbVwiPlxuICAgICAgICAgICAgPEJ1dHRvbiBvbkNsaWNrPXsoKSA9PiBzZXRDYW1wYWlnbnNNb2RhbCh0cnVlKX0gYmxvY2sgbG9hZGluZz17c3RhdGUuZmV0Y2hpbmdDYW1wYWlnbnN9IGRpc2FibGVkPXshISFzdGF0ZS5zZWxlY3RlZEFkQWNjb3VudC5uYW1lfT5cbiAgICAgICAgICAgICAgICB7c3RhdGUuc2VsZWN0ZWRDYW1wYWlnbi5uYW1lXG4gICAgICAgICAgICAgICAgICA/IHN0YXRlLnNlbGVjdGVkQ2FtcGFpZ24ubmFtZVxuICAgICAgICAgICAgICAgICAgOiBcIlNlbGVjdCBDYW1wYWlnblwifVxuICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgey8qIDxTZWxlY3RcbiAgICAgICAgICAgICAgICBzaG93U2VhcmNoXG4gICAgICAgICAgICAgICAgc3R5bGU9e3sgd2lkdGg6IFwiMTAwJVwiIH19XG4gICAgICAgICAgICAgICAgbG9hZGluZz17c3RhdGUuZmV0Y2hpbmdDYW1wYWlnbnN9XG4gICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJTZWxlY3QgYSBjYW1wYWlnblwiXG4gICAgICAgICAgICAgICAgb3B0aW9uRmlsdGVyUHJvcD1cImNoaWxkcmVuXCJcbiAgICAgICAgICAgICAgICAvLyBvbkNoYW5nZT17b25DaGFuZ2V9XG4gICAgICAgICAgICAgICAgLy8gb25Gb2N1cz17b25Gb2N1c31cbiAgICAgICAgICAgICAgICAvLyBvbkJsdXI9e29uQmx1cn1cbiAgICAgICAgICAgICAgICAvLyBvblNlYXJjaD17b25TZWFyY2h9XG4gICAgICAgICAgICAgICAgb25Qb3B1cFNjcm9sbD17b25PcHRpb25TY3JvbGx9XG4gICAgICAgICAgICAgICAgZmlsdGVyT3B0aW9uPXsoaW5wdXQsIG9wdGlvbikgPT5cbiAgICAgICAgICAgICAgICAgIG9wdGlvbi5wcm9wcy5jaGlsZHJlblxuICAgICAgICAgICAgICAgICAgICAudG9Mb3dlckNhc2UoKVxuICAgICAgICAgICAgICAgICAgICAuaW5kZXhPZihpbnB1dC50b0xvd2VyQ2FzZSgpKSA+PSAwXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgc3RhdGUuY2FtcGFpZ25zID9cbiAgICAgICAgICAgICAgICAgIHN0YXRlLmNhbXBhaWducy5kYXRhLm1hcCgoaXRlbSwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiA8T3B0aW9uIHZhbHVlPXtpdGVtLmlkfSBrZXk9e2luZGV4fT57aXRlbS5uYW1lfTwvT3B0aW9uPlxuICAgICAgICAgICAgICAgICAgfSkgOiAnJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgPC9TZWxlY3Q+ICovfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNlbGVjdCBpdGVtXCI+XG4gICAgICAgICAgICAgIDxTZWxlY3Qgc3R5bGU9e3sgd2lkdGg6IFwiMTAwJVwiIH19IHBsYWNlaG9sZGVyPVwiU2VsZWN0IGFkc2V0XCI+XG4gICAgICAgICAgICAgICAgPE9wdGlvbiB2YWx1ZT1cImphY2tcIj5KYWNrPC9PcHRpb24+XG4gICAgICAgICAgICAgICAgPE9wdGlvbiB2YWx1ZT1cImx1Y3lcIj5MdWN5PC9PcHRpb24+XG4gICAgICAgICAgICAgICAgPE9wdGlvbiB2YWx1ZT1cImRpc2FibGVkXCIgZGlzYWJsZWQ+XG4gICAgICAgICAgICAgICAgICBEaXNhYmxlZFxuICAgICAgICAgICAgICAgIDwvT3B0aW9uPlxuICAgICAgICAgICAgICAgIDxPcHRpb24gdmFsdWU9XCJZaW1pbmdoZVwiPnlpbWluZ2hlPC9PcHRpb24+XG4gICAgICAgICAgICAgIDwvU2VsZWN0PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNlbGVjdCBpdGVtXCI+XG4gICAgICAgICAgICAgIDxTZWxlY3Qgc3R5bGU9e3sgd2lkdGg6IFwiMTAwJVwiIH19IHBsYWNlaG9sZGVyPVwiU2VsZWN0IGFkXCI+XG4gICAgICAgICAgICAgICAgPE9wdGlvbiB2YWx1ZT1cImphY2tcIj5KYWNrPC9PcHRpb24+XG4gICAgICAgICAgICAgICAgPE9wdGlvbiB2YWx1ZT1cImx1Y3lcIj5MdWN5PC9PcHRpb24+XG4gICAgICAgICAgICAgICAgPE9wdGlvbiB2YWx1ZT1cImRpc2FibGVkXCIgZGlzYWJsZWQ+XG4gICAgICAgICAgICAgICAgICBEaXNhYmxlZFxuICAgICAgICAgICAgICAgIDwvT3B0aW9uPlxuICAgICAgICAgICAgICAgIDxPcHRpb24gdmFsdWU9XCJZaW1pbmdoZVwiPnlpbWluZ2hlPC9PcHRpb24+XG4gICAgICAgICAgICAgIDwvU2VsZWN0PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvQ29sPlxuICAgICAgICA8Q29sIHNwYW49ezIwfT5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInN0YXRzXCI+XG4gICAgICAgICAgICA8ZGl2IGlkPVwiY2hhcnRcIj48L2Rpdj5cbiAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgIDxUYWJsZVxuICAgICAgICAgICAgICAgIGNvbHVtbnM9e3BlcmZvcm1hbmNlQ29sdW1uc31cbiAgICAgICAgICAgICAgICBvblNlbGVjdGlvbj17b25TZWxlY3Rpb25DaGFuZ2V9XG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRSb3dLZXlzPXtzZWxlY3RlZFJvd0tleXN9XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidGFibGVcIlxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvQ29sPlxuICAgICAgPC9Sb3c+XG4gICAgICA8TW9kYWxcbiAgICAgICAgdGl0bGU9XCJTZWxlY3QgYW4gQWQgYWNjb3VudFwiXG4gICAgICAgIGNlbnRlcmVkXG4gICAgICAgIHZpc2libGU9e3N0YXRlLmFjY291bnRNb2RhbFZpc2libGV9XG4gICAgICAgIG9uT2s9eygpID0+IHNldE1vZGFsVmlzaWJsZShmYWxzZSwgJ2FjY291bnRNb2RhbFZpc2libGUnKX1cbiAgICAgICAgb25DYW5jZWw9eygpID0+IHNldE1vZGFsVmlzaWJsZShmYWxzZSwgJ2FjY291bnRNb2RhbFZpc2libGUnKX1cbiAgICAgICAgb2tUZXh0PVwiTmV4dFwiXG4gICAgICAgIGNhbmNlbFRleHQ9XCJQcmV2aW91c1wiXG4gICAgICAgIG9rQnV0dG9uUHJvcHM9e3tcbiAgICAgICAgICBkaXNhYmxlZDogISEhc3RhdGUucGFnaW5nQWNjb3VudHMubmV4dCxcbiAgICAgICAgICBvbkNsaWNrOiAoKSA9PiBoYW5kbGVBY2NvdW50UGFnaW5hdGlvbihzdGF0ZS5wYWdpbmdBY2NvdW50cy5uZXh0KVxuICAgICAgICB9fVxuICAgICAgICBjYW5jZWxCdXR0b25Qcm9wcz17e1xuICAgICAgICAgIGRpc2FibGVkOiAhISFzdGF0ZS5wYWdpbmdBY2NvdW50cy5wcmV2aW91cyxcbiAgICAgICAgICBvbkNsaWNrOiAoKSA9PiBoYW5kbGVBY2NvdW50UGFnaW5hdGlvbihzdGF0ZS5wYWdpbmdBY2NvdW50cy5wcmV2aW91cylcbiAgICAgICAgfX1cbiAgICAgICAgd2lkdGg9ezEzMDB9XG4gICAgICA+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWRBY2NvdW50c1wiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaW5uZXJcIj5cbiAgICAgICAgICAgIHtzdGF0ZS5hZEFjY291bnRzXG4gICAgICAgICAgICAgID8gc3RhdGUuYWRBY2NvdW50cy5kYXRhLm1hcCgoaXRlbSwgaW5kZXgpID0+IChcbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWNjb3VudFwiIGtleT17aW5kZXh9PlxuICAgICAgICAgICAgICAgICAgICA8QWRBY2NvdW50XG4gICAgICAgICAgICAgICAgICAgICAgbmFtZT17aXRlbS5uYW1lfVxuICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZD17aXRlbS5pZH1cbiAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM9e2l0ZW0uYWNjb3VudF9zdGF0dXN9XG4gICAgICAgICAgICAgICAgICAgICAgb25TZWxlY3Q9e2hhbmRsZUFjY291bnRTZWxlY3R9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICApKVxuICAgICAgICAgICAgICA6IFwiTG9hZGluZy4uLlwifVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvTW9kYWw+XG4gICAgICA8TW9kYWxcbiAgICAgICAgdGl0bGU9XCJTZWxlY3QgYSBjYW1wYWlnblwiXG4gICAgICAgIGNlbnRlcmVkXG4gICAgICAgIHZpc2libGU9e3N0YXRlLmNhbXBhaWduTW9kYWxWaXNpYmxlfVxuICAgICAgICBvbk9rPXsoKSA9PiBzZXRDYW1wYWlnbnNNb2RhbChmYWxzZSwgXCJjYW1wYWlnbk1vZGFsVmlzaWJsZVwiKX1cbiAgICAgICAgb25DYW5jZWw9eygpID0+IHNldENhbXBhaWduc01vZGFsKGZhbHNlLCBcImNhbXBhaWduTW9kYWxWaXNpYmxlXCIpfVxuICAgICAgICBva1RleHQ9XCJOZXh0XCJcbiAgICAgICAgY2FuY2VsVGV4dD1cIlByZXZpb3VzXCJcbiAgICAgICAgb2tCdXR0b25Qcm9wcz17e1xuICAgICAgICAgIGRpc2FibGVkOiAhISFzdGF0ZS5wYWdpbmdDYW1wYWlnbnMubmV4dCxcbiAgICAgICAgICBvbkNsaWNrOiAoKSA9PiBoYW5kbGVDYW1wYWlnblBhZ2luYXRpb24oc3RhdGUucGFnaW5nQ2FtcGFpZ25zLm5leHQpXG4gICAgICAgIH19XG4gICAgICAgIGNhbmNlbEJ1dHRvblByb3BzPXt7XG4gICAgICAgICAgZGlzYWJsZWQ6ICEhIXN0YXRlLnBhZ2luZ0NhbXBhaWducy5wcmV2aW91cyxcbiAgICAgICAgICBvbkNsaWNrOiAoKSA9PiBoYW5kbGVDYW1wYWlnblBhZ2luYXRpb24oc3RhdGUucGFnaW5nQ2FtcGFpZ25zLnByZXZpb3VzKVxuICAgICAgICB9fVxuICAgICAgICB3aWR0aD17MTMwMH1cbiAgICAgID5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhZEFjY291bnRzXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbm5lclwiPlxuICAgICAgICAgICAge3N0YXRlLmNhbXBhaWduc1xuICAgICAgICAgICAgICA/IHN0YXRlLmNhbXBhaWducy5kYXRhLm1hcCgoaXRlbSwgaW5kZXgpID0+IChcbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWNjb3VudFwiIGtleT17aW5kZXh9PlxuICAgICAgICAgICAgICAgICAgICA8QWRBY2NvdW50XG4gICAgICAgICAgICAgICAgICAgICAgbmFtZT17aXRlbS5uYW1lfVxuICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZD17aXRlbS5pZH1cbiAgICAgICAgICAgICAgICAgICAgICAvLyBzdGF0dXM9e2l0ZW0uYWNjb3VudF9zdGF0dXN9XG4gICAgICAgICAgICAgICAgICAgICAgb25TZWxlY3Q9e2hhbmRsZUNhbXBhaWduU2VsZWN0fVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgKSlcbiAgICAgICAgICAgICAgOiBcIkxvYWRpbmcuLi5cIn1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L01vZGFsPlxuICAgICAgPHN0eWxlIGpzeD5cbiAgICAgICAge2BcbiAgICAgICAgICAjcGVyZm9ybWFuY2Uge1xuICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICAgICAgICAgIG1hcmdpbi10b3A6IDcwcHg7XG4gICAgICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAuc2VsZWN0aW9uIHtcbiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgI2NjYztcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgICAgICAgICAgIGhlaWdodDogYXV0bztcbiAgICAgICAgICAgIHBhZGRpbmc6IDEwcHg7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLml0ZW0ge1xuICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMzBweDtcbiAgICAgICAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgICAgIH1cbiAgICAgICAgICAuc3RhdHMge1xuICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLmFkQWNjb3VudHMge1xuICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC5hZEFjY291bnRzIC5pbm5lciB7XG4gICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAgZmxleC13cmFwOiB3cmFwO1xuICAgICAgICAgICAgd2lkdGg6IDkwJTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAuYWNjb3VudCB7XG4gICAgICAgICAgICBtaW4td2lkdGg6IDIwJTtcbiAgICAgICAgICAgIG1hcmdpbjogMTBweDtcbiAgICAgICAgICB9XG4gICAgICAgIGB9XG4gICAgICA8L3N0eWxlPlxuICAgIDwvZGl2PlxuICApO1xufVxuXG5jb25zdCBtYXBTdGF0ZVRvUHJvcHMgPSBzdGF0ZSA9PiAoe1xuICB1c2VyOiBzdGF0ZS51c2VyLmN1cnJlbnRVc2VyLFxuICBmYklkOiBzdGF0ZS51c2VyLmZiVG9rZW4uZmJJZFxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IGNvbm5lY3QobWFwU3RhdGVUb1Byb3BzKShQZXJmb3JtYW5jZSk7XG4iXX0= */\\n/*@ sourceURL=/home/benkissi/projects/getch/getch-frontend-2.0/pages/performance.js */\"));\n}\n\nconst mapStateToProps = state => ({\n  user: state.user.currentUser,\n  fbId: state.user.fbToken.fbId\n});\n\nexport default connect(mapStateToProps)(Performance);","map":{"version":3,"sources":["/home/benkissi/projects/getch/getch-frontend-2.0/pages/performance.js"],"names":["useState","useEffect","connect","chartData","Table","AdAccount","performanceColumns","getAdAccounts","fbPaginate","getCampaigns","Performance","props","state","setState","accountModalVisible","campaignModalVisible","selectedRowKeys","pagingAccounts","next","previous","pagingCampaigns","selectedAdAccount","selectedCampaign","fetchingCampaigns","fbId","user","console","log","Column","require","chart","document","getElementById","data","xField","yField","padding","title","visible","text","forceFit","render","fetchAdAccounts","id","fetchCampaigns","campaigns","setModalVisible","status","modalName","setCampaignsModal","modalVisible","adAccounts","xToken","paging","accountId","res","fetchAdsets","handleAccountPagination","page","handleCampaignPagination","onSelectionChange","selectedRows","selectedInterest","map","interest","name","handleAccountSelect","handleCampaignSelect","onOptionScroll","Option","width","disabled","onClick","item","index","account_status","mapStateToProps","currentUser","fbToken"],"mappings":"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","sourcesContent":["import { useState, useEffect } from \"react\";\nimport { connect } from \"react-redux\";\nimport { Modal, Button, Select, Row, Col } from \"antd\";\n\nimport { chartData } from \"../utils/table\";\n\nimport Table from \"../components/table\";\nimport AdAccount from \"../components/adAccount\";\nimport { performanceColumns } from \"../utils/table\";\nimport { getAdAccounts, fbPaginate, getCampaigns } from \"../api/api\";\n\nfunction Performance(props) {\n  const [state, setState] = useState({\n    accountModalVisible: false,\n    campaignModalVisible: false,\n    selectedRowKeys: null,\n    pagingAccounts: {\n      next: \"\",\n      previous: \"\"\n    },\n    pagingCampaigns: {\n      next: \"\",\n      previous: \"\"\n    },\n    selectedAdAccount: {},\n    selectedCampaign: {},\n    fetchingCampaigns: false\n  });\n\n  const { fbId, user } = props;\n\n  useEffect(() => {\n    if (typeof window !== \"undefined\") {\n      console.log(\"on browser\");\n      const { Column } = require(\"@antv/g2plot\");\n\n      const chart = new Column(document.getElementById(\"chart\"), {\n        data: chartData,\n        xField: \"name\",\n        yField: \"value\",\n        padding: \"auto\",\n        title: {\n          visible: true,\n          text: \"Interest stats\"\n        },\n        forceFit: true\n      });\n      console.log(\"el\", document.getElementById(\"chart\"));\n      chart.render();\n    }\n  }, []);\n\n  useEffect(() => {\n    fetchAdAccounts();\n  }, [state.accountModalVisible]);\n\n  useEffect(() => {\n    if (state.selectedAdAccount.id) {\n      fetchCampaigns();\n    }\n  }, [state.selectedAdAccount]);\n\n  useEffect(() => {\n    // if(state.selectedCampaign.id){\n    //   console.log('#####hey')\n    // }\n    console.log('#####hey')\n  }, [state.campaigns]);\n\n  const setModalVisible = (status, modalName) => {\n    setState({\n      ...state,\n      [modalName]: status\n    });\n  };\n\n  const setCampaignsModal = (modalVisible) => {\n    setState({\n      ...state,\n      campaignModalVisible: modalVisible\n    });\n  }\n\n  const fetchAdAccounts = async () => {\n    if (state.accountModalVisible) {\n      const adAccounts = await getAdAccounts(fbId, user.xToken);\n      setState({\n        ...state,\n        adAccounts: adAccounts,\n        pagingAccounts: {\n          next: adAccounts.paging.next && adAccounts.paging.next,\n          previous: adAccounts.paging.previous && adAccounts.paging.previous\n        },\n      selectedCampaign: {}\n      });\n    }\n  };\n\n  const fetchCampaigns = async () => {\n    setState({\n      ...state,\n      fetchingCampaigns: true,\n    })\n    const accountId = state.selectedAdAccount.id;\n    const res = await getCampaigns(accountId, user.xToken);\n    setState({\n      ...state,\n      campaigns: res,\n      fetchingCampaigns: false,\n      pagingCampaigns: {\n        next: res.paging && res.paging.next,\n        previous: res.paging && res.paging.previous\n      }\n    });\n  };\n\n  const fetchAdsets = async () => {\n    \n  }\n\n  const handleAccountPagination = async page => {\n    const adAccounts = await fbPaginate(page);\n    console.log(\"paginate\", adAccounts);\n    setState({\n      ...state,\n      adAccounts: adAccounts,\n      pagingAccounts: {\n        next: adAccounts.paging && adAccounts.paging.next,\n        previous: adAccounts.paging && adAccounts.paging.previous\n      }\n    });\n  };\n\n  const handleCampaignPagination = async page => {\n    const campaigns = await fbPaginate(page);\n    console.log(\"paginate\", campaigns);\n    setState({\n      ...state,\n      campaigns: campaigns,\n      pagingCampaigns: {\n        next: campaigns.paging && campaigns.paging.next,\n        previous: campaigns.paging && campaigns.paging.previous\n      }\n    });\n  };\n\n  const onSelectionChange = (selectedRowKeys, selectedRows) => {\n    console.log(\"rows\", selectedRows);\n    const selectedInterest = selectedRows.map(interest => {\n      return interest.name;\n    });\n    setState({\n      ...state,\n      selectedRowKeys,\n      selectedInterest,\n      selectedRows\n    });\n  };\n\n  const handleAccountSelect = (id, name) => {\n    setState({\n      ...state,\n      selectedAdAccount: {\n        id,\n        name\n      },\n      accountModalVisible: false,\n    });\n  };\n\n  const handleCampaignSelect = (id, name) => {\n    setState({\n      ...state,\n      selectedCampaign: {\n        id,\n        name\n      },\n      campaignModalVisible: false,\n    });\n  }\n\n  const onOptionScroll = async () => {\n    if(state.campaigns.paging.next){\n      // const res = await fbPaginate(state.campaigns.paging.next)\n      // console.log('paging',res)\n    }\n  }\n\n  const { Option } = Select;\n  const { selectedRowKeys } = state;\n  return (\n    <div id=\"performance\">\n      <Row gutter={16} style={{ width: \"100%\" }}>\n        <Col span={4}>\n          <div className=\"selection\">\n            <div className=\"button item\">\n              <Button onClick={() => setModalVisible(true, 'accountModalVisible')} block>\n                {state.selectedAdAccount.name\n                  ? state.selectedAdAccount.name\n                  : \"Select Ad Account\"}\n              </Button>\n            </div>\n            <div className=\"select item\">\n            <Button onClick={() => setCampaignsModal(true)} block loading={state.fetchingCampaigns} disabled={!!!state.selectedAdAccount.name}>\n                {state.selectedCampaign.name\n                  ? state.selectedCampaign.name\n                  : \"Select Campaign\"}\n              </Button>\n              {/* <Select\n                showSearch\n                style={{ width: \"100%\" }}\n                loading={state.fetchingCampaigns}\n                placeholder=\"Select a campaign\"\n                optionFilterProp=\"children\"\n                // onChange={onChange}\n                // onFocus={onFocus}\n                // onBlur={onBlur}\n                // onSearch={onSearch}\n                onPopupScroll={onOptionScroll}\n                filterOption={(input, option) =>\n                  option.props.children\n                    .toLowerCase()\n                    .indexOf(input.toLowerCase()) >= 0\n                }\n              >\n                {\n                  state.campaigns ?\n                  state.campaigns.data.map((item, index) => {\n                  return <Option value={item.id} key={index}>{item.name}</Option>\n                  }) : ''\n                }\n              </Select> */}\n            </div>\n            <div className=\"select item\">\n              <Select style={{ width: \"100%\" }} placeholder=\"Select adset\">\n                <Option value=\"jack\">Jack</Option>\n                <Option value=\"lucy\">Lucy</Option>\n                <Option value=\"disabled\" disabled>\n                  Disabled\n                </Option>\n                <Option value=\"Yiminghe\">yiminghe</Option>\n              </Select>\n            </div>\n            <div className=\"select item\">\n              <Select style={{ width: \"100%\" }} placeholder=\"Select ad\">\n                <Option value=\"jack\">Jack</Option>\n                <Option value=\"lucy\">Lucy</Option>\n                <Option value=\"disabled\" disabled>\n                  Disabled\n                </Option>\n                <Option value=\"Yiminghe\">yiminghe</Option>\n              </Select>\n            </div>\n          </div>\n        </Col>\n        <Col span={20}>\n          <div className=\"stats\">\n            <div id=\"chart\"></div>\n            <div>\n              <Table\n                columns={performanceColumns}\n                onSelection={onSelectionChange}\n                selectedRowKeys={selectedRowKeys}\n                className=\"table\"\n              />\n            </div>\n          </div>\n        </Col>\n      </Row>\n      <Modal\n        title=\"Select an Ad account\"\n        centered\n        visible={state.accountModalVisible}\n        onOk={() => setModalVisible(false, 'accountModalVisible')}\n        onCancel={() => setModalVisible(false, 'accountModalVisible')}\n        okText=\"Next\"\n        cancelText=\"Previous\"\n        okButtonProps={{\n          disabled: !!!state.pagingAccounts.next,\n          onClick: () => handleAccountPagination(state.pagingAccounts.next)\n        }}\n        cancelButtonProps={{\n          disabled: !!!state.pagingAccounts.previous,\n          onClick: () => handleAccountPagination(state.pagingAccounts.previous)\n        }}\n        width={1300}\n      >\n        <div className=\"adAccounts\">\n          <div className=\"inner\">\n            {state.adAccounts\n              ? state.adAccounts.data.map((item, index) => (\n                  <div className=\"account\" key={index}>\n                    <AdAccount\n                      name={item.name}\n                      accountId={item.id}\n                      status={item.account_status}\n                      onSelect={handleAccountSelect}\n                    />\n                  </div>\n                ))\n              : \"Loading...\"}\n          </div>\n        </div>\n      </Modal>\n      <Modal\n        title=\"Select a campaign\"\n        centered\n        visible={state.campaignModalVisible}\n        onOk={() => setCampaignsModal(false, \"campaignModalVisible\")}\n        onCancel={() => setCampaignsModal(false, \"campaignModalVisible\")}\n        okText=\"Next\"\n        cancelText=\"Previous\"\n        okButtonProps={{\n          disabled: !!!state.pagingCampaigns.next,\n          onClick: () => handleCampaignPagination(state.pagingCampaigns.next)\n        }}\n        cancelButtonProps={{\n          disabled: !!!state.pagingCampaigns.previous,\n          onClick: () => handleCampaignPagination(state.pagingCampaigns.previous)\n        }}\n        width={1300}\n      >\n        <div className=\"adAccounts\">\n          <div className=\"inner\">\n            {state.campaigns\n              ? state.campaigns.data.map((item, index) => (\n                  <div className=\"account\" key={index}>\n                    <AdAccount\n                      name={item.name}\n                      accountId={item.id}\n                      // status={item.account_status}\n                      onSelect={handleCampaignSelect}\n                    />\n                  </div>\n                ))\n              : \"Loading...\"}\n          </div>\n        </div>\n      </Modal>\n      <style jsx>\n        {`\n          #performance {\n            display: flex;\n            position: relative;\n            margin-top: 70px;\n            width: 100%;\n          }\n\n          .selection {\n            display: flex;\n            flex-direction: column;\n            border: 1px solid #ccc;\n            border-radius: 4px;\n            height: auto;\n            padding: 10px;\n          }\n\n          .item {\n            margin-bottom: 30px;\n            width: 100%;\n          }\n          .stats {\n            display: flex;\n            flex-direction: column;\n          }\n\n          .adAccounts {\n            display: flex;\n            justify-content: center;\n          }\n\n          .adAccounts .inner {\n            display: flex;\n            flex-wrap: wrap;\n            width: 90%;\n          }\n\n          .account {\n            min-width: 20%;\n            margin: 10px;\n          }\n        `}\n      </style>\n    </div>\n  );\n}\n\nconst mapStateToProps = state => ({\n  user: state.user.currentUser,\n  fbId: state.user.fbToken.fbId\n});\n\nexport default connect(mapStateToProps)(Performance);\n"]},"metadata":{},"sourceType":"module"}