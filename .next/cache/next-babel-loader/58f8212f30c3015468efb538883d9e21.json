{"ast":null,"code":"import \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/tag/style\";\nimport _Tag from \"antd/lib/tag\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport \"antd/lib/input/style\";\nimport _Input from \"antd/lib/input\";\nvar _jsxFileName = \"/code/ben/getch/frontend/pages/index.js\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useRouter } from \"next/router\";\nimport { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport FacebookLogin from 'react-facebook-login/dist/facebook-login-render-props';\nimport DashboardLayout from '../components/dashboardLayout';\nimport Header from '../components/header';\nimport InterestTable from '../components/table';\nimport { getProducts, fbAuthentication, searchInterest } from '../api/api';\nimport decodeToken from \"../utils/auth\";\nimport { addingCurrentUser, authFacebook } from \"../redux/user/user-actions\";\n\nvar Index = function Index(props) {\n  var _useState = useState({}),\n      state = _useState[0],\n      setState = _useState[1];\n\n  var token = props.token,\n      user = props.user,\n      addUser = props.addUser,\n      fbToken = props.fbToken;\n  var Search = _Input.Search;\n  var router = useRouter();\n  useEffect(function () {\n    if (token) {\n      var decoded = decodeToken(props.token);\n      var _id = decoded._id,\n          name = decoded.name,\n          email = decoded.email,\n          domain = decoded.domain;\n      var userData = {\n        id: _id,\n        name: name,\n        email: email,\n        domain: domain\n      };\n      addUser(userData);\n    } else if (user) {\n      console.log(user);\n    } else {\n      router.push(\"/signin\");\n    }\n  }, []);\n\n  var faceAuthStart = function faceAuthStart() {\n    console.log('#### FB auth start');\n  };\n\n  var responseFacebook = function responseFacebook(res) {\n    var authFb, user, accessToken;\n    return _regeneratorRuntime.async(function responseFacebook$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            authFb = props.authFb, user = props.user;\n            accessToken = res.accessToken;\n            authFb(accessToken, user.id);\n\n          case 3:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    });\n  };\n\n  var getInterest = function getInterest(value) {\n    var data;\n    return _regeneratorRuntime.async(function getInterest$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return _regeneratorRuntime.awrap(searchInterest(fbToken.token, value, 50));\n\n          case 2:\n            data = _context2.sent;\n            console.log(data);\n            setState({\n              interests: data.data\n            });\n\n          case 5:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    });\n  };\n\n  var tableColumns = [{\n    title: 'Name',\n    dataIndex: 'name',\n    key: 'name'\n  }, {\n    title: 'Audience',\n    dataIndex: 'audience_size',\n    key: 'audience'\n  }, {\n    title: 'Topic',\n    dataIndex: 'topic',\n    key: 'topic'\n  }, {\n    title: 'Path',\n    dataIndex: 'path',\n    key: 'path',\n    render: function render(tags) {\n      return __jsx(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81\n        },\n        __self: this\n      }, tags.map(function (tag) {\n        return __jsx(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 85\n          },\n          __self: this\n        }, __jsx(_Tag, {\n          color: \"magenta\",\n          key: tag,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 86\n          },\n          __self: this\n        }, tag.toUpperCase()), \"-\");\n      }));\n    }\n  }];\n  var actions = [__jsx(FacebookLogin, {\n    appId: process.env.FB_APP_ID,\n    autoLoad: true,\n    fields: \"name,email,id\",\n    onClick: faceAuthStart,\n    scope: \"ads_management, email\",\n    callback: responseFacebook,\n    render: function render(renderProps) {\n      return __jsx(_Button, {\n        type: \"primary\",\n        onClick: renderProps.onClick,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109\n        },\n        __self: this\n      }, \"Connect Facebook\");\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101\n    },\n    __self: this\n  })];\n  var interests = state.interests;\n  console.log('interest', interests);\n  return __jsx(DashboardLayout, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    id: \"wrapper\",\n    className: \"jsx-685445646\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118\n    },\n    __self: this\n  }, __jsx(Header, {\n    actions: actions,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119\n    },\n    __self: this\n  }), __jsx(\"div\", {\n    id: \"main-content\",\n    className: \"jsx-685445646\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120\n    },\n    __self: this\n  }, __jsx(Search, {\n    placeholder: \"Find Facebook interest for a keyword\",\n    enterButton: \"Getch\",\n    size: \"large\",\n    onSearch: function onSearch(value) {\n      return getInterest(value);\n    },\n    className: \"jsx-685445646\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121\n    },\n    __self: this\n  }), __jsx(\"div\", {\n    id: \"table\",\n    className: \"jsx-685445646\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127\n    },\n    __self: this\n  }, __jsx(InterestTable, {\n    className: \"table\",\n    columns: tableColumns,\n    dataSource: interests,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128\n    },\n    __self: this\n  }))), __jsx(_JSXStyle, {\n    id: \"685445646\",\n    __self: this\n  }, \"#wrapper.jsx-685445646{margin:10px;}#main-content.jsx-685445646{margin-top:30px;}#table.jsx-685445646{margin-top:30px;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9jb2RlL2Jlbi9nZXRjaC9mcm9udGVuZC9wYWdlcy9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFxSWtCLEFBR3VCLEFBR0ksQUFHQSxZQUxsQixJQUdBLEFBR0EiLCJmaWxlIjoiL2NvZGUvYmVuL2dldGNoL2Zyb250ZW5kL3BhZ2VzL2luZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdXNlUm91dGVyIH0gZnJvbSBcIm5leHQvcm91dGVyXCI7XG5pbXBvcnQgeyB1c2VFZmZlY3QsIHVzZVN0YXRlIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBjb25uZWN0IH0gZnJvbSBcInJlYWN0LXJlZHV4XCI7XG5pbXBvcnQgeyBCdXR0b24sIElucHV0LCBUYWcgfSBmcm9tIFwiYW50ZFwiO1xuaW1wb3J0IEZhY2Vib29rTG9naW4gZnJvbSAncmVhY3QtZmFjZWJvb2stbG9naW4vZGlzdC9mYWNlYm9vay1sb2dpbi1yZW5kZXItcHJvcHMnO1xuXG5pbXBvcnQgRGFzaGJvYXJkTGF5b3V0IGZyb20gJy4uL2NvbXBvbmVudHMvZGFzaGJvYXJkTGF5b3V0J1xuaW1wb3J0IEhlYWRlciBmcm9tICcuLi9jb21wb25lbnRzL2hlYWRlcidcbmltcG9ydCBJbnRlcmVzdFRhYmxlIGZyb20gJy4uL2NvbXBvbmVudHMvdGFibGUnXG5cbmltcG9ydCB7Z2V0UHJvZHVjdHMsIGZiQXV0aGVudGljYXRpb24sIHNlYXJjaEludGVyZXN0fSBmcm9tICcuLi9hcGkvYXBpJ1xuXG5pbXBvcnQgZGVjb2RlVG9rZW4gZnJvbSBcIi4uL3V0aWxzL2F1dGhcIjtcbmltcG9ydCB7IGFkZGluZ0N1cnJlbnRVc2VyLCBhdXRoRmFjZWJvb2sgfSBmcm9tIFwiLi4vcmVkdXgvdXNlci91c2VyLWFjdGlvbnNcIjtcblxuXG5jb25zdCBJbmRleCA9IHByb3BzID0+IHtcbiAgY29uc3QgW3N0YXRlLCBzZXRTdGF0ZV0gPSB1c2VTdGF0ZSh7fSlcbiAgY29uc3QgeyB0b2tlbiwgdXNlciwgYWRkVXNlciwgZmJUb2tlbiB9ID0gcHJvcHM7XG4gIGNvbnN0IHsgU2VhcmNoIH0gPSBJbnB1dDtcbiAgY29uc3Qgcm91dGVyID0gdXNlUm91dGVyKCk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAodG9rZW4pIHtcbiAgICAgIGNvbnN0IGRlY29kZWQgPSBkZWNvZGVUb2tlbihwcm9wcy50b2tlbik7XG4gICAgICBjb25zdCB7IF9pZCwgbmFtZSwgZW1haWwsIGRvbWFpbiB9ID0gZGVjb2RlZDtcbiAgICAgIGNvbnN0IHVzZXJEYXRhID0ge1xuICAgICAgICBpZDogX2lkLFxuICAgICAgICBuYW1lLCBcbiAgICAgICAgZW1haWwsIFxuICAgICAgICBkb21haW5cbiAgICAgIH07XG4gICAgICBhZGRVc2VyKHVzZXJEYXRhKTtcbiAgICB9IGVsc2UgaWYgKHVzZXIpIHtcbiAgICAgIGNvbnNvbGUubG9nKHVzZXIpO1xuICAgIH0gZWxzZSB7XG4gICAgICByb3V0ZXIucHVzaChcIi9zaWduaW5cIik7XG4gICAgfVxuICB9LCBbXSk7XG5cbiAgY29uc3QgZmFjZUF1dGhTdGFydCA9ICgpID0+IHtcbiAgICBjb25zb2xlLmxvZygnIyMjIyBGQiBhdXRoIHN0YXJ0JylcbiAgfVxuXG4gIGNvbnN0IHJlc3BvbnNlRmFjZWJvb2sgPSBhc3luYyAocmVzKSA9PiB7XG4gICAgY29uc3Qge2F1dGhGYiwgdXNlcn0gPSBwcm9wc1xuICAgIGNvbnN0IHthY2Nlc3NUb2tlbn0gPSByZXNcbiAgICBhdXRoRmIoYWNjZXNzVG9rZW4sIHVzZXIuaWQpXG4gIH1cblxuICBjb25zdCBnZXRJbnRlcmVzdCA9IGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBzZWFyY2hJbnRlcmVzdChmYlRva2VuLnRva2VuLCB2YWx1ZSwgNTApXG4gICAgY29uc29sZS5sb2coZGF0YSlcbiAgICBzZXRTdGF0ZSh7XG4gICAgICBpbnRlcmVzdHM6IGRhdGEuZGF0YVxuICAgIH0pXG5cbiAgfVxuXG4gIGNvbnN0IHRhYmxlQ29sdW1ucyA9IFtcbiAgICB7XG4gICAgICB0aXRsZTogJ05hbWUnLFxuICAgICAgZGF0YUluZGV4OiAnbmFtZScsXG4gICAgICBrZXk6ICduYW1lJ1xuICAgIH0sXG4gICAge1xuICAgICAgdGl0bGU6ICdBdWRpZW5jZScsXG4gICAgICBkYXRhSW5kZXg6ICdhdWRpZW5jZV9zaXplJyxcbiAgICAgIGtleTogJ2F1ZGllbmNlJ1xuICAgIH0sXG4gICAge1xuICAgICAgdGl0bGU6ICdUb3BpYycsXG4gICAgICBkYXRhSW5kZXg6ICd0b3BpYycsXG4gICAgICBrZXk6ICd0b3BpYydcbiAgICB9LFxuICAgIHtcbiAgICAgIHRpdGxlOiAnUGF0aCcsXG4gICAgICBkYXRhSW5kZXg6ICdwYXRoJyxcbiAgICAgIGtleTogJ3BhdGgnLFxuICAgICAgcmVuZGVyOiB0YWdzID0+IChcbiAgICAgICAgPHNwYW4+XG4gICAgICAgICAge1xuICAgICAgICAgICAgdGFncy5tYXAodGFnID0+IHtcbiAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgICAgPFRhZyBjb2xvcj1cIm1hZ2VudGFcIiBrZXk9e3RhZ30+XG4gICAgICAgICAgICAgICAgICB7dGFnLnRvVXBwZXJDYXNlKCl9XG4gICAgICAgICAgICAgICAgICA8L1RhZz5cbiAgICAgICAgICAgICAgICAgIC1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9XG4gICAgICAgIDwvc3Bhbj5cbiAgICAgIClcbiAgICB9XG4gIF1cblxuICBjb25zdCBhY3Rpb25zID0gW1xuICAgIDxGYWNlYm9va0xvZ2luXG4gICAgICAgIGFwcElkPXtwcm9jZXNzLmVudi5GQl9BUFBfSUR9XG4gICAgICAgIGF1dG9Mb2FkPXt0cnVlfVxuICAgICAgICBmaWVsZHM9XCJuYW1lLGVtYWlsLGlkXCJcbiAgICAgICAgb25DbGljaz17ZmFjZUF1dGhTdGFydH1cbiAgICAgICAgc2NvcGU9XCJhZHNfbWFuYWdlbWVudCwgZW1haWxcIlxuICAgICAgICBjYWxsYmFjaz17cmVzcG9uc2VGYWNlYm9va30gXG4gICAgICAgIHJlbmRlcj17cmVuZGVyUHJvcHMgPT4gKFxuICAgICAgICAgIDxCdXR0b24gdHlwZT1cInByaW1hcnlcIiBvbkNsaWNrPXtyZW5kZXJQcm9wcy5vbkNsaWNrfT5Db25uZWN0IEZhY2Vib29rPC9CdXR0b24+XG4gICAgICAgICl9XG4gICAgICAgIC8+XG4gIF1cblxuICBjb25zdCB7aW50ZXJlc3RzfSA9IHN0YXRlXG4gIGNvbnNvbGUubG9nKCdpbnRlcmVzdCcsaW50ZXJlc3RzKVxuICByZXR1cm4gKFxuICAgIDxEYXNoYm9hcmRMYXlvdXQ+XG4gICAgPGRpdiBpZD1cIndyYXBwZXJcIj5cbiAgICAgIDxIZWFkZXIgYWN0aW9ucz17YWN0aW9uc30vPlxuICAgICAgPGRpdiBpZD1cIm1haW4tY29udGVudFwiPlxuICAgICAgICA8U2VhcmNoXG4gICAgICAgICAgICBwbGFjZWhvbGRlcj1cIkZpbmQgRmFjZWJvb2sgaW50ZXJlc3QgZm9yIGEga2V5d29yZFwiXG4gICAgICAgICAgICBlbnRlckJ1dHRvbj1cIkdldGNoXCJcbiAgICAgICAgICAgIHNpemU9XCJsYXJnZVwiXG4gICAgICAgICAgICBvblNlYXJjaD17KHZhbHVlKSA9PiBnZXRJbnRlcmVzdCh2YWx1ZSl9XG4gICAgICAgICAgLz5cbiAgICAgICAgICA8ZGl2IGlkPVwidGFibGVcIj5cbiAgICAgICAgICAgIDxJbnRlcmVzdFRhYmxlIGNsYXNzTmFtZT1cInRhYmxlXCIgY29sdW1ucz17dGFibGVDb2x1bW5zfSBkYXRhU291cmNlPXtpbnRlcmVzdHN9Lz5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICBcbiAgICAgIDwvZGl2PlxuICAgICAgICBcblxuICAgICAgPHN0eWxlIGpzeD57YFxuICAgICAgICAjd3JhcHBlciB7XG4gICAgICAgICAgbWFyZ2luOiAxMHB4O1xuICAgICAgICB9XG4gICAgICAgICNtYWluLWNvbnRlbnQge1xuICAgICAgICAgIG1hcmdpbi10b3A6IDMwcHg7XG4gICAgICAgIH1cbiAgICAgICAgI3RhYmxlIHtcbiAgICAgICAgICBtYXJnaW4tdG9wOiAzMHB4O1xuICAgICAgICB9XG4gICAgICBgfTwvc3R5bGU+XG4gICAgPC9kaXY+XG4gICAgPC9EYXNoYm9hcmRMYXlvdXQ+XG4gICk7XG59O1xuXG5JbmRleC5nZXRJbml0aWFsUHJvcHMgPSBhc3luYyBmdW5jdGlvbihjb250ZXh0KSB7XG4gIGNvbnN0IHRva2VuID0gY29udGV4dC5xdWVyeS5hdDtcbiAgcmV0dXJuIHtcbiAgICB0b2tlblxuICB9O1xufTtcblxuY29uc3QgbWFwU3RhdGVUb1Byb3BzID0gc3RhdGUgPT4gKHtcbiAgdXNlcjogc3RhdGUudXNlci5jdXJyZW50VXNlcixcbiAgZmJUb2tlbjogc3RhdGUudXNlci5mYlRva2VuXG59KTtcblxuY29uc3QgbWFwRGlzcGF0Y2hUb1Byb3BzID0gZGlzcGF0Y2ggPT4gKHtcbiAgYWRkVXNlcjogaXRlbSA9PiBkaXNwYXRjaChhZGRpbmdDdXJyZW50VXNlcihpdGVtKSksXG4gIGF1dGhGYjogKHRva2VuLCBpZCkgPT4gZGlzcGF0Y2goYXV0aEZhY2Vib29rKHt0b2tlbiwgaWR9KSlcbn0pO1xuXG5leHBvcnQgZGVmYXVsdCBjb25uZWN0KG1hcFN0YXRlVG9Qcm9wcywgbWFwRGlzcGF0Y2hUb1Byb3BzKShJbmRleCk7XG4iXX0= */\\n/*@ sourceURL=/code/ben/getch/frontend/pages/index.js */\")));\n};\n\nIndex.getInitialProps = function _callee(context) {\n  var token;\n  return _regeneratorRuntime.async(function _callee$(_context3) {\n    while (1) {\n      switch (_context3.prev = _context3.next) {\n        case 0:\n          token = context.query.at;\n          return _context3.abrupt(\"return\", {\n            token: token\n          });\n\n        case 2:\n        case \"end\":\n          return _context3.stop();\n      }\n    }\n  });\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    user: state.user.currentUser,\n    fbToken: state.user.fbToken\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    addUser: function addUser(item) {\n      return dispatch(addingCurrentUser(item));\n    },\n    authFb: function authFb(token, id) {\n      return dispatch(authFacebook({\n        token: token,\n        id: id\n      }));\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Index);","map":{"version":3,"sources":["/code/ben/getch/frontend/pages/index.js"],"names":["useRouter","useEffect","useState","connect","FacebookLogin","DashboardLayout","Header","InterestTable","getProducts","fbAuthentication","searchInterest","decodeToken","addingCurrentUser","authFacebook","Index","props","state","setState","token","user","addUser","fbToken","Search","router","decoded","_id","name","email","domain","userData","id","console","log","push","faceAuthStart","responseFacebook","res","authFb","accessToken","getInterest","value","data","interests","tableColumns","title","dataIndex","key","render","tags","map","tag","toUpperCase","actions","process","env","FB_APP_ID","renderProps","onClick","getInitialProps","context","query","at","mapStateToProps","currentUser","mapDispatchToProps","dispatch","item"],"mappings":";;;;;;;;;;;AAAA,SAASA,SAAT,QAA0B,aAA1B;AACA,SAASC,SAAT,EAAoBC,QAApB,QAAoC,OAApC;AACA,SAASC,OAAT,QAAwB,aAAxB;AAEA,OAAOC,aAAP,MAA0B,uDAA1B;AAEA,OAAOC,eAAP,MAA4B,+BAA5B;AACA,OAAOC,MAAP,MAAmB,sBAAnB;AACA,OAAOC,aAAP,MAA0B,qBAA1B;AAEA,SAAQC,WAAR,EAAqBC,gBAArB,EAAuCC,cAAvC,QAA4D,YAA5D;AAEA,OAAOC,WAAP,MAAwB,eAAxB;AACA,SAASC,iBAAT,EAA4BC,YAA5B,QAAgD,4BAAhD;;AAGA,IAAMC,KAAK,GAAG,SAARA,KAAQ,CAAAC,KAAK,EAAI;AAAA,kBACKb,QAAQ,CAAC,EAAD,CADb;AAAA,MACdc,KADc;AAAA,MACPC,QADO;;AAAA,MAEbC,KAFa,GAEqBH,KAFrB,CAEbG,KAFa;AAAA,MAENC,IAFM,GAEqBJ,KAFrB,CAENI,IAFM;AAAA,MAEAC,OAFA,GAEqBL,KAFrB,CAEAK,OAFA;AAAA,MAESC,OAFT,GAEqBN,KAFrB,CAESM,OAFT;AAAA,MAGbC,MAHa,UAGbA,MAHa;AAIrB,MAAMC,MAAM,GAAGvB,SAAS,EAAxB;AAEAC,EAAAA,SAAS,CAAC,YAAM;AACd,QAAIiB,KAAJ,EAAW;AACT,UAAMM,OAAO,GAAGb,WAAW,CAACI,KAAK,CAACG,KAAP,CAA3B;AADS,UAEDO,GAFC,GAE4BD,OAF5B,CAEDC,GAFC;AAAA,UAEIC,IAFJ,GAE4BF,OAF5B,CAEIE,IAFJ;AAAA,UAEUC,KAFV,GAE4BH,OAF5B,CAEUG,KAFV;AAAA,UAEiBC,MAFjB,GAE4BJ,OAF5B,CAEiBI,MAFjB;AAGT,UAAMC,QAAQ,GAAG;AACfC,QAAAA,EAAE,EAAEL,GADW;AAEfC,QAAAA,IAAI,EAAJA,IAFe;AAGfC,QAAAA,KAAK,EAALA,KAHe;AAIfC,QAAAA,MAAM,EAANA;AAJe,OAAjB;AAMAR,MAAAA,OAAO,CAACS,QAAD,CAAP;AACD,KAVD,MAUO,IAAIV,IAAJ,EAAU;AACfY,MAAAA,OAAO,CAACC,GAAR,CAAYb,IAAZ;AACD,KAFM,MAEA;AACLI,MAAAA,MAAM,CAACU,IAAP,CAAY,SAAZ;AACD;AACF,GAhBQ,EAgBN,EAhBM,CAAT;;AAkBA,MAAMC,aAAa,GAAG,SAAhBA,aAAgB,GAAM;AAC1BH,IAAAA,OAAO,CAACC,GAAR,CAAY,oBAAZ;AACD,GAFD;;AAIA,MAAMG,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAOC,GAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAChBC,YAAAA,MADgB,GACAtB,KADA,CAChBsB,MADgB,EACRlB,IADQ,GACAJ,KADA,CACRI,IADQ;AAEhBmB,YAAAA,WAFgB,GAEDF,GAFC,CAEhBE,WAFgB;AAGvBD,YAAAA,MAAM,CAACC,WAAD,EAAcnB,IAAI,CAACW,EAAnB,CAAN;;AAHuB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAzB;;AAMA,MAAMS,WAAW,GAAG,SAAdA,WAAc,CAAOC,KAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6CACC9B,cAAc,CAACW,OAAO,CAACH,KAAT,EAAgBsB,KAAhB,EAAuB,EAAvB,CADf;;AAAA;AACZC,YAAAA,IADY;AAElBV,YAAAA,OAAO,CAACC,GAAR,CAAYS,IAAZ;AACAxB,YAAAA,QAAQ,CAAC;AACPyB,cAAAA,SAAS,EAAED,IAAI,CAACA;AADT,aAAD,CAAR;;AAHkB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAApB;;AASA,MAAME,YAAY,GAAG,CACnB;AACEC,IAAAA,KAAK,EAAE,MADT;AAEEC,IAAAA,SAAS,EAAE,MAFb;AAGEC,IAAAA,GAAG,EAAE;AAHP,GADmB,EAMnB;AACEF,IAAAA,KAAK,EAAE,UADT;AAEEC,IAAAA,SAAS,EAAE,eAFb;AAGEC,IAAAA,GAAG,EAAE;AAHP,GANmB,EAWnB;AACEF,IAAAA,KAAK,EAAE,OADT;AAEEC,IAAAA,SAAS,EAAE,OAFb;AAGEC,IAAAA,GAAG,EAAE;AAHP,GAXmB,EAgBnB;AACEF,IAAAA,KAAK,EAAE,MADT;AAEEC,IAAAA,SAAS,EAAE,MAFb;AAGEC,IAAAA,GAAG,EAAE,MAHP;AAIEC,IAAAA,MAAM,EAAE,gBAAAC,IAAI;AAAA,aACV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAEIA,IAAI,CAACC,GAAL,CAAS,UAAAC,GAAG,EAAI;AACd,eACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE;AAAK,UAAA,KAAK,EAAC,SAAX;AAAqB,UAAA,GAAG,EAAEA,GAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACCA,GAAG,CAACC,WAAJ,EADD,CADF,MADF;AASD,OAVD,CAFJ,CADU;AAAA;AAJd,GAhBmB,CAArB;AAwCA,MAAMC,OAAO,GAAG,CACd,MAAC,aAAD;AACI,IAAA,KAAK,EAAEC,OAAO,CAACC,GAAR,CAAYC,SADvB;AAEI,IAAA,QAAQ,EAAE,IAFd;AAGI,IAAA,MAAM,EAAC,eAHX;AAII,IAAA,OAAO,EAAErB,aAJb;AAKI,IAAA,KAAK,EAAC,uBALV;AAMI,IAAA,QAAQ,EAAEC,gBANd;AAOI,IAAA,MAAM,EAAE,gBAAAqB,WAAW;AAAA,aACjB;AAAQ,QAAA,IAAI,EAAC,SAAb;AAAuB,QAAA,OAAO,EAAEA,WAAW,CAACC,OAA5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BADiB;AAAA,KAPvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADc,CAAhB;AAnFqB,MAiGdf,SAjGc,GAiGD1B,KAjGC,CAiGd0B,SAjGc;AAkGrBX,EAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAuBU,SAAvB;AACA,SACE,MAAC,eAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACA;AAAK,IAAA,EAAE,EAAC,SAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,MAAD;AAAQ,IAAA,OAAO,EAAEU,OAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAEE;AAAK,IAAA,EAAE,EAAC,cAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,MAAD;AACI,IAAA,WAAW,EAAC,sCADhB;AAEI,IAAA,WAAW,EAAC,OAFhB;AAGI,IAAA,IAAI,EAAC,OAHT;AAII,IAAA,QAAQ,EAAE,kBAACZ,KAAD;AAAA,aAAWD,WAAW,CAACC,KAAD,CAAtB;AAAA,KAJd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAOI;AAAK,IAAA,EAAE,EAAC,OAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,aAAD;AAAe,IAAA,SAAS,EAAC,OAAzB;AAAiC,IAAA,OAAO,EAAEG,YAA1C;AAAwD,IAAA,UAAU,EAAED,SAApE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CAPJ,CAFF;AAAA;AAAA;AAAA,u3LADA,CADF;AAgCD,CAnID;;AAqIA5B,KAAK,CAAC4C,eAAN,GAAwB,iBAAeC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAChBzC,UAAAA,KADgB,GACRyC,OAAO,CAACC,KAAR,CAAcC,EADN;AAAA,4CAEf;AACL3C,YAAAA,KAAK,EAALA;AADK,WAFe;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAxB;;AAOA,IAAM4C,eAAe,GAAG,SAAlBA,eAAkB,CAAA9C,KAAK;AAAA,SAAK;AAChCG,IAAAA,IAAI,EAAEH,KAAK,CAACG,IAAN,CAAW4C,WADe;AAEhC1C,IAAAA,OAAO,EAAEL,KAAK,CAACG,IAAN,CAAWE;AAFY,GAAL;AAAA,CAA7B;;AAKA,IAAM2C,kBAAkB,GAAG,SAArBA,kBAAqB,CAAAC,QAAQ;AAAA,SAAK;AACtC7C,IAAAA,OAAO,EAAE,iBAAA8C,IAAI;AAAA,aAAID,QAAQ,CAACrD,iBAAiB,CAACsD,IAAD,CAAlB,CAAZ;AAAA,KADyB;AAEtC7B,IAAAA,MAAM,EAAE,gBAACnB,KAAD,EAAQY,EAAR;AAAA,aAAemC,QAAQ,CAACpD,YAAY,CAAC;AAACK,QAAAA,KAAK,EAALA,KAAD;AAAQY,QAAAA,EAAE,EAAFA;AAAR,OAAD,CAAb,CAAvB;AAAA;AAF8B,GAAL;AAAA,CAAnC;;AAKA,eAAe3B,OAAO,CAAC2D,eAAD,EAAkBE,kBAAlB,CAAP,CAA6ClD,KAA7C,CAAf","sourcesContent":["import { useRouter } from \"next/router\";\nimport { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport { Button, Input, Tag } from \"antd\";\nimport FacebookLogin from 'react-facebook-login/dist/facebook-login-render-props';\n\nimport DashboardLayout from '../components/dashboardLayout'\nimport Header from '../components/header'\nimport InterestTable from '../components/table'\n\nimport {getProducts, fbAuthentication, searchInterest} from '../api/api'\n\nimport decodeToken from \"../utils/auth\";\nimport { addingCurrentUser, authFacebook } from \"../redux/user/user-actions\";\n\n\nconst Index = props => {\n  const [state, setState] = useState({})\n  const { token, user, addUser, fbToken } = props;\n  const { Search } = Input;\n  const router = useRouter();\n\n  useEffect(() => {\n    if (token) {\n      const decoded = decodeToken(props.token);\n      const { _id, name, email, domain } = decoded;\n      const userData = {\n        id: _id,\n        name, \n        email, \n        domain\n      };\n      addUser(userData);\n    } else if (user) {\n      console.log(user);\n    } else {\n      router.push(\"/signin\");\n    }\n  }, []);\n\n  const faceAuthStart = () => {\n    console.log('#### FB auth start')\n  }\n\n  const responseFacebook = async (res) => {\n    const {authFb, user} = props\n    const {accessToken} = res\n    authFb(accessToken, user.id)\n  }\n\n  const getInterest = async (value) => {\n    const data = await searchInterest(fbToken.token, value, 50)\n    console.log(data)\n    setState({\n      interests: data.data\n    })\n\n  }\n\n  const tableColumns = [\n    {\n      title: 'Name',\n      dataIndex: 'name',\n      key: 'name'\n    },\n    {\n      title: 'Audience',\n      dataIndex: 'audience_size',\n      key: 'audience'\n    },\n    {\n      title: 'Topic',\n      dataIndex: 'topic',\n      key: 'topic'\n    },\n    {\n      title: 'Path',\n      dataIndex: 'path',\n      key: 'path',\n      render: tags => (\n        <span>\n          {\n            tags.map(tag => {\n              return (\n                <div>\n                  <Tag color=\"magenta\" key={tag}>\n                  {tag.toUpperCase()}\n                  </Tag>\n                  -\n                </div>\n                \n              )\n            })\n          }\n        </span>\n      )\n    }\n  ]\n\n  const actions = [\n    <FacebookLogin\n        appId={process.env.FB_APP_ID}\n        autoLoad={true}\n        fields=\"name,email,id\"\n        onClick={faceAuthStart}\n        scope=\"ads_management, email\"\n        callback={responseFacebook} \n        render={renderProps => (\n          <Button type=\"primary\" onClick={renderProps.onClick}>Connect Facebook</Button>\n        )}\n        />\n  ]\n\n  const {interests} = state\n  console.log('interest',interests)\n  return (\n    <DashboardLayout>\n    <div id=\"wrapper\">\n      <Header actions={actions}/>\n      <div id=\"main-content\">\n        <Search\n            placeholder=\"Find Facebook interest for a keyword\"\n            enterButton=\"Getch\"\n            size=\"large\"\n            onSearch={(value) => getInterest(value)}\n          />\n          <div id=\"table\">\n            <InterestTable className=\"table\" columns={tableColumns} dataSource={interests}/>\n          </div>\n          \n      </div>\n        \n\n      <style jsx>{`\n        #wrapper {\n          margin: 10px;\n        }\n        #main-content {\n          margin-top: 30px;\n        }\n        #table {\n          margin-top: 30px;\n        }\n      `}</style>\n    </div>\n    </DashboardLayout>\n  );\n};\n\nIndex.getInitialProps = async function(context) {\n  const token = context.query.at;\n  return {\n    token\n  };\n};\n\nconst mapStateToProps = state => ({\n  user: state.user.currentUser,\n  fbToken: state.user.fbToken\n});\n\nconst mapDispatchToProps = dispatch => ({\n  addUser: item => dispatch(addingCurrentUser(item)),\n  authFb: (token, id) => dispatch(authFacebook({token, id}))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Index);\n"]},"metadata":{},"sourceType":"module"}