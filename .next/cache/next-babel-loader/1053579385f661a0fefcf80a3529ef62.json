{"ast":null,"code":"import \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/tag/style\";\nimport _Tag from \"antd/lib/tag\";\nimport \"antd/lib/input/style\";\nimport _Input from \"antd/lib/input\";\nvar _jsxFileName = \"/code/ben/getch/frontend/pages/index.js\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useRouter } from \"next/router\";\nimport { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport FacebookLogin from 'react-facebook-login/dist/facebook-login-render-props';\nimport DashboardLayout from '../components/dashboardLayout';\nimport Header from '../components/header';\nimport { getProducts, fbAuthentication, searchInterest } from '../api/api';\nimport decodeToken from \"../utils/auth\";\nimport { addingCurrentUser, authFacebook } from \"../redux/user/user-actions\";\n\nconst Index = props => {\n  const {\n    0: state,\n    1: setState\n  } = useState({});\n  const {\n    token,\n    user,\n    addUser,\n    fbToken\n  } = props;\n  const {\n    Search\n  } = _Input;\n  const router = useRouter();\n  useEffect(() => {\n    if (token) {\n      const decoded = decodeToken(props.token);\n      const {\n        _id,\n        name,\n        email,\n        domain\n      } = decoded;\n      const userData = {\n        id: _id,\n        name,\n        email,\n        domain\n      };\n      addUser(userData);\n    } else if (user) {\n      console.log(user);\n    } else {\n      router.push(\"/signin\");\n    }\n  }, []);\n\n  const faceAuthStart = () => {\n    console.log('#### FB auth start');\n  };\n\n  const responseFacebook = async res => {\n    const {\n      authFb,\n      user\n    } = props;\n    const {\n      accessToken\n    } = res;\n    authFb(accessToken, user.id);\n  };\n\n  const getInterest = async value => {\n    const data = await searchInterest(fbToken.token, value, 50);\n    console.log(data);\n    setState({\n      interest: data\n    });\n  };\n\n  const tableColumns = [{\n    title: 'Name',\n    dataIndex: 'name',\n    key: 'name'\n  }, {\n    title: 'Audience',\n    dataIndex: 'audience_size',\n    key: 'audience'\n  }, {\n    title: 'Topic',\n    dataIndex: 'topic',\n    key: 'topic'\n  }, {\n    title: 'Path',\n    dataIndex: 'path',\n    key: 'path',\n    render: tags => __jsx(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80\n      },\n      __self: this\n    }, tags.map(tag => {\n      return __jsx(_Tag, {\n        color: \"magenta\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84\n        },\n        __self: this\n      }, tag.toUpperCase());\n    }))\n  }];\n  const actions = [__jsx(FacebookLogin, {\n    appId: process.env.FB_APP_ID,\n    autoLoad: true,\n    fields: \"name,email,id\",\n    onClick: faceAuthStart,\n    scope: \"ads_management, email\",\n    callback: responseFacebook,\n    render: renderProps => __jsx(_Button, {\n      type: \"primary\",\n      onClick: renderProps.onClick,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }, \"Connect Facebook\"),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96\n    },\n    __self: this\n  })];\n  return __jsx(DashboardLayout, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    id: \"wrapper\",\n    className: \"jsx-1709134241\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111\n    },\n    __self: this\n  }, __jsx(Header, {\n    actions: actions,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  }), __jsx(\"div\", {\n    id: \"main-content\",\n    className: \"jsx-1709134241\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113\n    },\n    __self: this\n  }, __jsx(Search, {\n    placeholder: \"Find Facebook interest for a keyword\",\n    enterButton: \"Getch\",\n    size: \"large\",\n    onSearch: value => getInterest(value),\n    className: \"jsx-1709134241\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114\n    },\n    __self: this\n  })), __jsx(_JSXStyle, {\n    id: \"1709134241\",\n    __self: this\n  }, \"#wrapper.jsx-1709134241{margin:10px;}#main-content.jsx-1709134241{margin-top:30px;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9jb2RlL2Jlbi9nZXRjaC9mcm9udGVuZC9wYWdlcy9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUEwSGtCLEFBR3VCLEFBR0ksWUFGbEIsSUFHQSIsImZpbGUiOiIvY29kZS9iZW4vZ2V0Y2gvZnJvbnRlbmQvcGFnZXMvaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB1c2VSb3V0ZXIgfSBmcm9tIFwibmV4dC9yb3V0ZXJcIjtcbmltcG9ydCB7IHVzZUVmZmVjdCwgdXNlU3RhdGUgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IGNvbm5lY3QgfSBmcm9tIFwicmVhY3QtcmVkdXhcIjtcbmltcG9ydCB7IEJ1dHRvbiwgSW5wdXQsIFRhZyB9IGZyb20gXCJhbnRkXCI7XG5pbXBvcnQgRmFjZWJvb2tMb2dpbiBmcm9tICdyZWFjdC1mYWNlYm9vay1sb2dpbi9kaXN0L2ZhY2Vib29rLWxvZ2luLXJlbmRlci1wcm9wcyc7XG5cbmltcG9ydCBEYXNoYm9hcmRMYXlvdXQgZnJvbSAnLi4vY29tcG9uZW50cy9kYXNoYm9hcmRMYXlvdXQnXG5pbXBvcnQgSGVhZGVyIGZyb20gJy4uL2NvbXBvbmVudHMvaGVhZGVyJ1xuXG5pbXBvcnQge2dldFByb2R1Y3RzLCBmYkF1dGhlbnRpY2F0aW9uLCBzZWFyY2hJbnRlcmVzdH0gZnJvbSAnLi4vYXBpL2FwaSdcblxuaW1wb3J0IGRlY29kZVRva2VuIGZyb20gXCIuLi91dGlscy9hdXRoXCI7XG5pbXBvcnQgeyBhZGRpbmdDdXJyZW50VXNlciwgYXV0aEZhY2Vib29rIH0gZnJvbSBcIi4uL3JlZHV4L3VzZXIvdXNlci1hY3Rpb25zXCI7XG5cblxuY29uc3QgSW5kZXggPSBwcm9wcyA9PiB7XG4gIGNvbnN0IFtzdGF0ZSwgc2V0U3RhdGVdID0gdXNlU3RhdGUoe30pXG4gIGNvbnN0IHsgdG9rZW4sIHVzZXIsIGFkZFVzZXIsIGZiVG9rZW4gfSA9IHByb3BzO1xuICBjb25zdCB7IFNlYXJjaCB9ID0gSW5wdXQ7XG4gIGNvbnN0IHJvdXRlciA9IHVzZVJvdXRlcigpO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKHRva2VuKSB7XG4gICAgICBjb25zdCBkZWNvZGVkID0gZGVjb2RlVG9rZW4ocHJvcHMudG9rZW4pO1xuICAgICAgY29uc3QgeyBfaWQsIG5hbWUsIGVtYWlsLCBkb21haW4gfSA9IGRlY29kZWQ7XG4gICAgICBjb25zdCB1c2VyRGF0YSA9IHtcbiAgICAgICAgaWQ6IF9pZCxcbiAgICAgICAgbmFtZSwgXG4gICAgICAgIGVtYWlsLCBcbiAgICAgICAgZG9tYWluXG4gICAgICB9O1xuICAgICAgYWRkVXNlcih1c2VyRGF0YSk7XG4gICAgfSBlbHNlIGlmICh1c2VyKSB7XG4gICAgICBjb25zb2xlLmxvZyh1c2VyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcm91dGVyLnB1c2goXCIvc2lnbmluXCIpO1xuICAgIH1cbiAgfSwgW10pO1xuXG4gIGNvbnN0IGZhY2VBdXRoU3RhcnQgPSAoKSA9PiB7XG4gICAgY29uc29sZS5sb2coJyMjIyMgRkIgYXV0aCBzdGFydCcpXG4gIH1cblxuICBjb25zdCByZXNwb25zZUZhY2Vib29rID0gYXN5bmMgKHJlcykgPT4ge1xuICAgIGNvbnN0IHthdXRoRmIsIHVzZXJ9ID0gcHJvcHNcbiAgICBjb25zdCB7YWNjZXNzVG9rZW59ID0gcmVzXG4gICAgYXV0aEZiKGFjY2Vzc1Rva2VuLCB1c2VyLmlkKVxuICB9XG5cbiAgY29uc3QgZ2V0SW50ZXJlc3QgPSBhc3luYyAodmFsdWUpID0+IHtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgc2VhcmNoSW50ZXJlc3QoZmJUb2tlbi50b2tlbiwgdmFsdWUsIDUwKVxuICAgIGNvbnNvbGUubG9nKGRhdGEpXG4gICAgc2V0U3RhdGUoe1xuICAgICAgaW50ZXJlc3Q6IGRhdGFcbiAgICB9KVxuXG4gIH1cblxuICBjb25zdCB0YWJsZUNvbHVtbnMgPSBbXG4gICAge1xuICAgICAgdGl0bGU6ICdOYW1lJyxcbiAgICAgIGRhdGFJbmRleDogJ25hbWUnLFxuICAgICAga2V5OiAnbmFtZSdcbiAgICB9LFxuICAgIHtcbiAgICAgIHRpdGxlOiAnQXVkaWVuY2UnLFxuICAgICAgZGF0YUluZGV4OiAnYXVkaWVuY2Vfc2l6ZScsXG4gICAgICBrZXk6ICdhdWRpZW5jZSdcbiAgICB9LFxuICAgIHtcbiAgICAgIHRpdGxlOiAnVG9waWMnLFxuICAgICAgZGF0YUluZGV4OiAndG9waWMnLFxuICAgICAga2V5OiAndG9waWMnXG4gICAgfSxcbiAgICB7XG4gICAgICB0aXRsZTogJ1BhdGgnLFxuICAgICAgZGF0YUluZGV4OiAncGF0aCcsXG4gICAgICBrZXk6ICdwYXRoJyxcbiAgICAgIHJlbmRlcjogdGFncyA9PiAoXG4gICAgICAgIDxzcGFuPlxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHRhZ3MubWFwKHRhZyA9PiB7XG4gICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgPFRhZyBjb2xvcj1cIm1hZ2VudGFcIj5cbiAgICAgICAgICAgICAgICAgIHt0YWcudG9VcHBlckNhc2UoKX1cbiAgICAgICAgICAgICAgICA8L1RhZz5cbiAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9XG4gICAgICAgIDwvc3Bhbj5cbiAgICAgIClcbiAgICB9XG4gIF1cblxuICBjb25zdCBhY3Rpb25zID0gW1xuICAgIDxGYWNlYm9va0xvZ2luXG4gICAgICAgIGFwcElkPXtwcm9jZXNzLmVudi5GQl9BUFBfSUR9XG4gICAgICAgIGF1dG9Mb2FkPXt0cnVlfVxuICAgICAgICBmaWVsZHM9XCJuYW1lLGVtYWlsLGlkXCJcbiAgICAgICAgb25DbGljaz17ZmFjZUF1dGhTdGFydH1cbiAgICAgICAgc2NvcGU9XCJhZHNfbWFuYWdlbWVudCwgZW1haWxcIlxuICAgICAgICBjYWxsYmFjaz17cmVzcG9uc2VGYWNlYm9va30gXG4gICAgICAgIHJlbmRlcj17cmVuZGVyUHJvcHMgPT4gKFxuICAgICAgICAgIDxCdXR0b24gdHlwZT1cInByaW1hcnlcIiBvbkNsaWNrPXtyZW5kZXJQcm9wcy5vbkNsaWNrfT5Db25uZWN0IEZhY2Vib29rPC9CdXR0b24+XG4gICAgICAgICl9XG4gICAgICAgIC8+XG4gIF1cblxuICByZXR1cm4gKFxuICAgIDxEYXNoYm9hcmRMYXlvdXQ+XG4gICAgPGRpdiBpZD1cIndyYXBwZXJcIj5cbiAgICAgIDxIZWFkZXIgYWN0aW9ucz17YWN0aW9uc30vPlxuICAgICAgPGRpdiBpZD1cIm1haW4tY29udGVudFwiPlxuICAgICAgICA8U2VhcmNoXG4gICAgICAgICAgICBwbGFjZWhvbGRlcj1cIkZpbmQgRmFjZWJvb2sgaW50ZXJlc3QgZm9yIGEga2V5d29yZFwiXG4gICAgICAgICAgICBlbnRlckJ1dHRvbj1cIkdldGNoXCJcbiAgICAgICAgICAgIHNpemU9XCJsYXJnZVwiXG4gICAgICAgICAgICBvblNlYXJjaD17KHZhbHVlKSA9PiBnZXRJbnRlcmVzdCh2YWx1ZSl9XG4gICAgICAgICAgLz5cbiAgICAgIDwvZGl2PlxuICAgICAgICBcblxuICAgICAgPHN0eWxlIGpzeD57YFxuICAgICAgICAjd3JhcHBlciB7XG4gICAgICAgICAgbWFyZ2luOiAxMHB4O1xuICAgICAgICB9XG4gICAgICAgICNtYWluLWNvbnRlbnQge1xuICAgICAgICAgIG1hcmdpbi10b3A6IDMwcHg7XG4gICAgICAgIH1cbiAgICAgIGB9PC9zdHlsZT5cbiAgICA8L2Rpdj5cbiAgICA8L0Rhc2hib2FyZExheW91dD5cbiAgKTtcbn07XG5cbkluZGV4LmdldEluaXRpYWxQcm9wcyA9IGFzeW5jIGZ1bmN0aW9uKGNvbnRleHQpIHtcbiAgY29uc3QgdG9rZW4gPSBjb250ZXh0LnF1ZXJ5LmF0O1xuICByZXR1cm4ge1xuICAgIHRva2VuXG4gIH07XG59O1xuXG5jb25zdCBtYXBTdGF0ZVRvUHJvcHMgPSBzdGF0ZSA9PiAoe1xuICB1c2VyOiBzdGF0ZS51c2VyLmN1cnJlbnRVc2VyLFxuICBmYlRva2VuOiBzdGF0ZS51c2VyLmZiVG9rZW5cbn0pO1xuXG5jb25zdCBtYXBEaXNwYXRjaFRvUHJvcHMgPSBkaXNwYXRjaCA9PiAoe1xuICBhZGRVc2VyOiBpdGVtID0+IGRpc3BhdGNoKGFkZGluZ0N1cnJlbnRVc2VyKGl0ZW0pKSxcbiAgYXV0aEZiOiAodG9rZW4sIGlkKSA9PiBkaXNwYXRjaChhdXRoRmFjZWJvb2soe3Rva2VuLCBpZH0pKVxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IGNvbm5lY3QobWFwU3RhdGVUb1Byb3BzLCBtYXBEaXNwYXRjaFRvUHJvcHMpKEluZGV4KTtcbiJdfQ== */\\n/*@ sourceURL=/code/ben/getch/frontend/pages/index.js */\")));\n};\n\nIndex.getInitialProps = async function (context) {\n  const token = context.query.at;\n  return {\n    token\n  };\n};\n\nconst mapStateToProps = state => ({\n  user: state.user.currentUser,\n  fbToken: state.user.fbToken\n});\n\nconst mapDispatchToProps = dispatch => ({\n  addUser: item => dispatch(addingCurrentUser(item)),\n  authFb: (token, id) => dispatch(authFacebook({\n    token,\n    id\n  }))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Index);","map":{"version":3,"sources":["/code/ben/getch/frontend/pages/index.js"],"names":["useRouter","useEffect","useState","connect","FacebookLogin","DashboardLayout","Header","getProducts","fbAuthentication","searchInterest","decodeToken","addingCurrentUser","authFacebook","Index","props","state","setState","token","user","addUser","fbToken","Search","router","decoded","_id","name","email","domain","userData","id","console","log","push","faceAuthStart","responseFacebook","res","authFb","accessToken","getInterest","value","data","interest","tableColumns","title","dataIndex","key","render","tags","map","tag","toUpperCase","actions","process","env","FB_APP_ID","renderProps","onClick","getInitialProps","context","query","at","mapStateToProps","currentUser","mapDispatchToProps","dispatch","item"],"mappings":"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","sourcesContent":["import { useRouter } from \"next/router\";\nimport { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport { Button, Input, Tag } from \"antd\";\nimport FacebookLogin from 'react-facebook-login/dist/facebook-login-render-props';\n\nimport DashboardLayout from '../components/dashboardLayout'\nimport Header from '../components/header'\n\nimport {getProducts, fbAuthentication, searchInterest} from '../api/api'\n\nimport decodeToken from \"../utils/auth\";\nimport { addingCurrentUser, authFacebook } from \"../redux/user/user-actions\";\n\n\nconst Index = props => {\n  const [state, setState] = useState({})\n  const { token, user, addUser, fbToken } = props;\n  const { Search } = Input;\n  const router = useRouter();\n\n  useEffect(() => {\n    if (token) {\n      const decoded = decodeToken(props.token);\n      const { _id, name, email, domain } = decoded;\n      const userData = {\n        id: _id,\n        name, \n        email, \n        domain\n      };\n      addUser(userData);\n    } else if (user) {\n      console.log(user);\n    } else {\n      router.push(\"/signin\");\n    }\n  }, []);\n\n  const faceAuthStart = () => {\n    console.log('#### FB auth start')\n  }\n\n  const responseFacebook = async (res) => {\n    const {authFb, user} = props\n    const {accessToken} = res\n    authFb(accessToken, user.id)\n  }\n\n  const getInterest = async (value) => {\n    const data = await searchInterest(fbToken.token, value, 50)\n    console.log(data)\n    setState({\n      interest: data\n    })\n\n  }\n\n  const tableColumns = [\n    {\n      title: 'Name',\n      dataIndex: 'name',\n      key: 'name'\n    },\n    {\n      title: 'Audience',\n      dataIndex: 'audience_size',\n      key: 'audience'\n    },\n    {\n      title: 'Topic',\n      dataIndex: 'topic',\n      key: 'topic'\n    },\n    {\n      title: 'Path',\n      dataIndex: 'path',\n      key: 'path',\n      render: tags => (\n        <span>\n          {\n            tags.map(tag => {\n              return (\n                <Tag color=\"magenta\">\n                  {tag.toUpperCase()}\n                </Tag>\n              )\n            })\n          }\n        </span>\n      )\n    }\n  ]\n\n  const actions = [\n    <FacebookLogin\n        appId={process.env.FB_APP_ID}\n        autoLoad={true}\n        fields=\"name,email,id\"\n        onClick={faceAuthStart}\n        scope=\"ads_management, email\"\n        callback={responseFacebook} \n        render={renderProps => (\n          <Button type=\"primary\" onClick={renderProps.onClick}>Connect Facebook</Button>\n        )}\n        />\n  ]\n\n  return (\n    <DashboardLayout>\n    <div id=\"wrapper\">\n      <Header actions={actions}/>\n      <div id=\"main-content\">\n        <Search\n            placeholder=\"Find Facebook interest for a keyword\"\n            enterButton=\"Getch\"\n            size=\"large\"\n            onSearch={(value) => getInterest(value)}\n          />\n      </div>\n        \n\n      <style jsx>{`\n        #wrapper {\n          margin: 10px;\n        }\n        #main-content {\n          margin-top: 30px;\n        }\n      `}</style>\n    </div>\n    </DashboardLayout>\n  );\n};\n\nIndex.getInitialProps = async function(context) {\n  const token = context.query.at;\n  return {\n    token\n  };\n};\n\nconst mapStateToProps = state => ({\n  user: state.user.currentUser,\n  fbToken: state.user.fbToken\n});\n\nconst mapDispatchToProps = dispatch => ({\n  addUser: item => dispatch(addingCurrentUser(item)),\n  authFb: (token, id) => dispatch(authFacebook({token, id}))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Index);\n"]},"metadata":{},"sourceType":"module"}