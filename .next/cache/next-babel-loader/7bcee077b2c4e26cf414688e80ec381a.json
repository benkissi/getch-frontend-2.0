{"ast":null,"code":"import \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nvar _jsxFileName = \"/code/ben/getch/frontend/pages/index.js\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useRouter } from \"next/router\";\nimport { useEffect } from \"react\";\nimport { connect } from \"react-redux\";\nimport FacebookLogin from 'react-facebook-login';\nimport { getProducts, fbAuthentication, searchInterest } from '../api/api';\nimport decodeToken from \"../utils/auth\";\nimport { addingCurrentUser, authFacebook } from \"../redux/user/user-actions\";\n\nconst Index = props => {\n  const router = useRouter();\n  useEffect(() => {\n    const {\n      token,\n      user,\n      addUser\n    } = props;\n\n    if (token) {\n      const decoded = decodeToken(props.token);\n      const {\n        _id,\n        name,\n        email,\n        domain\n      } = decoded;\n      const userData = {\n        id: _id,\n        name,\n        email,\n        domain\n      };\n      addUser(userData);\n    } else if (user) {\n      console.log(user);\n    } else {\n      router.push(\"/signin\");\n    }\n  }, []);\n\n  const faceAuthStart = () => {\n    console.log('#### FB auth start');\n  };\n\n  const responseFacebook = async res => {\n    console.log(res);\n    const {\n      accessToken\n    } = res;\n    await props.authFb(accessToken, user.id);\n  };\n\n  const fbAccess = \"EAAHq70ZCGT5QBAAZBVZBiPMgGUFpxnQehvZCmlTMZA3YeeJOALIiZAHtqEQwZBTHG7rPxb7qgAUZAD2Eo4ZAP9DUUN0Sv3iQR4vVgq2FsZANd8Dr3zhxMVhH5mFniuIQLF58Yfi0GObXdBRXCKflLJqJRKELxIhrhYXVYZD\";\n  return __jsx(\"div\", {\n    id: \"wrapper\",\n    className: \"jsx-1857536138\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47\n    },\n    __self: this\n  }, __jsx(\"p\", {\n    className: \"jsx-1857536138\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 48\n    },\n    __self: this\n  }, \"Hello Next.js\"), __jsx(FacebookLogin, {\n    appId: process.env.FB_APP_ID,\n    autoLoad: true,\n    fields: \"name,email,id\",\n    onClick: faceAuthStart,\n    scope: \"ads_management, email\",\n    callback: responseFacebook,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49\n    },\n    __self: this\n  }), __jsx(_Button, {\n    onClick: () => searchInterest(fbAccess, 'fish', 50),\n    type: \"danger\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56\n    },\n    __self: this\n  }, \"Primary\"), __jsx(\"p\", {\n    className: \"jsx-1857536138\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57\n    },\n    __self: this\n  }, \"Secret: \", process.env.FB_APP_SECRET), __jsx(_JSXStyle, {\n    id: \"1857536138\",\n    __self: this\n  }, \"#wrapper.jsx-1857536138{margin:10px;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9jb2RlL2Jlbi9nZXRjaC9mcm9udGVuZC9wYWdlcy9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUEwRGtCLEFBR3VCLFlBQ2QiLCJmaWxlIjoiL2NvZGUvYmVuL2dldGNoL2Zyb250ZW5kL3BhZ2VzL2luZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdXNlUm91dGVyIH0gZnJvbSBcIm5leHQvcm91dGVyXCI7XG5pbXBvcnQgeyB1c2VFZmZlY3QgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IGNvbm5lY3QgfSBmcm9tIFwicmVhY3QtcmVkdXhcIjtcbmltcG9ydCB7IEJ1dHRvbiB9IGZyb20gXCJhbnRkXCI7XG5pbXBvcnQgRmFjZWJvb2tMb2dpbiBmcm9tICdyZWFjdC1mYWNlYm9vay1sb2dpbic7XG5cbmltcG9ydCB7Z2V0UHJvZHVjdHMsIGZiQXV0aGVudGljYXRpb24sIHNlYXJjaEludGVyZXN0fSBmcm9tICcuLi9hcGkvYXBpJ1xuXG5pbXBvcnQgZGVjb2RlVG9rZW4gZnJvbSBcIi4uL3V0aWxzL2F1dGhcIjtcbmltcG9ydCB7IGFkZGluZ0N1cnJlbnRVc2VyLCBhdXRoRmFjZWJvb2sgfSBmcm9tIFwiLi4vcmVkdXgvdXNlci91c2VyLWFjdGlvbnNcIjtcblxuY29uc3QgSW5kZXggPSBwcm9wcyA9PiB7XG4gIGNvbnN0IHJvdXRlciA9IHVzZVJvdXRlcigpO1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGNvbnN0IHsgdG9rZW4sIHVzZXIsIGFkZFVzZXIgfSA9IHByb3BzO1xuICAgIGlmICh0b2tlbikge1xuICAgICAgY29uc3QgZGVjb2RlZCA9IGRlY29kZVRva2VuKHByb3BzLnRva2VuKTtcbiAgICAgIGNvbnN0IHsgX2lkLCBuYW1lLCBlbWFpbCwgZG9tYWluIH0gPSBkZWNvZGVkO1xuICAgICAgY29uc3QgdXNlckRhdGEgPSB7XG4gICAgICAgIGlkOiBfaWQsXG4gICAgICAgIG5hbWUsIFxuICAgICAgICBlbWFpbCwgXG4gICAgICAgIGRvbWFpblxuICAgICAgfTtcbiAgICAgIGFkZFVzZXIodXNlckRhdGEpO1xuICAgIH0gZWxzZSBpZiAodXNlcikge1xuICAgICAgY29uc29sZS5sb2codXNlcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJvdXRlci5wdXNoKFwiL3NpZ25pblwiKTtcbiAgICB9XG4gIH0sIFtdKTtcblxuICBjb25zdCBmYWNlQXV0aFN0YXJ0ID0gKCkgPT4ge1xuICAgIGNvbnNvbGUubG9nKCcjIyMjIEZCIGF1dGggc3RhcnQnKVxuICB9XG5cbiAgY29uc3QgcmVzcG9uc2VGYWNlYm9vayA9IGFzeW5jIChyZXMpID0+IHtcbiAgICBjb25zb2xlLmxvZyhyZXMpXG4gICAgY29uc3Qge2FjY2Vzc1Rva2VufSA9IHJlc1xuICAgIGF3YWl0IHByb3BzLmF1dGhGYihhY2Nlc3NUb2tlbiwgdXNlci5pZClcbiAgfVxuXG4gIGNvbnN0IGZiQWNjZXNzID0gXCJFQUFIcTcwWkNHVDVRQkFBWkJWWkJpUE1nR1VGcHhuUWVodlpDbWxUTVpBM1llZUpPQUxJaVpBSHRxRVF3WkJUSEc3clB4YjdxZ0FVWkFEMkVvNFpBUDlEVVVOMFN2M2lRUjR2VmdxMkZzWkFOZDhEcjN6aHhNVmhINW1Gbml1SVFMRjU4WWZpMEdPYlhkQlJYQ0tmbExKcUpSS0VMeElocmhZWFZZWkRcIlxuICBcblxuICByZXR1cm4gKFxuICAgIDxkaXYgaWQ9XCJ3cmFwcGVyXCI+XG4gICAgICA8cD5IZWxsbyBOZXh0LmpzPC9wPlxuICAgICAgPEZhY2Vib29rTG9naW5cbiAgICAgICAgYXBwSWQ9e3Byb2Nlc3MuZW52LkZCX0FQUF9JRH1cbiAgICAgICAgYXV0b0xvYWQ9e3RydWV9XG4gICAgICAgIGZpZWxkcz1cIm5hbWUsZW1haWwsaWRcIlxuICAgICAgICBvbkNsaWNrPXtmYWNlQXV0aFN0YXJ0fVxuICAgICAgICBzY29wZT1cImFkc19tYW5hZ2VtZW50LCBlbWFpbFwiXG4gICAgICAgIGNhbGxiYWNrPXtyZXNwb25zZUZhY2Vib29rfSAvPlxuICAgICAgPEJ1dHRvbiBvbkNsaWNrPXsoKSA9PiBzZWFyY2hJbnRlcmVzdChmYkFjY2VzcywgJ2Zpc2gnLCA1MCl9IHR5cGU9XCJkYW5nZXJcIj5QcmltYXJ5PC9CdXR0b24+XG4gICAgICA8cD5TZWNyZXQ6IHtwcm9jZXNzLmVudi5GQl9BUFBfU0VDUkVUfTwvcD5cblxuICAgICAgPHN0eWxlIGpzeD57YFxuICAgICAgICAjd3JhcHBlciB7XG4gICAgICAgICAgbWFyZ2luOiAxMHB4O1xuICAgICAgICB9XG4gICAgICBgfTwvc3R5bGU+XG4gICAgPC9kaXY+XG4gICk7XG59O1xuXG5JbmRleC5nZXRJbml0aWFsUHJvcHMgPSBhc3luYyBmdW5jdGlvbihjb250ZXh0KSB7XG4gIGNvbnN0IHRva2VuID0gY29udGV4dC5xdWVyeS5hdDtcbiAgcmV0dXJuIHtcbiAgICB0b2tlblxuICB9O1xufTtcblxuY29uc3QgbWFwU3RhdGVUb1Byb3BzID0gc3RhdGUgPT4gKHtcbiAgdXNlcjogc3RhdGUudXNlci5jdXJyZW50VXNlclxufSk7XG5cbmNvbnN0IG1hcERpc3BhdGNoVG9Qcm9wcyA9IGRpc3BhdGNoID0+ICh7XG4gIGFkZFVzZXI6IGl0ZW0gPT4gZGlzcGF0Y2goYWRkaW5nQ3VycmVudFVzZXIoaXRlbSkpLFxuICBhdXRoRmI6IGRhdGEgPT4gZGlzcGF0Y2goYXV0aEZhY2Vib29rKGRhdGEpKVxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IGNvbm5lY3QobWFwU3RhdGVUb1Byb3BzLCBtYXBEaXNwYXRjaFRvUHJvcHMpKEluZGV4KTtcbiJdfQ== */\\n/*@ sourceURL=/code/ben/getch/frontend/pages/index.js */\"));\n};\n\nIndex.getInitialProps = async function (context) {\n  const token = context.query.at;\n  return {\n    token\n  };\n};\n\nconst mapStateToProps = state => ({\n  user: state.user.currentUser\n});\n\nconst mapDispatchToProps = dispatch => ({\n  addUser: item => dispatch(addingCurrentUser(item)),\n  authFb: data => dispatch(authFacebook(data))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Index);","map":{"version":3,"sources":["/code/ben/getch/frontend/pages/index.js"],"names":["useRouter","useEffect","connect","FacebookLogin","getProducts","fbAuthentication","searchInterest","decodeToken","addingCurrentUser","authFacebook","Index","props","router","token","user","addUser","decoded","_id","name","email","domain","userData","id","console","log","push","faceAuthStart","responseFacebook","res","accessToken","authFb","fbAccess","process","env","FB_APP_ID","FB_APP_SECRET","getInitialProps","context","query","at","mapStateToProps","state","currentUser","mapDispatchToProps","dispatch","item","data"],"mappings":"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","sourcesContent":["import { useRouter } from \"next/router\";\nimport { useEffect } from \"react\";\nimport { connect } from \"react-redux\";\nimport { Button } from \"antd\";\nimport FacebookLogin from 'react-facebook-login';\n\nimport {getProducts, fbAuthentication, searchInterest} from '../api/api'\n\nimport decodeToken from \"../utils/auth\";\nimport { addingCurrentUser, authFacebook } from \"../redux/user/user-actions\";\n\nconst Index = props => {\n  const router = useRouter();\n  useEffect(() => {\n    const { token, user, addUser } = props;\n    if (token) {\n      const decoded = decodeToken(props.token);\n      const { _id, name, email, domain } = decoded;\n      const userData = {\n        id: _id,\n        name, \n        email, \n        domain\n      };\n      addUser(userData);\n    } else if (user) {\n      console.log(user);\n    } else {\n      router.push(\"/signin\");\n    }\n  }, []);\n\n  const faceAuthStart = () => {\n    console.log('#### FB auth start')\n  }\n\n  const responseFacebook = async (res) => {\n    console.log(res)\n    const {accessToken} = res\n    await props.authFb(accessToken, user.id)\n  }\n\n  const fbAccess = \"EAAHq70ZCGT5QBAAZBVZBiPMgGUFpxnQehvZCmlTMZA3YeeJOALIiZAHtqEQwZBTHG7rPxb7qgAUZAD2Eo4ZAP9DUUN0Sv3iQR4vVgq2FsZANd8Dr3zhxMVhH5mFniuIQLF58Yfi0GObXdBRXCKflLJqJRKELxIhrhYXVYZD\"\n  \n\n  return (\n    <div id=\"wrapper\">\n      <p>Hello Next.js</p>\n      <FacebookLogin\n        appId={process.env.FB_APP_ID}\n        autoLoad={true}\n        fields=\"name,email,id\"\n        onClick={faceAuthStart}\n        scope=\"ads_management, email\"\n        callback={responseFacebook} />\n      <Button onClick={() => searchInterest(fbAccess, 'fish', 50)} type=\"danger\">Primary</Button>\n      <p>Secret: {process.env.FB_APP_SECRET}</p>\n\n      <style jsx>{`\n        #wrapper {\n          margin: 10px;\n        }\n      `}</style>\n    </div>\n  );\n};\n\nIndex.getInitialProps = async function(context) {\n  const token = context.query.at;\n  return {\n    token\n  };\n};\n\nconst mapStateToProps = state => ({\n  user: state.user.currentUser\n});\n\nconst mapDispatchToProps = dispatch => ({\n  addUser: item => dispatch(addingCurrentUser(item)),\n  authFb: data => dispatch(authFacebook(data))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Index);\n"]},"metadata":{},"sourceType":"module"}