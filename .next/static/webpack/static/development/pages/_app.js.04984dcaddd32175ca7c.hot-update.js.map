{"version":3,"file":"static/webpack/static/development/pages/_app.js.04984dcaddd32175ca7c.hot-update.js","sources":["webpack:///./redux/user/user-sagas.js"],"sourcesContent":["import { takeLatest, put, all, call } from \"redux-saga/effects\";\nimport UserActionTypes from \"./user-types\";\nimport {\n  siginSuccess,\n  signupSuccess,\n  signupFailure,\n  setCurrentUser,\n  siginFailure,\n  isLoading,\n  facebookAuthSuccess,\n  fbAuthFailure,\n  userLogoutSuccess,\n  userLogoutFailure,\n} from \"./user-actions\";\nimport { setCount } from \"../search/search-actions\";\nimport { fbAuthentication, signUp, signIn, userLogout } from \"../../api/api\";\n\nexport function* setUser({ payload }) {\n  try {\n    yield put(isLoading(true));\n    if (!payload) {\n      throw new Error(\"No user\");\n    }\n\n    yield put(setCurrentUser(payload));\n    yield put(siginSuccess(true));\n    yield put(isLoading(false));\n  } catch (error) {\n    yield put(siginFailure(error));\n    yield put(isLoading(false));\n  }\n}\n\nexport function* signUpUser({ payload }) {\n  try {\n    yield put(isLoading(true));\n    console.log(\"the payload\", payload);\n    const res = yield signUp(payload.email, payload.password);\n\n    const userData = {\n      id: res._id,\n      name: res.name,\n      email: res.email,\n      xToken: res.xToken,\n      plan: res.plan,\n    };\n    console.log(\"User data\", userData);\n    yield put(setCurrentUser(userData));\n    yield put(setCount(res.searchCount));\n    yield put(signupSuccess(true));\n    yield put(isLoading(false));\n  } catch (error) {\n    yield put(signupFailure(error));\n  }\n}\n\nexport function* signInUser({ payload }) {\n  try {\n    yield put(isLoading(true));\n    const res = yield signIn(payload.email, payload.password);\n    const userData = {\n      id: res._id,\n      name: res.name,\n      email: res.email,\n      xToken: res.xToken,\n      plan: res.plan,\n    };\n    yield put(setCurrentUser(userData));\n    yield put(setCount(res.searchCount));\n    console.log(\"search count\", res.searchCount);\n    yield put(isLoading(false));\n    console.log(\"signin response\", userData);\n  } catch (error) {\n    yield put(isLoading(false));\n    yield put(siginFailure(error));\n  }\n}\n\nexport function* facebookAuth({ payload }) {\n  yield put(isLoading(true));\n  try {\n    const { token, id, fbId, name } = payload;\n    console.log(\"payload\", payload);\n    yield put(isLoading(true));\n    const fbToken = yield fbAuthentication(token, id, fbId, name);\n\n    yield put(facebookAuthSuccess(fbToken));\n    yield put(isLoading(false));\n  } catch (error) {\n    yield put(fbAuthFailure(error));\n    yield put(isLoading(false));\n  }\n}\n\nexport function* logout({ payload }) {\n  try {\n    yield put(isLoading(true));\n    const res = yield userLogout(payload);\n    if (res === true) {\n      console.log(\"logout done\");\n      yield put(userLogoutSuccess());\n      yield put(isLoading(false));\n    }\n  } catch (error) {\n    yield put(isLoading(false));\n    yield put(userLogoutFailure(error));\n  }\n}\n\nexport function* onAddingCurrentUser() {\n  yield takeLatest(UserActionTypes.ADDING_CURRENT_USER, setUser);\n}\n\nexport function* onSignupStart() {\n  yield takeLatest(UserActionTypes.SIGN_UP_START, signUpUser);\n}\n\nexport function* onSigninStart() {\n  yield takeLatest(UserActionTypes.SIGN_IN_START, signInUser);\n}\n\nexport function* onAuthFacebook() {\n  yield takeLatest(UserActionTypes.AUTH_FACEBOOK, facebookAuth);\n}\n\nexport function* onLogout() {\n  yield takeLatest(UserActionTypes.LOG_OUT, logout);\n}\n\nexport function* userSagas() {\n  yield all([\n    call(onAuthFacebook),\n    call(onAddingCurrentUser),\n    call(onSigninStart),\n    call(onSignupStart),\n    call(onLogout),\n  ]);\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiBA;AAgBA;AAuBA;AAsBA;AAgBA;AAeA;AAIA;AAIA;AAIA;AAIA;AAIA;AACA;AAlIA;AACA;AACA;AAYA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AACA;AADA;AAAA;AAOA;AACA;AARA;AAAA;AAQA;AACA;AATA;AAAA;AASA;AACA;AAVA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAWA;AACA;AAZA;AAAA;AAYA;AACA;AAbA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAgBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAHA;AAGA;AAHA;AAIA;AACA;AALA;AAIA;AAEA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AAbA;AAcA;AACA;AAfA;AAAA;AAeA;AACA;AAhBA;AAAA;AAgBA;AACA;AAjBA;AAAA;AAiBA;AACA;AAlBA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAmBA;AACA;AApBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAuBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAHA;AAAA;AAGA;AACA;AAJA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AALA;AAJA;AAWA;AACA;AAZA;AAAA;AAYA;AACA;AAbA;AAaA;AAbA;AAcA;AACA;AAfA;AAeA;AAfA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAiBA;AACA;AAlBA;AAAA;AAkBA;AACA;AAnBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAsBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAGA;AACA;AAJA;AAKA;AACA;AANA;AAAA;AAMA;AACA;AAPA;AAMA;AANA;AAQA;AACA;AATA;AAAA;AASA;AACA;AAVA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAWA;AACA;AAZA;AAAA;AAYA;AACA;AAbA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAgBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAHA;AAAA;AAGA;AACA;AAJA;AAGA;AACA;AAJA;AAAA;AAAA;AAAA;AACA;AAIA;AALA;AAMA;AACA;AAPA;AAAA;AAOA;AACA;AARA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAUA;AACA;AAXA;AAAA;AAWA;AACA;AAZA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAeA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;A","sourceRoot":""}